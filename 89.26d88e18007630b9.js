"use strict";(self.webpackChunkrucogs_website=self.webpackChunkrucogs_website||[]).push([[89],{4089:(ho,st,s)=>{s.r(st),s.d(st,{ProjectPageModule:()=>fo});var p=s(8692),j=s(3331),M=s(2516),N=s(3178),d=s(92),ct=s(5719),C=s(9638),f=s(4536),P=s(7406),t=s(4537),E=s(8954),lt=s(4929),H=s(5436),Z=s(1379),Q=s(8023),St=s(1860),c=s(4091);const Mt=["mat-sort-header",""];function Pt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("@arrowPosition.start",function(){t.CHM(e);const n=t.oxw();return t.KtG(n._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){t.CHM(e);const n=t.oxw();return t.KtG(n._disableViewStateAnimation=!1)}),t._UZ(1,"div",4),t.TgZ(2,"div",5),t._UZ(3,"div",6)(4,"div",7)(5,"div",8),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("@arrowOpacity",e._getArrowViewState())("@arrowPosition",e._getArrowViewState())("@allowChildren",e._getArrowDirectionState()),t.xp6(2),t.Q6J("@indicator",e._getArrowDirectionState()),t.xp6(1),t.Q6J("@leftPointer",e._getArrowDirectionState()),t.xp6(1),t.Q6J("@rightPointer",e._getArrowDirectionState())}}const Ot=["*"],dt=new t.OlP("MAT_SORT_DEFAULT_OPTIONS"),Dt=(0,Z.dB)((0,Z.Id)(class{}));let tt=(()=>{class i extends Dt{constructor(e){super(),this._defaultOptions=e,this.sortables=new Map,this._stateChanges=new Q.x,this.start="asc",this._direction="",this.sortChange=new t.vpe}get direction(){return this._direction}set direction(e){this._direction=e}get disableClear(){return this._disableClear}set disableClear(e){this._disableClear=(0,lt.Ig)(e)}register(e){this.sortables.set(e.id,e)}deregister(e){this.sortables.delete(e.id)}sort(e){this.active!=e.id?(this.active=e.id,this.direction=e.start?e.start:this.start):this.direction=this.getNextSortDirection(e),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(e){if(!e)return"";let n=function kt(i,r){let e=["asc","desc"];return"desc"==i&&e.reverse(),r||e.push(""),e}(e.start||this.start,e?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),a=n.indexOf(this.direction)+1;return a>=n.length&&(a=0),n[a]}ngOnInit(){this._markInitialized()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(dt,8))},i.\u0275dir=t.lG2({type:i,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],active:["matSortActive","active"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[t.qOj,t.TTD]}),i})();const O=Z.mZ.ENTERING+" "+Z.yN.STANDARD_CURVE,U={indicator:(0,c.X$)("indicator",[(0,c.SB)("active-asc, asc",(0,c.oB)({transform:"translateY(0px)"})),(0,c.SB)("active-desc, desc",(0,c.oB)({transform:"translateY(10px)"})),(0,c.eR)("active-asc <=> active-desc",(0,c.jt)(O))]),leftPointer:(0,c.X$)("leftPointer",[(0,c.SB)("active-asc, asc",(0,c.oB)({transform:"rotate(-45deg)"})),(0,c.SB)("active-desc, desc",(0,c.oB)({transform:"rotate(45deg)"})),(0,c.eR)("active-asc <=> active-desc",(0,c.jt)(O))]),rightPointer:(0,c.X$)("rightPointer",[(0,c.SB)("active-asc, asc",(0,c.oB)({transform:"rotate(45deg)"})),(0,c.SB)("active-desc, desc",(0,c.oB)({transform:"rotate(-45deg)"})),(0,c.eR)("active-asc <=> active-desc",(0,c.jt)(O))]),arrowOpacity:(0,c.X$)("arrowOpacity",[(0,c.SB)("desc-to-active, asc-to-active, active",(0,c.oB)({opacity:1})),(0,c.SB)("desc-to-hint, asc-to-hint, hint",(0,c.oB)({opacity:.54})),(0,c.SB)("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",(0,c.oB)({opacity:0})),(0,c.eR)("* => asc, * => desc, * => active, * => hint, * => void",(0,c.jt)("0ms")),(0,c.eR)("* <=> *",(0,c.jt)(O))]),arrowPosition:(0,c.X$)("arrowPosition",[(0,c.eR)("* => desc-to-hint, * => desc-to-active",(0,c.jt)(O,(0,c.F4)([(0,c.oB)({transform:"translateY(-25%)"}),(0,c.oB)({transform:"translateY(0)"})]))),(0,c.eR)("* => hint-to-desc, * => active-to-desc",(0,c.jt)(O,(0,c.F4)([(0,c.oB)({transform:"translateY(0)"}),(0,c.oB)({transform:"translateY(25%)"})]))),(0,c.eR)("* => asc-to-hint, * => asc-to-active",(0,c.jt)(O,(0,c.F4)([(0,c.oB)({transform:"translateY(25%)"}),(0,c.oB)({transform:"translateY(0)"})]))),(0,c.eR)("* => hint-to-asc, * => active-to-asc",(0,c.jt)(O,(0,c.F4)([(0,c.oB)({transform:"translateY(0)"}),(0,c.oB)({transform:"translateY(-25%)"})]))),(0,c.SB)("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",(0,c.oB)({transform:"translateY(0)"})),(0,c.SB)("hint-to-desc, active-to-desc, desc",(0,c.oB)({transform:"translateY(-25%)"})),(0,c.SB)("hint-to-asc, active-to-asc, asc",(0,c.oB)({transform:"translateY(25%)"}))]),allowChildren:(0,c.X$)("allowChildren",[(0,c.eR)("* <=> *",[(0,c.IO)("@*",(0,c.pV)(),{optional:!0})])])};let $=(()=>{class i{constructor(){this.changes=new Q.x}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Jt={provide:$,deps:[[new t.FiY,new t.tp0,$]],useFactory:function Ut(i){return i||new $}},Yt=(0,Z.Id)(class{});let pt=(()=>{class i extends Yt{constructor(e,o,n,a,l,m,h,y){super(),this._intl=e,this._changeDetectorRef=o,this._sort=n,this._columnDef=a,this._focusMonitor=l,this._elementRef=m,this._ariaDescriber=h,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this._sortActionDescription="Sort",y?.arrowPosition&&(this.arrowPosition=y?.arrowPosition),this._handleStateChanges()}get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(e){this._updateSortActionDescription(e)}get disableClear(){return this._disableClear}set disableClear(e){this._disableClear=(0,lt.Ig)(e)}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{const o=!!e;o!==this._showIndicatorHint&&(this._setIndicatorHintVisible(o),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}_setIndicatorHintVisible(e){this._isDisabled()&&e||(this._showIndicatorHint=e,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(e){this._viewState=e||{},this._disableViewStateAnimation&&(this._viewState={toState:e.toState})}_toggleOnInteraction(){this._sort.sort(this),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(e){!this._isDisabled()&&(e.keyCode===H.L_||e.keyCode===H.K5)&&(e.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const e=this._viewState.fromState;return(e?`${e}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(e){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,e)),this._sortActionDescription=e}_handleStateChanges(){this._rerenderSubscription=(0,St.T)(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36($),t.Y36(t.sBO),t.Y36(tt,8),t.Y36("MAT_SORT_HEADER_COLUMN_DEF",8),t.Y36(E.tE),t.Y36(t.SBq),t.Y36(E.$s,8),t.Y36(dt,8))},i.\u0275cmp=t.Xpm({type:i,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(e,o){1&e&&t.NdJ("click",function(){return o._handleClick()})("keydown",function(a){return o._handleKeydown(a)})("mouseenter",function(){return o._setIndicatorHintVisible(!0)})("mouseleave",function(){return o._setIndicatorHintVisible(!1)}),2&e&&(t.uIk("aria-sort",o._getAriaSortAttribute()),t.ekj("mat-sort-header-disabled",o._isDisabled()))},inputs:{disabled:"disabled",id:["mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",sortActionDescription:"sortActionDescription",disableClear:"disableClear"},exportAs:["matSortHeader"],features:[t.qOj],attrs:Mt,ngContentSelectors:Ot,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(e,o){1&e&&(t.F$t(),t.TgZ(0,"div",0)(1,"div",1),t.Hsn(2),t.qZA(),t.YNc(3,Pt,6,6,"div",2),t.qZA()),2&e&&(t.ekj("mat-sort-header-sorted",o._isSorted())("mat-sort-header-position-before","before"===o.arrowPosition),t.uIk("tabindex",o._isDisabled()?null:0)("role",o._isDisabled()?null:"button"),t.xp6(3),t.Q6J("ngIf",o._renderArrow()))},dependencies:[p.O5],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[U.indicator,U.leftPointer,U.rightPointer,U.arrowOpacity,U.arrowPosition,U.allowChildren]},changeDetection:0}),i})(),Nt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[Jt],imports:[p.ez,Z.BQ]}),i})();var g=s(317),L=s(2940),z=s(7950),Et=s(4276),Qt=s(5491),et=s(335),mt=s(6883),qt=s(6004),ut=s(411);let _t=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,Qt.F,et.z,mt.U,P.c,C.ot,d.UX,et.z,qt.m,j.Ps,ut.As]}),i})();var it=s(7763);let Ft=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,j.Ps,ct.g,M.Nh,L.AV,et.z,g.p0,C.ot,z.c,Nt,P.c,Et.J,_t,it.I,f.Is,d.UX,mt.U]}),i})();var ft=s(1561),G=s(3704),gt=s(6438),ot=s(8033),I=s(7545);let Bt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,C.ot,z.c,j.Ps,ut.As,I.fF]}),i})();var Rt=s(4022),q=s(7165),v=s(8659);let Ht=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,q._t,P.c,v.lN,j.Ps,d.u5,C.ot,z.c]}),i})();var $t=s(9518),ht=s(8399),vt=s(7657);let Lt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,_t,gt.t,P.c,C.ot,z.c,it.I,Bt,ht.QX,vt.JP,$t.I,j.Ps,f.Is,G.FA,Ht,Rt.l,ft.p9,ot.LD,d.UX,Z.XK]}),i})(),zt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,j.Ps,C.ot,L.AV,it.I]}),i})();var u=s(8239),T=s(9860),_=s(3556),b=s(274),x=s(7445),D=s(3528),bt=s(6527),J=s(831),Gt=s(1241),Vt=s(9942),S=s(5208),Kt=s(3794),nt=s(9676),Y=s(4583),B=s(6440),Xt=s(3223);const Wt=function(i){return{clickable:i}};let V=(()=>{class i{constructor(e){this.cdn=e,this.user={},this.clickable=!1,this.link=""}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(B.U))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-inline-profile"]],inputs:{user:"user",clickable:"clickable",link:"link"},decls:6,vars:7,consts:[[2,"display","flex","align-items","center","gap","0.5em","color","inherit","text-decoration","inherit",3,"routerLink","ngClass"],["size","input",3,"avatarSrc"],[2,"font-size","0.75em"]],template:function(e,o){1&e&&(t.TgZ(0,"a",0),t._UZ(1,"app-avatar",1),t.TgZ(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div",2),t._uU(5),t.qZA()()),2&e&&(t.Q6J("routerLink",o.clickable?o.link:null)("ngClass",t.VKq(5,Wt,o.clickable)),t.xp6(1),t.Q6J("avatarSrc",o.cdn.getFileLink(o.user.avatarLink)),t.xp6(2),t.Oqu(o.user.displayName),t.xp6(2),t.hij("@",o.user.username,""))},dependencies:[p.mk,Xt.A,N.yS],styles:[".clickable[_ngcontent-%COMP%]{transition:transform .1s ease-out}.clickable[_ngcontent-%COMP%]:hover{transform:scale(1.1)}"]}),i})();var A=s(2709),xt=s(7025),te=s(2842);let ee=(()=>{class i{constructor(e,o,n,a,l,m){this.backend=o,this.uiMessageService=n,this.rolesService=a,this.dialogRef=l,this.data=m,this.rolesEdited=!1,this.roles=[],this.disabledRoles=[],this.acceptedRoles=[],this.monitor=new Y.y,this.form=e.group({contributions:[this.data.projectMember.contributions,[]]}),l.disableClose=!0}ngOnInit(){var e=this;return(0,u.Z)(function*(){!e.data.projectMember.roles||(e.roles=e.data.projectMember.roles.map(o=>o?.roleCode),e.acceptedRoles=yield e.rolesService.getAddableProjectRoles(e.data.projectId),e.disabledRoles=yield e.rolesService.getDisabledProjectRoles(e.data.projectId))})()}exit(e=!1){this.monitor.isProcessing||this.dialogRef.close(e)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Some project member information is missing!");return!0}catch(e){return this.uiMessageService.error(e),!1}}save(){if(this.monitor.isProcessing||!this.validate())return;const e={id:this.data.projectMember.id};this.form.get("contributions")?.value!==this.data.projectMember.contributions&&(e.contributions=this.form.get("contributions")?.value),this.rolesEdited&&(e.roles=this.roles),Object.keys(e).length>1&&(this.monitor.addProcess(),this.backend.withAuth().mutate({mutation:b.Ps`
            mutation ($input: UpdateProjectMemberInput!) {
              updateProjectMember(input: $input)
            }
          `,variables:{input:e}}).pipe((0,nt.P)()).subscribe({next:o=>{this.monitor.removeProcess(),this.exit(!0)},error:o=>{this.monitor.removeProcess(),this.exit(!1)}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.QS),t.Y36(I.v$),t.Y36(S.S),t.Y36(I.fu),t.Y36(f.so),t.Y36(f.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-member-dialog"]],decls:15,vars:10,consts:[[2,"position","relative",3,"formGroup"],[3,"user"],["appearance","outline",2,"width","100%","line-height","1.5em","margin-top","0.5em"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5","formControlName","contributions",3,"maxlength"],["align","end"],["label","Roles",3,"roles","allRoles","disabledRoles","disabled","rolesEdited"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-dialog-content")(1,"form",0),t._UZ(2,"app-inline-profile",1),t.TgZ(3,"mat-form-field",2)(4,"mat-label"),t._uU(5,"Contributions"),t.qZA(),t._UZ(6,"textarea",3),t.TgZ(7,"mat-hint",4),t._uU(8),t.qZA()(),t.TgZ(9,"app-role-codes-editor",5),t.NdJ("rolesEdited",function(){return o.rolesEdited=!0}),t.qZA()()(),t.TgZ(10,"mat-dialog-actions")(11,"button",6),t.NdJ("click",function(){return o.exit()}),t._uU(12,"Exit "),t.qZA(),t.TgZ(13,"button",6),t.NdJ("click",function(){return o.save()}),t._uU(14,"Save "),t.qZA()()),2&e){let n;t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("user",o.data.projectMember.user),t.xp6(4),t.Q6J("maxlength",450),t.xp6(2),t.hij("",(null==(n=o.form.get("contributions"))||null==n.value?null:n.value.length)||0,"/450"),t.xp6(1),t.Q6J("roles",o.roles)("allRoles",o.acceptedRoles)("disabledRoles",o.disabledRoles)("disabled",!o.data.projectMemberOptions.canManageMemberRoles),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[V,C.lW,A.v,xt.IC,v.KE,v.bx,v.hX,P.Nt,f.xY,f.H8,d._Y,d.Fj,d.JJ,d.JL,d.nD,d.sg,d.u,te.K]}),i})();var K=s(7187),ie=s(5557),yt=s(1637);const oe=function(i){return{disabled:i}};function ne(i,r){if(1&i&&t._UZ(0,"app-inline-profile",5),2&i){const e=t.oxw();t.Q6J("user",e.user)("ngClass",t.VKq(2,oe,e.disabled))}}function re(i,r){if(1&i&&(t.TgZ(0,"mat-option",6),t._UZ(1,"app-inline-profile",7),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.Q6J("user",e)}}const ae=function(i){return{"cdk-visually-hidden":i}};let jt=(()=>{class i extends K.Y{constructor(e,o,n,a,l){super(n,a,l),this.cdn=e,this.backend=o,this.rutgersVerified=!1,this.inputControl=new d.p4,this.filteredUsers$=new ie.t,this.isEnteringNewUser=!0,this._user=null,this.controlType="app-user-input",this.id=`${this.controlType}-${i.nextId++}`}get user(){return this._user}set user(e){this._user=e,this.value=e?.id?e.id:null}get empty(){return""===this.value}ngOnInit(){var o,e=this;null!=this.user&&(this.inputControl.setValue(this.user.username,{emitEvent:!1}),this.isEnteringNewUser=!1),this.inputControl.valueChanges.pipe((0,D.R)(this.onDestroy$)).subscribe({next:(o=(0,u.Z)(function*(n){"string"==typeof n?(e.filteredUsers$.next(yield e.fetchSearchedUsers(n)),e.user=null,e.isEnteringNewUser||(e.inputControl.setValue(n.replace("[object Object]",""),{emitEvent:!1}),e.isEnteringNewUser=!0)):(e.user=n,e.inputControl.setValue(n.username,{emitEvent:!1}))}),function(a){return o.apply(this,arguments)})})}fetchSearchedUsers(e){var o=this;return(0,u.Z)(function*(){let n={};(e=e.toLowerCase())&&(n={...n,username:{startsWith:e,mode:"INSENSITIVE"}}),o.rutgersVerified&&(n={...n,netId:{exists:!0}}),0===Object.keys(n).length&&(n=void 0);const a=yield(0,x.z)(o.backend.query({query:b.Ps`
          query ($filter: UserFilterInput, $sorts: [UserSortInput!], $limit: Int) {
            users(filter: $filter, sorts: $sorts, limit: $limit) {
              id
              username
              displayName
              avatarLink
            }
          }
        `,variables:{limit:10,filter:n,sorts:[{username:"asc"}]}}));return a.error?[]:a.data.users})()}onAutoCompleteOptionSelected(){this.isEnteringNewUser=!1}}return i.nextId=0,i.\u0275fac=function(e){return new(e||i)(t.Y36(B.U),t.Y36(J.v),t.Y36(E.tE),t.Y36(t.SBq),t.Y36(d.a5,10))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-input"]],inputs:{rutgersVerified:"rutgersVerified"},features:[t._Bn([{provide:v.Eo,useExisting:i}]),t.qOj],decls:6,vars:9,consts:[["class","app-user-input",3,"user","ngClass",4,"ngIf"],["type","text","placeholder","Enter username","matInput","",3,"formControl","matAutocomplete","ngClass"],["autoActiveFirstOption","",3,"optionSelected"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[1,"app-user-input",3,"user","ngClass"],[3,"value"],[3,"user"]],template:function(e,o){if(1&e&&(t.YNc(0,ne,1,4,"app-inline-profile",0),t._UZ(1,"input",1),t.TgZ(2,"mat-autocomplete",2,3),t.NdJ("optionSelected",function(){return o.onAutoCompleteOptionSelected()}),t.YNc(4,re,2,2,"mat-option",4),t.ALo(5,"async"),t.qZA()),2&e){const n=t.MAs(3);t.Q6J("ngIf",o.user&&!o.isEnteringNewUser),t.xp6(1),t.Q6J("formControl",o.inputControl)("matAutocomplete",n)("ngClass",t.VKq(7,ae,!o.isEnteringNewUser)),t.xp6(3),t.Q6J("ngForOf",t.lcZ(5,5,o.filteredUsers$))}},dependencies:[p.mk,p.sg,p.O5,d.Fj,d.JJ,d.oH,Z.ey,P.Nt,yt.XC,yt.ZL,V,p.Ov]}),i})();function se(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," User is required "),t.qZA())}let ce=(()=>{class i{constructor(e,o,n,a,l){this.backend=o,this.uiMessage=n,this.dialogRef=a,this.data=l,this.monitor=new Y.y,this.form=e.group({user:[null,[d.kI.required]]})}exit(e=!1){var o=this;return(0,u.Z)(function*(){o.monitor.isProcessing||o.dialogRef.close(e)})()}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");if(this.data.project.members?.some(e=>e?.user?.id===this.form.get("user")?.value))throw new Error("User is already in the project!");return!0}catch(e){return e instanceof Error&&this.uiMessage.error(e.message),!1}}add(){var e=this;return(0,u.Z)(function*(){if(e.monitor.isProcessing||!e.validate())return;e.monitor.addProcess();const o=yield(0,x.z)(e.backend.withAuth().mutate({mutation:b.Ps`
          mutation ForceCreateProjectMember($input: NewProjectMemberInput!) {
            newProjectMember(input: $input)
          }
        `,variables:{input:{projectId:e.data.project.id,userId:e.form.get("user")?.value}}}));e.monitor.removeProcess(),!o.errors&&e.exit(!0)})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.qu),t.Y36(J.v),t.Y36(S.S),t.Y36(f.so),t.Y36(f.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-force-add-user-dialog"]],decls:14,vars:4,consts:[[3,"formGroup"],["appearance","outline",2,"width","100%"],["formControlName","user"],[4,"ngIf"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-dialog-content")(1,"h3"),t._uU(2,"Invite a User"),t.qZA(),t.TgZ(3,"form",0)(4,"mat-form-field",1)(5,"mat-label"),t._uU(6,"User"),t.qZA(),t._UZ(7,"app-user-input",2),t.YNc(8,se,2,0,"mat-error",3),t.qZA()()(),t.TgZ(9,"mat-dialog-actions")(10,"button",4),t.NdJ("click",function(){return o.exit()}),t._uU(11,"Exit "),t.qZA(),t.TgZ(12,"button",4),t.NdJ("click",function(){return o.add()}),t._uU(13,"Add "),t.qZA()()),2&e){let n;t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(5),t.Q6J("ngIf",null==(n=o.form.get("user"))?null:n.hasError("required")),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[p.O5,jt,C.lW,A.v,v.TO,v.KE,v.hX,f.xY,f.H8,d._Y,d.JJ,d.JL,d.sg,d.u]}),i})();var rt=s(3535),le=s(5705),de=s(398);function pe(i,r){1&i&&(t.TgZ(0,"p",6),t._uU(1,"Empty for now..."),t.qZA())}const me=function(){return{}};let Ct=(()=>{class i{constructor(e){this.cdn=e,this.projectMember={}}ngOnInit(){}getRoles(){return this.projectMember.roles?.map(e=>e.roleCode)??[]}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(B.U))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-project-member-profile"]],inputs:{projectMember:"projectMember"},decls:9,vars:5,consts:[[2,"display","flex","flex-direction","row","gap","24px"],[3,"user"],[2,"display","flex","flex-direction","column","max-height","100%"],["class","app-project-member-profile text-disabled",4,"ngIf"],[2,"flex","1"],[3,"roles"],[1,"app-project-member-profile","text-disabled"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-basic-profile",1),t.TgZ(2,"div",2)(3,"h2"),t._uU(4,"Contributions"),t.qZA(),t.YNc(5,pe,2,0,"p",3),t.TgZ(6,"p",4),t._uU(7),t.qZA(),t._UZ(8,"app-roles-display",5),t.qZA()()),2&e){let n;t.xp6(1),t.Q6J("user",null!==(n=o.projectMember.user)&&void 0!==n?n:t.DdM(4,me)),t.xp6(4),t.Q6J("ngIf",!o.projectMember.contributions),t.xp6(2),t.Oqu(o.projectMember.contributions),t.xp6(1),t.Q6J("roles",o.getRoles())}},dependencies:[p.O5,le.u,de.l]}),i})();var Tt=s(6410);function ue(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," User is required "),t.qZA())}let _e=(()=>{class i{constructor(e,o,n,a,l){this.backend=o,this.uiMessage=n,this.dialogRef=a,this.data=l,this.monitor=new Y.y,this.form=e.group({user:[null,[d.kI.required]]})}ngOnInit(){}exit(e=!1){this.monitor.isProcessing||this.dialogRef.close(e)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Form is incomplete!");const e=this.form.get("user")?.value;if(this.data.project.invites?.some(o=>o?.user?.id===e&&o?.type===_.PA.Outgoing))throw new Error("User already has an outgoing invite from this project!");if(this.data.project.members?.some(o=>o?.user?.id===e))throw new Error("User is already in the project!");return!0}catch(e){return e instanceof Error&&this.uiMessage.error(e.message),!1}}invite(){var e=this;return(0,u.Z)(function*(){if(e.monitor.isProcessing||!e.validate())return;e.monitor.addProcess();const o=yield(0,x.z)(e.backend.withAuth().mutate({mutation:b.Ps`
          mutation InviteUserToProject($input: NewProjectInviteInput!) {
            newProjectInvite(input: $input)
          }
        `,variables:{input:{type:_.PA.Outgoing,projectId:e.data.project.id,userId:e.form.get("user")?.value}}}));return e.monitor.removeProcess(),o.errors?void 0:e.exit(!0)})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.QS),t.Y36(J.v),t.Y36(S.S),t.Y36(f.so),t.Y36(f.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invite-user-dialog"]],decls:14,vars:5,consts:[[3,"formGroup"],["appearance","outline",2,"width","100%"],["formControlName","user",3,"rutgersVerified"],[4,"ngIf"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-dialog-content")(1,"h3"),t._uU(2,"Invite a User"),t.qZA(),t.TgZ(3,"form",0)(4,"mat-form-field",1)(5,"mat-label"),t._uU(6,"User"),t.qZA(),t._UZ(7,"app-user-input",2),t.YNc(8,ue,2,0,"mat-error",3),t.qZA()()(),t.TgZ(9,"mat-dialog-actions")(10,"button",4),t.NdJ("click",function(){return o.exit()}),t._uU(11,"Exit "),t.qZA(),t.TgZ(12,"button",4),t.NdJ("click",function(){return o.invite()}),t._uU(13,"Invite "),t.qZA()()),2&e){let n;t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(4),t.Q6J("rutgersVerified",!0),t.xp6(1),t.Q6J("ngIf",null==(n=o.form.get("user"))?null:n.hasError("required")),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[p.O5,jt,C.lW,A.v,v.TO,v.KE,v.hX,f.xY,f.H8,d._Y,d.JJ,d.JL,d.sg,d.u]}),i})();function fe(i,r){1&i&&(t.TgZ(0,"th",16),t._uU(1," User "),t.qZA())}function ge(i,r){if(1&i&&(t.TgZ(0,"td",17),t._UZ(1,"app-inline-profile",18),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.Q6J("user",e.user)}}function he(i,r){1&i&&(t.TgZ(0,"th",19),t._uU(1," Type "),t.qZA())}function ve(i,r){1&i&&(t.TgZ(0,"div"),t._uU(1,"\u{1f4e9} Incoming"),t.qZA())}function be(i,r){1&i&&(t.TgZ(0,"div"),t._uU(1,"\u{1f4e4} Outgoing"),t.qZA())}function xe(i,r){if(1&i&&(t.TgZ(0,"td",20),t.YNc(1,ve,2,0,"div",21),t.YNc(2,be,2,0,"div",21),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf","INCOMING"===e.type),t.xp6(1),t.Q6J("ngIf","OUTGOING"===e.type)}}function ye(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"th",22)(1,"div",23)(2,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.invite())}),t.TgZ(3,"mat-icon"),t._uU(4,"add"),t.qZA(),t._uU(5," Invite User "),t.qZA()()()}}function je(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.onAcceptInvite(n))}),t.TgZ(1,"mat-icon"),t._uU(2,"check_circle"),t.qZA()()}if(2&i){const e=t.oxw(3);t.Q6J("disabled",e.monitor.isProcessing)}}function Ce(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",20)(1,"div",23),t.YNc(2,je,3,1,"button",25),t.TgZ(3,"button",26),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onRejectInvite(a))}),t.TgZ(4,"mat-icon"),t._uU(5,"cancel"),t.qZA()()()()}if(2&i){const e=r.$implicit,o=t.oxw(2);t.xp6(2),t.Q6J("ngIf","INCOMING"===e.type),t.xp6(1),t.Q6J("disabled",o.monitor.isProcessing)}}function Te(i,r){1&i&&t._UZ(0,"tr",28)}function we(i,r){1&i&&t._UZ(0,"tr",29)}function Ie(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"app-filter-header",2,3),t.NdJ("newSearchRequest$",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onNewSearchRequest)}),t.qZA(),t._UZ(3,"div",4),t.TgZ(4,"table",5),t.NdJ("matSortChange",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.sortData(n))}),t.ynx(5,6),t.YNc(6,fe,2,0,"th",7),t.YNc(7,ge,2,1,"td",8),t.BQk(),t.ynx(8,9),t.YNc(9,he,2,0,"th",10),t.YNc(10,xe,3,2,"td",11),t.BQk(),t.ynx(11,12),t.YNc(12,ye,6,0,"th",13),t.YNc(13,Ce,6,2,"td",11),t.BQk(),t.YNc(14,Te,1,0,"tr",14),t.YNc(15,we,1,0,"tr",15),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("dataSource",e.filteredInvites),t.xp6(10),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let Ae=(()=>{class i{constructor(e,o,n){this.backend=e,this.breakpointManager=o,this.dialog=n,this.edited=new t.vpe,this.project={},this.projectOptions={isMember:!1,manageSomeMembers:!1,nonExistent:!1,canUpdateProject:!1,inviteSent:!1,isAuthenticated:!1,loaded:!1,canDeleteProject:!1,canManageMetadata:!1,canCreateProjectMember:!1,canJoinProject:!1},this.monitor=new Y.y,this.displayedColumns=["user","type","buttons"],this.filteredInvites=[],this.onDestroy$=new Q.x}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnChanges(e){e.project&&(this.monitor.removeProcess(),this.project.invites&&(this.filteredInvites=(0,T.I8)(this.project.invites)))}ngAfterViewInit(){!this.filterHeader||this.filterHeader.newSearchRequest.pipe((0,D.R)(this.onDestroy$)).subscribe(this.onNewSearchRequest.bind(this))}onNewSearchRequest(e){""===e?this.filteredInvites=(0,T.I8)(this.project.invites):(this.filteredInvites=this.project.invites.filter(o=>o.user.username.indexOf(e)>-1),this.filteredInvites=this.filteredInvites.sort((o,n)=>n.user.username.indexOf(e)-o.user.username.indexOf(e)))}onAcceptInvite(e){var o=this;return(0,u.Z)(function*(){o.monitor.isProcessing||(o.monitor.addProcess(),yield(0,x.z)(o.backend.withAuth().mutate({mutation:b.Ps`
          mutation AcceptProjectInvite($inviteId: ID!) {
            acceptProjectInvite(inviteId: $inviteId)
          }
        `,variables:{inviteId:e.id}})))})()}onRejectInvite(e){var o=this;return(0,u.Z)(function*(){o.monitor.isProcessing||(o.monitor.addProcess(),yield(0,x.z)(o.backend.withAuth().mutate({mutation:b.Ps`
          mutation RejectProjectInvite($inviteId: ID!) {
            deleteProjectInvite(inviteId: $inviteId)
          }
        `,variables:{inviteId:e.id}})))})()}invite(){var e=this;return(0,u.Z)(function*(){(yield(0,x.z)(e.dialog.open(_e,{data:{project:e.project},width:"25em",maxWidth:"90vw"}).afterClosed()))&&e.edited.emit()})()}sortData(e){const o=this.filteredInvites.slice();this.filteredInvites=e.active&&""!==e.direction?o.sort((n,a)=>{const l="asc"===e.direction;switch(e.active){case"user":return(0,T.qu)(n.user?.username,a.user?.username,l);case"type":return(0,T.qu)(n.type,a.type,l);default:return 0}}):o}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J.v),t.Y36(bt.I),t.Y36(f.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invites-tab"]],viewQuery:function(e,o){if(1&e&&t.Gf(rt.B,5),2&e){let n;t.iGM(n=t.CRH())&&(o.filterHeader=n.first)}},inputs:{project:"project",projectOptions:"projectOptions"},outputs:{edited:"edited"},features:[t.TTD],decls:1,vars:1,consts:[["style","margin-top: 2em;",4,"ngIf"],[2,"margin-top","2em"],["searchBar","",2,"flex","1",3,"newSearchRequest$"],["membersFilter",""],[2,"display","flex","flex-direction","column","gap","0.25em"],["mat-table","","matSort","","matSort","",1,"mat-elevation-z8",2,"width","100%",3,"dataSource","matSortChange"],["matColumnDef","user"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by user",4,"matHeaderCellDef"],["mat-cell","","style","max-width: 20em; overflow: hidden;",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by type",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by user"],["mat-cell","",2,"max-width","20em","overflow","hidden"],[3,"user"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by type"],["mat-cell",""],[4,"ngIf"],["mat-header-cell",""],[2,"display","flex","justify-content","right"],["mat-stroked-button","","pill","",1,"text-foreground",3,"click"],["mat-icon-button","",3,"disabled","click",4,"ngIf"],["mat-icon-button","",2,"margin-left","0.5em",3,"disabled","click"],["mat-icon-button","",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&t.YNc(0,Ie,16,3,"div",0),2&e&&t.Q6J("ngIf",o.project.invites)},dependencies:[p.O5,j.Hw,V,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,C.lW,A.v,tt,pt,rt.B]}),i})();const Ze=["membersFilter"];function Se(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",22)(2,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().ngIf,a=t.oxw();return t.KtG(a.onTransferOwnership(n))}),t.TgZ(3,"mat-icon"),t._uU(4,"transfer_within_a_station"),t.qZA()()(),t.TgZ(5,"div",22)(6,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().ngIf,a=t.oxw();return t.KtG(a.onEdit(n))}),t.TgZ(7,"mat-icon"),t._uU(8,"edit"),t.qZA()()(),t.TgZ(9,"div",22)(10,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().ngIf,a=t.oxw();return t.KtG(a.onKick(n))}),t.TgZ(11,"mat-icon"),t._uU(12,"logout"),t.qZA()()()()}if(2&i){const e=r.ngIf;t.xp6(1),t.Q6J("matTooltip",e.transferOwnershipTooltip),t.xp6(1),t.Q6J("disabled",!e.canTransferOwnership),t.xp6(3),t.Q6J("matTooltip",e.updateMemberTooltip),t.xp6(1),t.Q6J("disabled",!e.canUpdateMember),t.xp6(3),t.Q6J("matTooltip",e.kickMemberTooltip),t.xp6(1),t.Q6J("disabled",!e.canKickMember)}}function Me(i,r){if(1&i&&(t.TgZ(0,"div",17)(1,"h2"),t._uU(2,"Your Profile"),t.qZA(),t.TgZ(3,"div",18),t._UZ(4,"app-project-member-profile",19),t.YNc(5,Se,13,6,"div",20),t.qZA()()),2&i){const e=r.ngIf,o=t.oxw();t.xp6(4),t.Q6J("projectMember",e),t.xp6(1),t.Q6J("ngIf",o.getProjectMemberOptions(e))}}function Pe(i,r){1&i&&(t.TgZ(0,"div",25),t._uU(1,"Members"),t.qZA())}function Oe(i,r){if(1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"remove_red_eye"),t.qZA(),t.YNc(2,Pe,2,0,"div",24)),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.breakpointManager.matchedBreakpointOrAbove("MOBILE","key"))}}function De(i,r){1&i&&(t.TgZ(0,"th",26),t._uU(1," User "),t.qZA())}function ke(i,r){if(1&i&&(t.TgZ(0,"td",27),t._UZ(1,"app-inline-profile",28),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.Q6J("user",e.user)}}function Ue(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onForceAddUser())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Force Add User "),t.qZA()}}function Je(i,r){if(1&i&&(t.TgZ(0,"th",29)(1,"div",30),t.YNc(2,Ue,4,0,"button",31),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.projectOptions.canCreateProjectMember)}}function Ye(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",30)(1,"div",22)(2,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.onTransferOwnership(n))}),t.TgZ(3,"mat-icon"),t._uU(4,"transfer_within_a_station"),t.qZA()()(),t.TgZ(5,"div",22)(6,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.onEdit(n))}),t.TgZ(7,"mat-icon"),t._uU(8,"edit"),t.qZA()()(),t.TgZ(9,"div",22)(10,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.onKick(n))}),t.TgZ(11,"mat-icon"),t._uU(12,"logout"),t.qZA()()()()}if(2&i){const e=r.ngIf;t.xp6(1),t.Q6J("matTooltip",e.transferOwnershipTooltip),t.xp6(1),t.Q6J("disabled",!e.canTransferOwnership),t.xp6(3),t.Q6J("matTooltip",e.updateMemberTooltip),t.xp6(1),t.Q6J("disabled",!e.canUpdateMember),t.xp6(3),t.Q6J("matTooltip",e.kickMemberTooltip),t.xp6(1),t.Q6J("disabled",!e.canKickMember)}}function Ne(i,r){if(1&i&&(t.TgZ(0,"td",33),t.YNc(1,Ye,13,6,"div",34),t.qZA()),2&i){const e=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.getProjectMemberOptions(e))}}function Ee(i,r){1&i&&t._UZ(0,"tr",35)}function Qe(i,r){1&i&&t._UZ(0,"tr",36)}function qe(i,r){1&i&&(t.TgZ(0,"div"),t._uU(1,"Invites"),t.qZA())}function Fe(i,r){if(1&i&&(t.TgZ(0,"div",38)(1,"mat-icon"),t._uU(2,"mail"),t.qZA(),t.YNc(3,qe,2,0,"div",16),t.qZA()),2&i){const e=t.oxw(2);let o;t.Q6J("matBadge",null!==(o=null==e.project||null==e.project.invites?null:e.project.invites.length)&&void 0!==o&&o?null==e.project||null==e.project.invites?null:e.project.invites.length:void 0),t.xp6(3),t.Q6J("ngIf",e.breakpointManager.matchedBreakpointOrAbove("MOBILE","key"))}}function Be(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-tab"),t.YNc(1,Fe,4,2,"ng-template",3),t.TgZ(2,"app-invites-tab",37),t.NdJ("edited",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onInvitesEdited())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("project",e.project)("projectOptions",e.projectOptions)}}let Re=(()=>{class i{constructor(e,o,n,a,l,m){this.cdn=e,this.breakpointManager=o,this.backend=n,this.security=a,this.uiMessage=l,this.dialog=m,this.edited=new t.vpe,this.project={},this.projectOptions={isMember:!1,manageSomeMembers:!1,nonExistent:!1,canUpdateProject:!1,inviteSent:!1,isAuthenticated:!1,loaded:!1,canDeleteProject:!1,canManageMetadata:!1,canCreateProjectMember:!1,canJoinProject:!1},this.displayedColumns=["member","buttons"],this.filteredProjectMembers=[],this.onDestroy$=new Q.x}ngAfterViewInit(){!this.filterHeader||this.filterHeader.newSearchRequest.pipe((0,D.R)(this.onDestroy$)).subscribe(this.onNewSearchRequest.bind(this))}ngOnChanges(e){e.project&&(this.project.members&&(this.filteredProjectMembers=(0,T.I8)(this.project.members)),this.currentProjectOwner=this.project.members?.find(o=>o?.roles?.some(n=>n?.roleCode===_.LO.ProjectOwner)))}getUserMember(){return this.project.members?.find(e=>e?.user?.id===this.security.securityContext?.userId)??{}}onNewSearchRequest(e){""===e?this.filteredProjectMembers=(0,T.I8)(this.project.members):(this.filteredProjectMembers=this.project.members.filter(o=>o.user.username.indexOf(e)>-1),this.filteredProjectMembers=this.filteredProjectMembers.sort((o,n)=>n.user.username.indexOf(e)-o.user.username.indexOf(e)))}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}onEdit(e){var o=this;return(0,u.Z)(function*(){(yield(0,x.z)(o.dialog.open(ee,{data:{projectMember:e,projectId:o.project.id,projectMemberOptions:o.getProjectMemberOptions(e)},width:"37.5em",maxWidth:"90vw"}).afterClosed()))&&o.edited.emit()})()}onKick(e){var o=this;return(0,u.Z)(function*(){let n=`Are you sure you want to kick "${e?.user?.displayName}" (@${e?.user?.username})?`;if(e?.user?.id===o.security.securityContext?.userId&&(n="Are you sure you want to leave the project?"),yield o.uiMessage.confirmDialog(n).pipe((0,nt.P)()).toPromise()){const l=yield(0,x.z)(o.backend.withAuth().mutate({mutation:b.Ps`
            mutation KickMember($id: ID!) {
              deleteProjectMember(id: $id)
            }
          `,variables:{id:e?.id}}));if(l.errors||!l.data)return}})()}getProjectMemberOptions(e){if(!e||!e.id||!this.project.members)return{canKickMember:!1,canUpdateMember:!1,canTransferOwnership:!1,canManageMemberRoles:!1,kickMemberTooltip:"",updateMemberTooltip:"",transferOwnershipTooltip:""};const o=this.security.makePermCalc();let n=!0,a="";o.withDomain({projectMemberId:e.id}).hasPermission(_.y3.ManageProjectMember)||(n=!1,a="Insufficient permissions");let l=!0,m="";e.id===this.currentProjectOwner?.id&&(l=!1,m="Cannot transfer ownership to the current project owner!"),o.withDomain({projectId:this.project.id??""}).hasPermission(_.y3.TransferProjectOwnership)||(l=!1,m="Insufficient permissions");let h=!0,y="";return n||(h=!1,y="Insufficient permissions"),1===this.project.members.length&&(h=!1,y="Project must have at least one member"),e.roles?.some(k=>k?.roleCode===_.LO.ProjectOwner)&&(h=!1,y="Cannot kick the owner until ownership is transferred!"),{canUpdateMember:n,canKickMember:h,canManageMemberRoles:o.withDomain({projectMemberId:e.id}).hasPermission(_.y3.ManageProjectMemberRoles),canTransferOwnership:l,kickMemberTooltip:y,updateMemberTooltip:a,transferOwnershipTooltip:m}}onTransferOwnership(e){var o=this;return(0,u.Z)(function*(){!e||!(yield(0,x.z)(o.uiMessage.confirmDialog(`Are you sure you want to transfer ownership of "${o.project.name}" to "${e.user?.username}"?`)))||(yield(0,x.z)(o.backend.withAuth().mutate({mutation:b.Ps`
          mutation TransferProjectOwnership($projectId: ID!, $memberId: ID!) {
            transferProjectOwnership(projectId: $projectId, memberId: $memberId)
          }
        `,variables:{projectId:o.project.id,memberId:e.id}}))).errors||(o.edited.emit(),o.uiMessage.notifyConfirmed("Ownership transferred!"))})()}onInvitesEdited(){this.edited.emit()}sortData(e){const o=this.filteredProjectMembers.slice();this.filteredProjectMembers=e.active&&""!==e.direction?o.sort((n,a)=>"member"===e.active?(0,T.qu)(n.user?.username,a.user?.username,"asc"===e.direction):0):o}onForceAddUser(){var e=this;return(0,u.Z)(function*(){(yield(0,x.z)(e.dialog.open(ce,{data:{project:e.project},width:"25em",maxWidth:"90vw"}).afterClosed()))&&e.edited.emit()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(I.Ub),t.Y36(I.IW),t.Y36(I.v$),t.Y36(I.Il),t.Y36(S.S),t.Y36(f.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-members-tab"]],viewQuery:function(e,o){if(1&e&&t.Gf(Ze,5),2&e){let n;t.iGM(n=t.CRH())&&(o.filterHeader=n.first)}},inputs:{project:"project",projectOptions:"projectOptions"},outputs:{edited:"edited"},features:[t.TTD],decls:20,vars:6,consts:[["full-page",""],["style","\n    margin-bottom: 5em;\n  ",4,"ngIf"],["mat-align-tabs","center","mat-stretch-tabs","",3,"selectedIndex"],["mat-tab-label",""],[2,"margin-top","2em"],["searchBar",""],["membersFilter",""],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%",3,"dataSource","matSortChange"],["matColumnDef","member"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by user",4,"matHeaderCellDef"],["mat-cell","","style","max-width: 100px; overflow: hidden;",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[2,"margin-bottom","5em"],[2,"display","flex","flex-direction","row","gap","1em"],[2,"flex","1",3,"projectMember"],["style","\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        gap: 0.5em;\n      ",4,"ngIf"],[2,"display","flex","flex-direction","column","justify-content","center","gap","0.5em"],[3,"matTooltip"],["mat-icon-button","",3,"disabled","click"],["style","margin-left: 0.5em;",4,"ngIf"],[2,"margin-left","0.5em"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by user"],["mat-cell","",2,"max-width","100px","overflow","hidden"],[3,"user"],["mat-header-cell",""],[2,"display","flex","justify-content","right"],["mat-stroked-button","","pill","","class","text-foreground",3,"click",4,"ngIf"],["mat-stroked-button","","pill","",1,"text-foreground",3,"click"],["mat-cell",""],["style","\n                display: flex;\n                justify-content: right;\n              ",4,"ngIf"],["mat-header-row",""],["mat-row",""],[3,"project","projectOptions","edited"],["matBadgeOverlap","false",2,"display","flex","flex-direction","row","gap","0.5em",3,"matBadge"]],template:function(e,o){1&e&&(t.TgZ(0,"app-bg-container",0),t.YNc(1,Me,6,2,"div",1),t.TgZ(2,"h2"),t._uU(3,"Membership"),t.qZA(),t.TgZ(4,"mat-tab-group",2)(5,"mat-tab"),t.YNc(6,Oe,3,1,"ng-template",3),t.TgZ(7,"div",4),t._UZ(8,"app-filter-header",5,6),t.TgZ(10,"table",7),t.NdJ("matSortChange",function(a){return o.sortData(a)}),t.ynx(11,8),t.YNc(12,De,2,0,"th",9),t.YNc(13,ke,2,1,"td",10),t.BQk(),t.ynx(14,11),t.YNc(15,Je,3,1,"th",12),t.YNc(16,Ne,2,1,"td",13),t.BQk(),t.YNc(17,Ee,1,0,"tr",14),t.YNc(18,Qe,1,0,"tr",15),t.qZA()()(),t.YNc(19,Be,3,2,"mat-tab",16),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.projectOptions.isMember&&o.getUserMember()),t.xp6(3),t.Q6J("selectedIndex",0),t.xp6(6),t.Q6J("dataSource",o.filteredProjectMembers),t.xp6(7),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("ngIf",o.projectOptions.canUpdateProject))},dependencies:[p.O5,j.Hw,ct.k,M.SP,M.uD,M.uX,L.gM,V,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,C.lW,A.v,tt,pt,rt.B,Ct,Tt.h,Ae],styles:[".content-width-padding[_ngcontent-%COMP%]{padding:var(--content-padding);padding-top:0}.content[_ngcontent-%COMP%]{display:block;margin:auto;padding-top:0;max-width:var(--content-width)}.mat-tab-labels[_ngcontent-%COMP%]{justify-content:space-around;display:flex}.mat-tab-member[_ngcontent-%COMP%]{flex:1}.mat-tab-buttons[_ngcontent-%COMP%]{flex:0}"]}),i})();var wt=s(9910),at=s(3451),It=s(8505),He=s(5561),X=s(7084);function $e(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-chip",4),t.NdJ("removed",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.remove(a))}),t._uU(1),t.TgZ(2,"button",5)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&i){const e=r.$implicit;t.xp6(1),t.hij(" ",e," ")}}let Le=(()=>{class i extends K.Y{constructor(){super(...arguments),this.limit=-1,this.addOnBlur=!0,this.separatorKeysCodes=[H.K5,H.OC],this.controlType="app-user-input",this.id=`${this.controlType}-${i.nextId++}`}add(e){const o=(e.value||"").trim();this.value||(this.value=[]),o&&!this.value.includes(o)&&(this.limit<0||this.value.length<this.limit)&&(this.value.push(o),this.onChange(this.value)),e.chipInput.clear()}remove(e){if(!this.value)return;const o=this.value.indexOf(e);o>=0&&(this.value.splice(o,1),this.onChange(this.value))}get empty(){return!this.value||0===this.value.length}}return i.nextId=0,i.\u0275fac=function(){let r;return function(o){return(r||(r=t.n5z(i)))(o||i)}}(),i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tags-input"]],inputs:{limit:"limit"},features:[t._Bn([{provide:v.Eo,useExisting:i}]),t.qOj],decls:4,vars:4,consts:[["aria-label","Tags editor",2,"width","100%"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-chip-list",0,1),t.YNc(2,$e,5,1,"mat-chip",2),t.TgZ(3,"input",3),t.NdJ("matChipInputTokenEnd",function(a){return o.add(a)}),t.qZA()()),2&e){const n=t.MAs(1);t.xp6(2),t.Q6J("ngForOf",o.value),t.xp6(1),t.Q6J("matChipInputFor",n)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",o.addOnBlur)}},dependencies:[p.sg,X.qn,X.HS,X.oH,X.qH,j.Hw]}),i})();function ze(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"input",5),t.NdJ("ngModelChange",function(n){const l=t.CHM(e).$implicit;return t.KtG(l.string=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.edited())}),t.qZA()(),t.TgZ(3,"mat-icon",6),t._uU(4,"drag_indicator"),t.qZA(),t.TgZ(5,"button",7),t.NdJ("click",function(){const a=t.CHM(e).index,l=t.oxw();return t.KtG(l.deleteString(a))}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()()}if(2&i){const e=r.$implicit;t.xp6(2),t.Q6J("ngModel",e.string)}}let Ge=(()=>{class i extends K.Y{constructor(e,o,n,a){super(o,n,a),this.changeDetector=e,this.limit=-1,this.stringElementArray=[]}get shouldLabelFloat(){return!0}get value(){return this.stringElementArray.map(e=>e.string)}set value(e){e&&(this.stringElementArray=e.map(o=>({string:o})))}drop(e){!this.stringElementArray||e.previousIndex===e.currentIndex||((0,q.bA)(this.stringElementArray,e.previousIndex,e.currentIndex),this.edited())}edited(){this.onChange(this.value),this.markAsTouched()}addString(){this.stringElementArray.unshift({string:""}),this.edited()}deleteString(e){this.stringElementArray.splice(e,1),this.edited(),this.changeDetector.detectChanges()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.sBO),t.Y36(E.tE),t.Y36(t.SBq),t.Y36(d.a5,10))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-string-array-input"]],inputs:{limit:"limit"},features:[t._Bn([{provide:v.Eo,useExisting:i}]),t.qOj],decls:6,vars:1,consts:[["cdkDropList","",1,"background-color-card","border-color-divider",2,"width","100%","max-width","100%","border-style","solid","border-width","1px","display","block","border-radius","0.5em","overflow","hidden",3,"cdkDropListDropped"],["mat-stroked-button","",1,"border-color-divider",2,"width","100%","border-radius","0.5em 0.5em 0 0","border-left","none","border-right","none","border-top","none","border-bottom-style","solid","border-bottom-width","1px",3,"click"],["class","drag-item background-color-card text-text border-color-divider","style","\n    padding: 1em 0.75em;\n    border-bottom-style: solid;\n    border-bottom-width: 1px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5em;\n    justify-content: space-between;\n    box-sizing: border-box;\n    font-size: 1em;\n  ","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"drag-item","background-color-card","text-text","border-color-divider",2,"padding","1em 0.75em","border-bottom-style","solid","border-bottom-width","1px","display","flex","flex-direction","row","align-items","center","gap","0.5em","justify-content","space-between","box-sizing","border-box","font-size","1em"],[1,"border-color-divider",2,"border-style","solid","border-width","1px","border-radius","0.5em","padding","0.5em","flex","1"],["matInput","","type","text","placeholder","Enter text here...",3,"ngModel","ngModelChange"],["cdkDragHandle","",2,"cursor","move"],["mat-icon-button","",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.NdJ("cdkDropListDropped",function(a){return o.drop(a)}),t.TgZ(1,"button",1),t.NdJ("click",function(){return o.addString()}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA(),t._uU(4," Add "),t.qZA(),t.YNc(5,ze,8,1,"div",2),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngForOf",o.stringElementArray))},dependencies:[p.sg,q.Wj,q.Zt,q.Bh,P.Nt,j.Hw,d.Fj,d.JJ,d.On,C.lW,A.v],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.drag-item[_ngcontent-%COMP%]:last-child{border-bottom:solid transparent 0}.drag-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),i})();var Ve=s(2272),W=s(7117),Ke=s(8009);const Xe=["imageFileInput"];function We(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6),t.NdJ("click",function(){const a=t.CHM(e).index,l=t.oxw();return t.KtG(l.deleteImageFile(a))}),t.TgZ(2,"mat-icon"),t._uU(3,"close"),t.qZA()(),t.TgZ(4,"div",7),t._uU(5),t.qZA(),t.TgZ(6,"div",8)(7,"div",9),t._UZ(8,"img",10),t.qZA()()()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(5),t.Oqu(e.source),t.xp6(3),t.Q6J("src",o.cdn.getFileLink(e.source),t.LSH)}}let ti=(()=>{class i extends K.Y{constructor(e,o,n,a,l,m){super(a,l,m),this.cdn=e,this.uiMessageService=o,this.changeDetector=n,this.fileSizeLimit="10 MB",this.limit=-1,this.monitor=new Y.y,this.fileSizeLimitBytes=0}ngOnInit(){this.fileSizeLimitBytes=W.P.byteStringToBytes(this.fileSizeLimit)}get shouldLabelFloat(){return!0}onImageFileChanged(e){if(this.limit>-1&&this.value&&this.value.length>this.limit)return;const o=e.target.files[0];o&&(this.monitor.addProcess(),this.changeDetector.detectChanges(),W.P.readAsBase64(o).then(n=>{const a=o.size;a<this.fileSizeLimitBytes?(this.value||(this.value=[]),this.value.push({upload:o,source:n}),this.onChange(this.value),this.markAsTouched()):this.uiMessageService.error(`File size is too big! ${W.P.byteSizeToString(a)} > ${W.P.byteSizeToString(this.fileSizeLimitBytes)}`)}).catch(n=>{console.log(n)}).finally(()=>{this.imageFileInput&&(this.imageFileInput.nativeElement.value=""),this.monitor.removeProcess()}))}deleteImageFile(e){!this.value||(this.value.splice(e,1),this.changeDetector.detectChanges(),this.onChange(this.value),this.markAsTouched())}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(B.U),t.Y36(S.S),t.Y36(t.sBO),t.Y36(E.tE),t.Y36(t.SBq),t.Y36(d.a5,10))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-gallery-upload"]],viewQuery:function(e,o){if(1&e&&t.Gf(Xe,5),2&e){let n;t.iGM(n=t.CRH())&&(o.imageFileInput=n.first)}},inputs:{fileSizeLimit:"fileSizeLimit",limit:"limit"},features:[t._Bn([{provide:v.Eo,useExisting:i}]),t.qOj],decls:8,vars:4,consts:[["type","file","accept","image/png, image/jpeg, image/gif",2,"display","none",3,"change"],["imageFileInput",""],["mat-stroked-button","","pill","",2,"margin-bottom","0.5em",3,"disabled","click"],["column-width","15em",2,"width","100%",3,"auto-fit-columns"],["style","\n    position: relative;\n    border-radius: 0.5em;\n    padding: 1em;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    display: flex;\n    gap: 0.5em;\n    flex-direction: column;\n  ","class","border-color-divider",4,"ngFor","ngForOf"],[1,"border-color-divider",2,"position","relative","border-radius","0.5em","padding","1em","border-style","solid","border-width","1px","box-sizing","border-box","display","flex","gap","0.5em","flex-direction","column"],["mat-icon-button","",2,"position","absolute","top","0.2em","right","0.2em",3,"click"],[2,"text-overflow","ellipsis","overflow","hidden","white-space","nowrap","margin-right","2em"],[2,"height","0","overflow","hidden","padding-top","100%","box-sizing","border-box","position","relative"],[2,"width","100%","vertical-align","top","position","absolute","top","0","left","0","height","100%"],[2,"height","100%","width","100%","object-fit","cover",3,"src"]],template:function(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"input",0,1),t.NdJ("change",function(l){return o.onImageFileChanged(l)}),t.qZA(),t.TgZ(2,"button",2),t.NdJ("click",function(){t.CHM(n);const l=t.MAs(1);return t.KtG(l.click())}),t.TgZ(3,"mat-icon"),t._uU(4,"upload"),t.qZA(),t._uU(5," Add Image\n"),t.qZA(),t.TgZ(6,"app-card-grid",3),t.YNc(7,We,9,2,"div",4),t.qZA()}2&e&&(t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing||o.disabled)("disabled",o.limit>-1&&o.value&&o.value.length>=o.limit),t.xp6(4),t.Q6J("auto-fit-columns",!0),t.xp6(1),t.Q6J("ngForOf",o.value))},dependencies:[p.sg,C.lW,j.Hw,Ke.Y,A.v],styles:["[_nghost-%COMP%]{position:relative;width:100%}"]}),i})();const ei=["cardImageUpload"],ii=["bannerUpload"];function oi(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Project name is required "),t.qZA())}function ni(i,r){if(1&i&&(t.TgZ(0,"mat-select-trigger",29)(1,"mat-icon"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&i){const e=r.ngIf,o=t.oxw();t.xp6(2),t.Oqu(o.accessOptions[e].matIcon),t.xp6(1),t.hij(" ",o.accessOptions[e].name," ")}}function ri(i,r){if(1&i&&(t.TgZ(0,"mat-option",30)(1,"div",31)(2,"mat-icon"),t._uU(3),t.qZA(),t._uU(4),t.qZA()()),2&i){const e=r.$implicit;t.Q6J("value",e.key),t.xp6(3),t.Oqu(e.value.matIcon),t.xp6(1),t.hij(" ",e.value.name," ")}}function ai(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Project name is required "),t.qZA())}function si(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Pitch is required "),t.qZA())}function ci(i,r){if(1&i&&(t.TgZ(0,"div")(1,"h2"),t._uU(2,"Metadata"),t.qZA(),t.TgZ(3,"mat-form-field",11)(4,"mat-label"),t._uU(5,"Created At"),t.qZA(),t._UZ(6,"input",32),t.TgZ(7,"mat-hint"),t._uU(8,"MM/DD/YYYY"),t.qZA(),t._UZ(9,"mat-datepicker-toggle",33)(10,"mat-datepicker",null,34),t.qZA(),t.TgZ(12,"mat-form-field",11)(13,"mat-label"),t._uU(14,"Completed At"),t.qZA(),t._UZ(15,"input",35),t.TgZ(16,"mat-hint"),t._uU(17,"MM/DD/YYYY"),t.qZA(),t._UZ(18,"mat-datepicker-toggle",33)(19,"mat-datepicker",null,36),t.qZA()()),2&i){const e=t.MAs(11),o=t.MAs(20);t.xp6(6),t.Q6J("matDatepicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(6),t.Q6J("matDatepicker",o),t.xp6(3),t.Q6J("for",o)}}const li=new RegExp(/https%3A\/\/api\.soundcloud\.com\/.+\/[0-9]+/);let di=(()=>{class i{constructor(e,o,n,a,l,m,h){this.backend=o,this.cdnService=n,this.uiMessageService=a,this.changeDetector=l,this.dialogRef=m,this.data=h,this.edited=new t.vpe,this.monitor=new at.yv,this.accessOptions=wt.tT,this.form=e.group({name:[this.data.project.name,[d.kI.required]],access:[this.data.project.access,[d.kI.required]],galleryImages:[this.data.project.galleryImageLinks?.map(y=>({source:y}))],downloadLinks:[this.data.project.downloadLinks],soundcloudEmbedSrc:[this.data.project.soundcloudEmbedSrc],pitch:[this.data.project.pitch,[d.kI.required]],description:[this.data.project.description],tags:[this.data.project.tags?.slice()],completed:[this.data.project.completedAt],createdAt:[new Date(this.data.project.createdAt)],completedAt:[{value:this.data.project.completedAt?new Date(this.data.project.completedAt):null,disabled:!this.data.project.completedAt}]}),m.disableClose=!0}ngAfterViewInit(){!this.cardImageUpload||!this.bannerUpload||!this.data.project.id||(this.cardImageUpload.init(this.cdnService.getFileLink(this.data.project.cardImageLink)),this.bannerUpload.init(this.cdnService.getFileLink(this.data.project.bannerLink)),this.changeDetector.detectChanges())}exit(e=!1){this.monitor.isProcessing||this.dialogRef.close(e)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Some project information is missing!");if(""!==this.form.get("soundcloudEmbedSrc")?.value&&this.form.get("soundcloudEmbedSrc")?.value!==this.data.project.soundcloudEmbedSrc){const e=this.form.get("soundcloudEmbedSrc")?.value??"",o=li.exec(e);if(!o||0===o.length)return this.uiMessageService.error("Soundcloud embed source is not valid!"),!1;this.form.get("soundcloudEmbedSrc")?.setValue(o[0])}return!0}catch(e){return this.uiMessageService.error(e),!1}}save(){if(this.monitor.isProcessing||!this.cardImageUpload||!this.bannerUpload||!this.validate())return;const e={id:this.data.project.id};if(this.form.get("access")?.value!==this.data.project.access&&(e.access=this.form.get("access")?.value),this.form.get("name")?.value!==this.data.project.name&&(e.name=this.form.get("name")?.value),this.form.get("pitch")?.value!==this.data.project.pitch&&(e.pitch=this.form.get("pitch")?.value),this.form.get("description")?.value!==this.data.project.description&&(e.description=this.form.get("description")?.value),this.form.get("soundcloudEmbedSrc")?.value!==this.data.project.soundcloudEmbedSrc&&(e.soundcloudEmbedSrc=this.form.get("soundcloudEmbedSrc")?.value),(!1===this.form.get("completed")?.value&&this.data.project.completedAt||!0===this.form.get("completed")?.value&&!this.data.project.completedAt)&&(e.completed=this.form.get("completed")?.value),(0,T.cO)(this.form.get("downloadLinks")?.value,this.data.project.downloadLinks)||(e.downloadLinks=this.form.get("downloadLinks")?.value),(0,T.cO)(this.form.get("tags")?.value,this.data.project.tags)||(e.tags=this.form.get("tags")?.value),this.data.projectOptions.canManageMetadata){const o=this.form.get("completedAt")?.value?.getTime();this.data.project.completedAt&&o!==this.data.project.completedAt&&(e.completedAt=o);const n=this.form.get("createdAt")?.value?.getTime();n!==this.data.project.createdAt&&(e.createdAt=n)}this.form.get("galleryImages")?.touched&&(e.galleryImages=this.form.get("galleryImages")?.value.map(o=>({...!o.source?.startsWith("data:")&&{source:o.source},...o.upload&&{upload:o.upload}}))),this.cardImageUpload.edited&&(e.cardImage=this.cardImageUpload.value?{upload:this.cardImageUpload.value,operation:_.f0.Insert}:{operation:_.f0.Delete}),this.bannerUpload.edited&&(e.banner=this.bannerUpload.value?{upload:this.bannerUpload.value,operation:_.f0.Insert}:{operation:_.f0.Delete}),Object.keys(e).length>1&&(this.monitor.addProcess(),this.backend.withAuth().mutate({mutation:b.Ps`
            mutation DialogUpdateProject($input: UpdateProjectInput!) {
              updateProject(input: $input)
            }
          `,variables:{input:e}}).pipe((0,nt.P)()).subscribe({next:o=>{this.monitor.removeProcess(),this.exit(!0)},error:o=>{this.monitor.removeProcess(),this.uiMessageService.error("Error uploading data!")}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.QS),t.Y36(I.v$),t.Y36(B.U),t.Y36(S.S),t.Y36(t.sBO),t.Y36(f.so),t.Y36(f.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-project-dialog"]],viewQuery:function(e,o){if(1&e&&(t.Gf(ei,5),t.Gf(ii,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.cardImageUpload=n.first),t.iGM(n=t.CRH())&&(o.bannerUpload=n.first)}},outputs:{edited:"edited"},decls:68,vars:21,consts:[[2,"position","relative",3,"formGroup"],[2,"width","100%","height","12.5em","border-radius","0.25em","overflow","hidden"],["fileSizeLimit","10 MB"],["bannerUpload",""],[2,"--size","8em","--offset","calc(var(--size) / 2)","--offset-left-over","calc(var(--size) - var(--offset))","position","relative","height","var(--offset-left-over)","margin-bottom","1em"],[1,"outline-color-card",2,"left","2em","top","calc(-1 * var(--offset))","position","absolute","height","var(--size)","width","var(--size)","border-radius","1em","overflow","hidden","outline-style","solid","outline-width","0.25em"],[1,"background-color-card",2,"width","100%","height","100%"],["fileSizeLimit","5 MB",1,"app-edit-project-dialog","card-image"],["cardImageUpload",""],[2,"display","flex","flex-direction","row","flex-wrap","wrap-reverse","justify-content","left","align-items","flex-end","margin-bottom","16px","gap","24px"],[2,"flex","1","display","flex","flex-direction","row","flex-wrap","wrap","gap","12px","align-items","center"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","name"],[4,"ngIf"],["appearance","outline",2,"flex","1"],["formControlName","access"],["style","\n              display: flex;\n              align-items: center;\n              gap: 1em;\n              height: 20px;\n            ",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["formControlName","completed",2,"flex","1","margin","0.5em"],["appearance","outline",1,"no-padding",2,"width","100%","line-height","1.5em"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5","formControlName","pitch",3,"maxLength"],["align","end"],["appearance","outline",2,"width","100%","line-height","1.5em"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","5","formControlName","description",3,"maxLength"],["fileSizeLimit","5 MB","formControlName","galleryImages",3,"limit"],["matInput","","formControlName","soundcloudEmbedSrc"],["formControlName","downloadLinks",3,"limit"],["formControlName","tags",3,"limit"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"],[2,"display","flex","align-items","center","gap","1em","height","20px"],[3,"value"],[2,"display","flex","align-items","center"],["matInput","","formControlName","createdAt",3,"matDatepicker"],["matSuffix","",3,"for"],["createdAt",""],["matInput","","formControlName","completedAt",3,"matDatepicker"],["completedAt",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"div",1),t._UZ(3,"app-image-upload",2,3),t.qZA(),t.TgZ(5,"div",4)(6,"div",5)(7,"div",6),t._UZ(8,"app-image-upload",7,8),t.qZA()()(),t.TgZ(10,"div",9)(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),t._uU(14,"Project Name"),t.qZA(),t._UZ(15,"input",12),t.YNc(16,oi,2,0,"mat-error",13),t.qZA(),t.TgZ(17,"mat-form-field",14)(18,"mat-label"),t._uU(19,"Access"),t.qZA(),t.TgZ(20,"mat-select",15),t.YNc(21,ni,4,2,"mat-select-trigger",16),t.YNc(22,ri,5,3,"mat-option",17),t.ALo(23,"keyvalue"),t.qZA(),t.YNc(24,ai,2,0,"mat-error",13),t.qZA(),t.TgZ(25,"mat-checkbox",18),t._uU(26,"Completed"),t.qZA()()(),t.TgZ(27,"mat-form-field",19)(28,"mat-label"),t._uU(29,"Pitch"),t.qZA(),t._UZ(30,"textarea",20),t.TgZ(31,"mat-hint",21),t._uU(32),t.qZA(),t.YNc(33,si,2,0,"mat-error",13),t.qZA(),t.TgZ(34,"mat-form-field",22)(35,"mat-label"),t._uU(36,"Description"),t.qZA(),t._UZ(37,"textarea",23),t.TgZ(38,"mat-hint",21),t._uU(39),t.qZA()(),t.TgZ(40,"mat-form-field",11)(41,"mat-label"),t._uU(42,"Gallery Images"),t.qZA(),t._UZ(43,"app-gallery-upload",24),t.TgZ(44,"mat-hint",21),t._uU(45),t.qZA()(),t.TgZ(46,"mat-form-field",11)(47,"mat-label"),t._uU(48,"Soundcloud Embed Source"),t.qZA(),t._UZ(49,"input",25),t.qZA(),t.TgZ(50,"mat-form-field",11)(51,"mat-label"),t._uU(52,"Download/Play Links"),t.qZA(),t._UZ(53,"app-string-array-input",26),t.TgZ(54,"mat-hint",21),t._uU(55),t.qZA()(),t.TgZ(56,"mat-form-field",11)(57,"mat-label"),t._uU(58,"Tags"),t.qZA(),t._UZ(59,"app-tags-input",27),t.TgZ(60,"mat-hint",21),t._uU(61),t.qZA()(),t.YNc(62,ci,21,4,"div",13),t.qZA()(),t.TgZ(63,"mat-dialog-actions")(64,"button",28),t.NdJ("click",function(){return o.exit()}),t._uU(65,"Exit "),t.qZA(),t.TgZ(66,"button",28),t.NdJ("click",function(){return o.save()}),t._uU(67,"Save "),t.qZA()()),2&e){let n,a,l,m,h,y,w,k,R;t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(15),t.Q6J("ngIf",null==(n=o.form.get("name"))?null:n.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(a=o.form.get("access"))?null:a.value),t.xp6(1),t.Q6J("ngForOf",t.lcZ(23,19,o.accessOptions)),t.xp6(2),t.Q6J("ngIf",null==(l=o.form.get("access"))?null:l.hasError("required")),t.xp6(6),t.Q6J("maxLength",300),t.xp6(2),t.hij("",(null==(m=o.form.get("pitch"))||null==m.value?null:m.value.length)||0,"/300"),t.xp6(1),t.Q6J("ngIf",null==(h=o.form.get("pitch"))?null:h.hasError("required")),t.xp6(4),t.Q6J("maxLength",2e3),t.xp6(2),t.hij("",(null==(y=o.form.get("description"))||null==y.value?null:y.value.length)||0,"/2000"),t.xp6(4),t.Q6J("limit",5),t.xp6(2),t.hij("",(null==(w=o.form.get("galleryImages"))||null==w.value?null:w.value.length)||0,"/5"),t.xp6(8),t.Q6J("limit",5),t.xp6(2),t.hij("",(null==(k=o.form.get("downloadLinks"))||null==k.value?null:k.value.length)||0,"/5"),t.xp6(4),t.Q6J("limit",5),t.xp6(2),t.hij("",(null==(R=o.form.get("tags"))||null==R.value?null:R.value.length)||0,"/5"),t.xp6(1),t.Q6J("ngIf",o.data.projectOptions.canManageMetadata),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing),t.xp6(2),t.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[p.sg,p.O5,xt.IC,v.TO,v.KE,v.bx,v.hX,v.R9,P.Nt,C.lW,A.v,Le,j.Hw,f.xY,f.H8,G.Mq,G.hl,G.nW,Ge,Ve.J,ti,ft.oG,ot.gD,ot.$L,Z.ey,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,p.Nd]}),i})();var pi=s(1656);const mi=function(){return{}};function ui(i,r){if(1&i&&t._UZ(0,"app-project-member-profile",2),2&i){let o;t.Q6J("projectMember",null!==(o=r.$implicit)&&void 0!==o?o:t.DdM(1,mi))}}let _i=(()=>{class i{constructor(){this.projectMembers=[]}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-project-members-display"]],inputs:{projectMembers:"projectMembers"},decls:2,vars:1,consts:[[2,"display","flex","flex-direction","column","gap","48px"],[3,"projectMember",4,"ngFor","ngForOf"],[3,"projectMember"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,ui,1,2,"app-project-member-profile",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",o.projectMembers))},dependencies:[p.sg,Ct]}),i})();var fi=s(9439);let At=(()=>{class i{constructor(e){this.templateRef=e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.Rgc))},i.\u0275dir=t.lG2({type:i,selectors:[["","appCarouselItem",""]]}),i})();var gi=s(3512);const hi=["transitionAnimationRoot"],vi=["fadeOutTransitionAnimationRoot"],bi=["carouselButtonsContainer"];function xi(i,r){}function yi(i,r){if(1&i&&(t.TgZ(0,"div",15)(1,"div",16),t.YNc(2,xi,0,0,"ng-template",17),t.qZA()()),2&i){const e=r.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",o.getItemStyle()),t.xp6(1),t.Q6J("ngTemplateOutlet",e.templateRef)}}function ji(i,r){}function Ci(i,r){if(1&i&&(t.TgZ(0,"div",15)(1,"div",16),t.YNc(2,ji,0,0,"ng-template",17),t.qZA()()),2&i){const e=r.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",o.getItemStyle()),t.xp6(1),t.Q6J("ngTemplateOutlet",e.templateRef)}}const Ti=function(i){return{active:i}};function wi(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){const a=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.gotoSlide(a))}),t.qZA()}if(2&i){const e=r.index,o=t.oxw(2);t.Q6J("ngClass",t.VKq(1,Ti,o.currentSlideIndex===e))}}function Ii(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4,5)(5,"div",6),t.YNc(6,yi,3,2,"div",7),t.qZA()(),t.TgZ(7,"div",4,8)(9,"div",6),t.YNc(10,Ci,3,2,"div",7),t.qZA()()(),t.TgZ(11,"div",9)(12,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.previous(!0))}),t.TgZ(13,"mat-icon"),t._uU(14,"keyboard_arrow_left"),t.qZA()(),t.TgZ(15,"button",11),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.next(!0))}),t.TgZ(16,"mat-icon"),t._uU(17,"keyboard_arrow_right"),t.qZA()()(),t.TgZ(18,"div",12,13),t.YNc(20,wi,1,3,"button",14),t.qZA()()()}if(2&i){const e=t.oxw();t.Q6J("ngStyle",e.getCarouselContainerStyle()),t.xp6(5),t.Q6J("ngStyle",e.getOffsetStyle()),t.xp6(1),t.Q6J("ngForOf",e.currentSlides),t.xp6(3),t.Q6J("ngStyle",e.getOffsetStyle()),t.xp6(1),t.Q6J("ngForOf",e.fadeoutSlides),t.xp6(8),t.Q6J("ngStyle",e.getCarouselButtonsContainerStyle()),t.xp6(2),t.Q6J("ngForOf",e.slides)}}let Ai=(()=>{class i{constructor(e,o,n,a){this.elementRef=e,this.changeDetector=o,this.animBuilder=n,this.cssLength=a,this.visibleSlides=1,this.autoplay=!1,this.autoplayDurationMS=2e3,this.timings="250ms ease-out",this.display="inline-block",this.currentSlides=[],this.fadeoutSlides=[],this.gap="0.5em",this.currentSlideIndex=0,this.sidePadding="2em"}ngOnDestroy(){this.slidePlayer&&this.slidePlayer.destroy(),this.fadeOutPlayer&&this.fadeOutPlayer.destroy(),this.fadeInPlayer&&this.fadeInPlayer.destroy(),this.stopAutoPlay()}ngAfterViewInit(){setTimeout(()=>{this.slides&&0!==this.slides.length?(this.updateCurrentSlide(0),this.autoplay&&this.startAutoPlay(),this.changeDetector.detectChanges()):this.display="none"})}updateCurrentSlide(e){if(!this.slides)return;const o=this.slides.toArray();this.currentSlideIndex=(0,T.DQ)(e,o.length),this.currentSlides=(0,T.Xl)(o,this.currentSlideIndex-1,this.visibleSlides+2)}getSlidePercentageWidth(){return 100/this.visibleSlides}getAnimationTransform(e=1){return`translateX(calc(${e} * ${this.getSlidePercentageWidth()}%)`}getDefaultAnimationTransform(){return"translateX(0)"}getNextAnimation(){return[(0,c.oB)({transform:this.getAnimationTransform(1)}),(0,c.jt)(this.timings,(0,c.oB)({transform:this.getDefaultAnimationTransform()}))]}getPreviousAnimation(){return[(0,c.oB)({transform:this.getAnimationTransform(-1)}),(0,c.jt)(this.timings,(0,c.oB)({transform:this.getDefaultAnimationTransform()}))]}getFadeoutAnimation(){return[(0,c.oB)({transform:"translateY(0)",opacity:1}),(0,c.jt)(this.timings,(0,c.oB)({transform:"translateY(100%)",opacity:0}))]}getFadeinAnimation(){return[(0,c.oB)({transform:"translateY(-100%)",opacity:0}),(0,c.jt)(this.timings,(0,c.oB)({transform:"translateY(0)",opacity:1}))]}next(e=!1){!this.transAnimRoot||(this.slidePlayer&&(this.slidePlayer.finish(),this.slidePlayer.destroy()),e&&this.stopAutoPlay(),this.slidePlayer=this.animBuilder.build(this.getNextAnimation()).create(this.transAnimRoot.nativeElement),this.slidePlayer.play(),this.updateCurrentSlide(this.currentSlideIndex+1))}previous(e=!1){!this.transAnimRoot||(this.slidePlayer&&(this.slidePlayer.finish(),this.slidePlayer.destroy()),e&&this.stopAutoPlay(),this.slidePlayer=this.animBuilder.build(this.getPreviousAnimation()).create(this.transAnimRoot.nativeElement),this.slidePlayer.play(),this.updateCurrentSlide(this.currentSlideIndex-1))}stopAutoPlay(){this.autoPlayIntervalId&&(clearInterval(this.autoPlayIntervalId),this.autoPlayIntervalId=void 0)}startAutoPlay(){this.autoPlayIntervalId||(this.autoPlayIntervalId=setInterval(()=>{this.next()},this.autoplayDurationMS))}getOffsetStyle(){return{transform:this.getDefaultAnimationTransform(),gap:this.gap}}getCarouselPxWidth(){return this.elementRef.nativeElement.offsetWidth-2*this.cssLength.convertToNumber(this.sidePadding,"px")}getPaddedCarouselPxWidth(){return this.elementRef.nativeElement.offsetWidth-this.cssLength.convertToNumber(this.sidePadding,"px")}getItemStyle(){return{width:this.getPaddedCarouselPxWidth()/this.visibleSlides-this.cssLength.convertToNumber(this.gap,"px")*(this.visibleSlides-1)*.5+"px",height:this.elementRef.nativeElement.offsetHeight+"px"}}fadeToSlide(e,o){!this.transAnimRoot||!this.fadeOutTransAnimRoot||(this.fadeOutPlayer&&(this.fadeOutPlayer.finish(),this.fadeOutPlayer.destroy()),this.fadeInPlayer&&(this.fadeInPlayer.finish(),this.fadeInPlayer.destroy()),o&&this.stopAutoPlay(),this.fadeoutSlides=this.currentSlides.slice(0),this.updateCurrentSlide(e),this.fadeInPlayer=this.animBuilder.build(this.getFadeinAnimation()).create(this.transAnimRoot.nativeElement),this.fadeOutPlayer=this.animBuilder.build(this.getFadeoutAnimation()).create(this.fadeOutTransAnimRoot.nativeElement),this.fadeInPlayer.play(),this.fadeOutPlayer.play())}gotoSlide(e){e=(0,T.DQ)(e,this.slides.length),this.currentSlideIndex!==e&&((0,T.DQ)(this.currentSlideIndex+1,this.slides.length)===e?this.next():(0,T.DQ)(this.currentSlideIndex-1,this.slides.length)===e?this.previous():this.fadeToSlide(e,!0))}areCarouselButtonsVisible(){return!!this.carouselButtonsContainer&&this.getCarouselPxWidth()>=this.carouselButtonsContainer.nativeElement.offsetWidth}getCarouselContainerStyle(){return{"padding-left":this.sidePadding,"padding-right":this.sidePadding}}getCarouselButtonsContainerStyle(){return{visibility:this.areCarouselButtonsVisible()?"visible":"hidden"}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(c._j),t.Y36(gi.I))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-carousel"]],contentQueries:function(e,o,n){if(1&e&&t.Suo(n,At,4),2&e){let a;t.iGM(a=t.CRH())&&(o.slides=a)}},viewQuery:function(e,o){if(1&e&&(t.Gf(hi,5),t.Gf(vi,5),t.Gf(bi,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.transAnimRoot=n.first),t.iGM(n=t.CRH())&&(o.fadeOutTransAnimRoot=n.first),t.iGM(n=t.CRH())&&(o.carouselButtonsContainer=n.first)}},hostVars:2,hostBindings:function(e,o){2&e&&t.Udp("display",o.display)},inputs:{visibleSlides:"visibleSlides",autoplay:"autoplay",autoplayDurationMS:"autoplayDurationMS",timings:"timings"},decls:1,vars:1,consts:[["style","\n  position: relative;\n  max-width: 100%;\n  height: 100%;\n",3,"ngStyle",4,"ngIf"],[2,"position","relative","max-width","100%","height","100%",3,"ngStyle"],[2,"position","relative","width","100%","height","100%"],[2,"position","relative","overflow","hidden","height","100%","width","100%","border-radius","0.5em"],[2,"position","absolute","width","100%","top","0"],["transitionAnimationRoot",""],[2,"display","flex","flex-direction","row","justify-content","center","align-items","center",3,"ngStyle"],["style","\n            display: inline;\n            position: relative;\n          ",4,"ngFor","ngForOf"],["fadeOutTransitionAnimationRoot",""],[2,"position","absolute","display","flex","flex-direction","row","align-items","center","top","0","height","100%","width","100%"],["mat-mini-fab","","color","blank",2,"position","absolute","left","-1.25em","display","flex","align-items","center","justify-content","center",3,"click"],["mat-mini-fab","","color","blank",2,"position","absolute","right","-1.25em","display","flex","align-items","center","justify-content","center",3,"click"],[2,"position","absolute","width","100%","bottom","1em","display","flex","flex-direction","row","justify-content","center","gap","0.5em",3,"ngStyle"],["carouselButtonsContainer",""],["mat-raised-button","","style","\n        border-radius: 1em;\n        height: 0.5em;\n        overflow: hidden;\n      ","class","app-carousel carousel-button",3,"ngClass","click",4,"ngFor","ngForOf"],[2,"display","inline","position","relative"],[3,"ngStyle"],[3,"ngTemplateOutlet"],["mat-raised-button","",1,"app-carousel","carousel-button",2,"border-radius","1em","height","0.5em","overflow","hidden",3,"ngClass","click"]],template:function(e,o){1&e&&t.YNc(0,Ii,21,7,"div",0),2&e&&t.Q6J("ngIf",o.currentSlides.length>0)},dependencies:[p.mk,p.sg,p.O5,p.tP,p.PC,C.lW,A.v,j.Hw],styles:["[_nghost-%COMP%]{display:inline-block}"]}),i})();var Zi=s(3324),Si=s(6387),Mi=s(2933);function Pi(i,r){1&i&&t._UZ(0,"div",15)}function Oi(i,r){1&i&&t._UZ(0,"div",16)}const Zt=function(){return[]};function Di(i,r){1&i&&(t.TgZ(0,"div"),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._UZ(6,"div",6),t.qZA(),t.TgZ(7,"div",7)(8,"div",8)(9,"h1",9),t._uU(10,"_"),t.qZA(),t.YNc(11,Pi,1,0,"div",10),t.qZA(),t.TgZ(12,"app-tag-container",11),t.YNc(13,Oi,1,0,"div",12),t.qZA(),t.TgZ(14,"div")(15,"p",13),t._uU(16," _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ "),t.qZA()()()(),t.TgZ(17,"div",14)(18,"div")(19,"p",13),t._uU(20,"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ "),t.qZA()()()()()()),2&i&&(t.xp6(11),t.Q6J("ngForOf",t.DdM(2,Zt).constructor(2)),t.xp6(2),t.Q6J("ngForOf",t.DdM(3,Zt).constructor(4)))}function ki(i,r){if(1&i&&t._UZ(0,"img",24),2&i){const e=t.oxw(2);t.Q6J("src",e.bannerSrc,t.LSH)}}function Ui(i,r){if(1&i&&(t.TgZ(0,"div",33)(1,"h4",34)(2,"mat-icon"),t._uU(3),t.qZA(),t._uU(4),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(3),t.Oqu(e.accessOptions[e.project.access].matIcon),t.xp6(1),t.hij(" ",e.accessOptions[e.project.access].name," ")}}function Ji(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(4);return t.KtG(n.join())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Join "),t.qZA()}if(2&i){const e=t.oxw(4);t.Q6J("disabled",e.monitor.isProcessing)}}function Yi(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(4);return t.KtG(n.requestInvite())}),t.TgZ(1,"mat-icon"),t._uU(2,"mail"),t.qZA(),t._uU(3),t.qZA()}if(2&i){const e=t.oxw(4);t.Q6J("disabled",e.projectOptions.inviteSent||e.monitor.isProcessing),t.xp6(3),t.hij(" ",e.projectOptions.inviteSent?"Invite requested":"Request to Join"," ")}}function Ni(i,r){1&i&&(t.TgZ(0,"button",38)(1,"mat-icon"),t._uU(2,"close"),t.qZA(),t._uU(3," Closed "),t.qZA())}function Ei(i,r){if(1&i&&(t.YNc(0,Ji,4,1,"button",35),t.YNc(1,Yi,4,2,"button",35),t.YNc(2,Ni,4,0,"button",36)),2&i){const e=t.oxw(3);t.Q6J("ngIf","OPEN"===e.project.access),t.xp6(1),t.Q6J("ngIf","INVITE"===e.project.access),t.xp6(1),t.Q6J("ngIf","CLOSED"===e.project.access)}}function Qi(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.edit())}),t._uU(1,"Edit Project "),t.qZA()}}function qi(i,r){if(1&i&&(t.TgZ(0,"app-tag",40),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Fi(i,r){if(1&i&&(t.TgZ(0,"div",7)(1,"div",25)(2,"h1",26),t._uU(3),t.qZA(),t.YNc(4,Ui,5,2,"div",27),t.YNc(5,Ei,3,3,"ng-template",28),t.YNc(6,Qi,2,0,"button",29),t.qZA(),t.TgZ(7,"app-tag-container",11)(8,"app-tag",30),t._uU(9),t.qZA(),t.YNc(10,qi,2,1,"app-tag",31),t.qZA(),t.TgZ(11,"p",32),t._uU(12),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(e.project.name),t.xp6(1),t.Q6J("ngIf",void 0!==e.accessOptions[e.project.access]),t.xp6(1),t.Q6J("ngIf",e.projectOptions.canJoinProject&&!e.projectOptions.isMember&&e.projectOptions.isAuthenticated),t.xp6(1),t.Q6J("ngIf",e.projectOptions.canUpdateProject),t.xp6(3),t.Oqu(e.getProjectYear()),t.xp6(1),t.Q6J("ngForOf",e.project.tags),t.xp6(2),t.hij(" ",e.project.pitch," ")}}function Bi(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(3);return t.KtG(a.onDownloadLinkClick(n))}),t.TgZ(1,"div",51),t._UZ(2,"ic-icon",52),t._uU(3),t.qZA()()}if(2&i){const e=r.ngIf;t.xp6(2),t.Q6J("icon",e.icon),t.xp6(1),t.hij(" Play ",e.text," ")}}function Ri(i,r){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Bi,4,2,"button",49),t.qZA()),2&i){const e=r.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",o.getDownloadLinkStaticData(e))}}function Hi(i,r){if(1&i&&t._UZ(0,"img",60),2&i){const e=t.oxw().$implicit,o=t.oxw(5);t.Q6J("src",o.cdn.getFileLink(e),t.LSH)}}function $i(i,r){1&i&&(t.ynx(0),t.YNc(1,Hi,1,1,"img",59),t.BQk())}function Li(i,r){if(1&i&&(t.TgZ(0,"div",56)(1,"div",57)(2,"app-carousel",58),t.YNc(3,$i,2,0,"ng-container",44),t.qZA()()()),2&i){const e=t.oxw(4);t.xp6(2),t.Q6J("visibleSlides",1)("autoplay",!0)("autoplayDurationMS",6e3),t.xp6(1),t.Q6J("ngForOf",e.project.galleryImageLinks)}}function zi(i,r){if(1&i&&t._UZ(0,"img",60),2&i){const e=t.oxw().$implicit,o=t.oxw(4);t.Q6J("src",o.cdn.getFileLink(e),t.LSH)}}function Gi(i,r){1&i&&(t.ynx(0),t.YNc(1,zi,1,1,"img",59),t.BQk())}function Vi(i,r){if(1&i&&(t.TgZ(0,"div",53),t.YNc(1,Li,4,4,"div",54),t.TgZ(2,"app-carousel",55),t.YNc(3,Gi,2,0,"ng-container",44),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!e.breakpointManager.matchedBreakpointOrBelow("MEDIUM_MOBILE")),t.xp6(1),t.Q6J("visibleSlides",e.getVisibleSlides())("autoplay",!0)("autoplayDurationMS",2e3),t.xp6(1),t.Q6J("ngForOf",e.project.galleryImageLinks)}}function Ki(i,r){if(1&i&&(t._UZ(0,"iframe",61),t.ALo(1,"safe")),2&i){const e=t.oxw(3);t.Q6J("src",t.xi3(1,1,"https://w.soundcloud.com/player/?url="+e.project.soundcloudEmbedSrc+"&color=%23"+e.soundCloudColor+"&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true","resourceUrl"),t.uOi)}}function Xi(i,r){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij("Completed at ",e.getDateString(e.project.completedAt),"")}}function Wi(i,r){if(1&i&&(t.TgZ(0,"div",14)(1,"div",41),t._UZ(2,"markdown",42),t.qZA(),t.TgZ(3,"div",43),t.YNc(4,Ri,2,1,"div",44),t.qZA(),t.YNc(5,Vi,4,5,"div",45),t.YNc(6,Ki,2,4,"iframe",46),t.TgZ(7,"div",47)(8,"div"),t._uU(9),t.qZA(),t.TgZ(10,"div"),t._uU(11),t.qZA(),t.YNc(12,Xi,2,1,"div",0),t.qZA(),t._UZ(13,"mat-divider"),t.TgZ(14,"h2"),t._uU(15,"Members"),t.qZA(),t._UZ(16,"app-project-members-display",48),t.qZA()),2&i){const e=t.oxw(2);let o;t.xp6(2),t.Q6J("data",null!==(o=e.project.description)&&void 0!==o?o:""),t.xp6(2),t.Q6J("ngForOf",e.project.downloadLinks),t.xp6(1),t.Q6J("ngIf",e.project.galleryImageLinks&&e.project.galleryImageLinks.length>0),t.xp6(1),t.Q6J("ngIf",e.project.soundcloudEmbedSrc),t.xp6(3),t.hij("Created at ",e.getDateString(e.project.createdAt),""),t.xp6(2),t.hij("Updated at ",e.getDateString(e.project.updatedAt),""),t.xp6(1),t.Q6J("ngIf",e.project.completedAt),t.xp6(4),t.Q6J("projectMembers",e.getProjectMembers())}}function to(i,r){1&i&&(t.TgZ(0,"div",62)(1,"h1"),t._uU(2,"This project doesn't exist"),t.qZA(),t.TgZ(3,"p",63),t._uU(4,"Try searching for another"),t.qZA()())}function eo(i,r){if(1&i&&(t.TgZ(0,"div")(1,"div",17),t.YNc(2,ki,1,1,"img",18),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",19),t._UZ(8,"img",20),t.qZA()(),t.YNc(9,Fi,13,7,"div",21),t.qZA(),t.YNc(10,Wi,17,8,"div",22),t.YNc(11,to,5,0,"div",23),t.qZA()()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",e.getBannerContainerStyle()),t.xp6(1),t.Q6J("ngIf",e.bannerSrc),t.xp6(6),t.Q6J("src",e.cardImageSrc,t.LSH),t.xp6(1),t.Q6J("ngIf",!e.projectOptions.nonExistent),t.xp6(1),t.Q6J("ngIf",!e.projectOptions.nonExistent),t.xp6(1),t.Q6J("ngIf",e.projectOptions.nonExistent)}}let io=(()=>{class i{constructor(e,o,n,a,l,m,h){this.cdn=e,this.settings=o,this.dialog=n,this.backend=a,this.security=l,this.uiMessageService=m,this.breakpointManager=h,this.edited=new t.vpe,this.project={},this.projectOptions={isMember:!1,manageSomeMembers:!1,nonExistent:!1,canUpdateProject:!1,inviteSent:!1,isAuthenticated:!1,loaded:!1,canDeleteProject:!1,canManageMetadata:!1,canCreateProjectMember:!1,canJoinProject:!1},this.cardImageSrc="https://c.tenor.com/Tu0MCmJ4TJUAAAAC/load-loading.gif",this.bannerSrc="https://c.tenor.com/Tu0MCmJ4TJUAAAAC/load-loading.gif",this.accessOptions=wt.tT,this.soundCloudColor="b3002d",this.monitor=new at.yv,this.setupBannerColorListener=!1,this.downloadLinkStaticData=[{domains:["store.steampowered.com"],text:"on Steam",icon:"steam"},{domains:["itch.io"],text:"on Itch",icon:"itchdotio"}],this.defaultDownloadLinkStaticData={text:"here",icon:"play"}}ngAfterViewChecked(){this.trySetupBannerColorListeners()}ngOnChanges(e){e.project&&(this.bannerSrc=this.project.bannerLink?this.cdn.getFileLink(this.project.bannerLink):"",this.cardImageSrc=this.project.cardImageLink?this.cdn.getFileLink(this.project.cardImageLink):this.settings.General.defaultCardImageSrc,this.monitor.clearProcesses())}getProjectMembers(){return this.project.members}trySetupBannerColorListeners(){if(this.setupBannerColorListener)return;const e=document.querySelector("img.project-page.overview-tab.card-image");if(e){e.setAttribute("crossOrigin","Anonymous");const o=new He.Z;e.addEventListener("load",()=>{const[n,a,l]=o.getColor(e);this.bannerColor=new at.Il(n,a,l)}),this.setupBannerColorListener=!0}}getBannerContainerStyle(){return{...this.bannerColor&&{"background-color":this.bannerColor.hexString()}}}join(){var e=this;return(0,u.Z)(function*(){e.monitor.isProcessing||(e.monitor.addProcess(),(yield(0,x.z)(e.backend.withAuth().mutate({mutation:b.Ps`
          mutation JoinOpenProject($projectId: ID!) {
            joinOpenProject(projectId: $projectId)
          }
        `,variables:{projectId:e.project.id}}))).errors?e.monitor.removeProcess():e.uiMessageService.notifyConfirmed("Joined project!"))})()}requestInvite(){var e=this;return(0,u.Z)(function*(){e.monitor.isProcessing||(e.monitor.addProcess(),(yield(0,x.z)(e.backend.withAuth().mutate({mutation:b.Ps`
          mutation NewProjectInvite($input: NewProjectInviteInput!) {
            newProjectInvite(input: $input)
          }
        `,variables:{input:{type:_.PA.Incoming,projectId:e.project.id,userId:e.security.securityContext?.userId}}}))).errors?e.monitor.removeProcess():e.uiMessageService.notifyConfirmed("Invite sent!"))})()}edit(){var e=this;return(0,u.Z)(function*(){(yield(0,x.z)(e.dialog.open(di,{data:{project:e.project,projectOptions:e.projectOptions},width:"37.5em",maxWidth:"90vw"}).afterClosed()))&&e.edited.emit()})()}getDownloadLinkStaticData(e){return e&&this.downloadLinkStaticData.find(n=>n.domains.some(a=>e.includes(a)))||this.defaultDownloadLinkStaticData}onDownloadLinkClick(e){e&&window.open(e,"_blank")}getDateString(e){return new Date(e).toLocaleString()}getProjectYear(){return new Date(this.project.createdAt).getFullYear()}getVisibleSlides(){return this.breakpointManager.matchedBreakpointOrAbove(It.U.Desktop)?3:this.breakpointManager.matchedBreakpointOrAbove(It.U.Mobile)?2:1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(I.Ub),t.Y36(pi.g),t.Y36(f.uw),t.Y36(I.v$),t.Y36(I.Il),t.Y36(S.S),t.Y36(I.IW))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-overview-tab"]],inputs:{project:"project",projectOptions:"projectOptions"},outputs:{edited:"edited"},features:[t.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"project-page","overview-tab","banner-container","loading"],[1,"project-page","overview-tab","content-width-padding"],[1,"project-page","overview-tab","content"],["breakable-styles","","prebreak-style","\n          flex-direction: row;\n        ","break-style","\n          flex-direction: column;\n        ","break-on","width < 840",2,"position","relative","display","flex","margin-top","2em","flex-wrap","wrap","width","100%","gap","2em"],[1,"project-page","overview-tab","card-offset"],[1,"project-page","overview-tab","card-image-container","loading"],[2,"flex","1 1 0","display","flex","flex-direction","column","max-width","100%"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","justify-content","left","align-items","flex-start","margin-bottom","16px","gap","0.5em"],[1,"project-page","overview-tab","name","loading",2,"margin-bottom","0px","flex","1"],["style","\n              width: 6em;\n              height: 2em;\n              border-radius: 3em;\n            ","class","loading",4,"ngFor","ngForOf"],[2,"margin-bottom","1em"],["style","\n              width: 5em;\n              height: 1.5em;\n              border-radius: 3em;\n            ","class","loading",4,"ngFor","ngForOf"],[1,"loading",2,"display","inline"],[2,"display","flex","flex-direction","column","gap","2em","margin-top","2em"],[1,"loading",2,"width","6em","height","2em","border-radius","3em"],[1,"loading",2,"width","5em","height","1.5em","border-radius","3em"],[1,"project-page","overview-tab","banner-container",3,"ngStyle"],["class","project-page overview-tab banner",3,"src",4,"ngIf"],[1,"project-page","overview-tab","card-image-container"],[1,"project-page","overview-tab","card-image",3,"src"],["style","\n          flex: 1 1 0;\n          display: flex;\n          flex-direction: column;\n          max-width: 100%;\n        ",4,"ngIf"],["style","\n        display: flex;\n        flex-direction: column;\n        gap: 2em;\n        margin-top: 2em;\n      ",4,"ngIf"],["style","\n        margin-top: 3em;\n      ","class","text-disabled",4,"ngIf"],[1,"project-page","overview-tab","banner",3,"src"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","justify-content","left","align-items","flex-start","margin-bottom","16px","gap","8px"],[1,"project-page","overview-tab","name",2,"margin-bottom","0px","flex","1","min-width","5em","word-break","break-word"],["style","padding: 0.4em 0.5em 0 0.5em;",4,"ngIf"],[3,"ngIf"],["class","project-page overview-tab edit-button","mat-stroked-button","","color","basic","pill","",3,"click",4,"ngIf"],["color","primary"],["color","blank",4,"ngFor","ngForOf"],[1,"project-page","overview-tab","pitch"],[2,"padding","0.4em 0.5em 0 0.5em"],[1,"mat-caption",2,"display","flex","flex-direction","row","gap","1em","margin-bottom","0px","align-items","center"],["class","project-page overview-tab edit-button","mat-stroked-button","","color","basic","pill","",3,"disabled","click",4,"ngIf"],["class","project-page overview-tab edit-button","mat-stroked-button","","color","basic","pill","","disabled","",4,"ngIf"],["mat-stroked-button","","color","basic","pill","",1,"project-page","overview-tab","edit-button",3,"disabled","click"],["mat-stroked-button","","color","basic","pill","","disabled","",1,"project-page","overview-tab","edit-button"],["mat-stroked-button","","color","basic","pill","",1,"project-page","overview-tab","edit-button",3,"click"],["color","blank"],[1,"margin-top:","16px"],["lineNumbers","",3,"data"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","gap","0.5em"],[4,"ngFor","ngForOf"],["style","\n          display: flex;\n          flex-direction: column;\n          gap: 0.5em;\n        ",4,"ngIf"],["width","100%","height","450","scrolling","no","frameborder","no","allow","autoplay",3,"src",4,"ngIf"],[1,"text-disabled",2,"display","flex","flex-direction","row","gap","2em"],[3,"projectMembers"],["mat-flat-button","","pill","","tall-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","pill","","tall-button","","color","primary",3,"click"],[2,"display","flex","align-items","center","justify-content","center","flex-direction","row","gap","0.5em"],["size","1.5em",3,"icon"],[2,"display","flex","flex-direction","column","gap","0.5em"],["style","\n            position: relative;\n            width: 100%;\n            padding-top: 56.25%;\n          ",4,"ngIf"],[2,"width","100%","height","20em",3,"visibleSlides","autoplay","autoplayDurationMS"],[2,"position","relative","width","100%","padding-top","56.25%"],[2,"position","absolute","top","0","left","0","bottom","0","right","0"],[2,"position","relative","width","100%","height","100%",3,"visibleSlides","autoplay","autoplayDurationMS"],["style","position: relative; width: 100%; height: 100%; object-fit: cover;",3,"src",4,"appCarouselItem"],[2,"position","relative","width","100%","height","100%","object-fit","cover",3,"src"],["width","100%","height","450","scrolling","no","frameborder","no","allow","autoplay",3,"src"],[1,"text-disabled",2,"margin-top","3em"],[1,"project-page","overview-tab","no-results-text"]],template:function(e,o){1&e&&(t.YNc(0,Di,21,4,"div",0),t.YNc(1,eo,12,6,"div",0)),2&e&&(t.Q6J("ngIf",!o.projectOptions.loaded),t.xp6(1),t.Q6J("ngIf",o.projectOptions.loaded))},dependencies:[p.sg,p.O5,p.PC,_i,gt.d,C.lW,A.v,fi.l,Ai,At,ht.ar,vt.lF,Zi.m,Si.Z,j.Hw,Mi.l],styles:["[_nghost-%COMP%]{--card-image-size: 18.75em;--card-offset: 6.25em}.banner-container[_ngcontent-%COMP%]{display:block;box-sizing:content-box;height:50vh;width:100%;display:flex;justify-content:center;align-items:center;position:relative}.banner[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover}.card-offset[_ngcontent-%COMP%]{height:calc(var(--card-image-size) - var(--card-offset))}.card-image-container[_ngcontent-%COMP%]{outline-style:solid;outline-width:.5em;display:block;position:relative;bottom:var(--card-offset);height:var(--card-image-size);width:var(--card-image-size);border-radius:1em}.card-image[_ngcontent-%COMP%]{width:inherit;height:100%;object-fit:cover;border-radius:16px}.pitch[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;overflow:hidden;word-wrap:break-word}.edit-banner-tint[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background-color:#000;opacity:.5}.edit-profile-picture-tint[_ngcontent-%COMP%]{position:absolute;width:calc(100% - 2 * var(--border-width));height:calc(100% - 2 * var(--border-width));border-radius:50%;background-color:#000;opacity:.5}.main-bg[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.content-width-padding[_ngcontent-%COMP%]{padding:var(--content-padding);padding-top:0}.socials-button-container[_ngcontent-%COMP%]{box-sizing:border-box;display:grid;align-items:stretch;margin-left:auto;margin-right:auto;gap:8px;grid-template-columns:repeat(auto-fit,minmax(256px,1fr))}.content[_ngcontent-%COMP%]{display:block;margin:auto;padding-top:0;max-width:var(--content-width)}"]}),i})();function oo(i,r){if(1&i&&(t.TgZ(0,"div",5)(1,"h2"),t._uU(2,"Discord"),t.qZA(),t.TgZ(3,"h4",6),t._uU(4,"Category ID"),t.qZA(),t.TgZ(5,"div"),t._uU(6),t.qZA(),t.TgZ(7,"div",7)(8,"div"),t._uU(9),t.qZA(),t.TgZ(10,"div"),t._uU(11),t.qZA()()()),2&i){const e=t.oxw();t.xp6(6),t.Oqu(e.project.discordConfig.categoryId),t.xp6(3),t.hij("Created at ",e.getDateString(e.project.discordConfig.createdAt),""),t.xp6(2),t.hij("Updated at ",e.getDateString(e.project.discordConfig.updatedAt),"")}}let no=(()=>{class i{constructor(e,o,n){this.uiMessageService=e,this.backend=o,this.router=n,this.edited=new t.vpe,this.project={},this.projectOptions={isMember:!1,manageSomeMembers:!1,nonExistent:!1,canUpdateProject:!1,inviteSent:!1,isAuthenticated:!1,loaded:!1,canDeleteProject:!1,canManageMetadata:!1,canCreateProjectMember:!1,canJoinProject:!1},this.monitor=new Y.y}ngOnInit(){}deleteProject(){var e=this;return(0,u.Z)(function*(){if(!(yield(0,x.z)(e.uiMessageService.confirmDialog(`Are you sure you want to delete the project "${e.project.name}"? There's no going back!`))))return;e.monitor.addProcess();const n=yield(0,x.z)(e.backend.withAuth().mutate({mutation:b.Ps`
          mutation DeleteProject($id: ID!) {
            deleteProject(id: $id)
          }
        `,variables:{id:e.project.id}}));e.monitor.removeProcess(),!n.errors&&e.router.navigateByUrl("/projects")})()}getDeleteProjectTooltip(){return this.projectOptions.canDeleteProject?this.project.discordConfig?"Cannot delete project with discord presence! Please archive the project's discord category first.":"":"Please ask an e-board officer if you'd like to delete a project."}getDateString(e){return new Date(e).toLocaleString()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(S.S),t.Y36(J.v),t.Y36(N.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-settings-tab"]],inputs:{project:"project",projectOptions:"projectOptions"},outputs:{edited:"edited"},decls:11,vars:3,consts:[["full-page",""],[2,"display","flex","flex-direction","column","gap","2em"],["style","margin-bottom: 2em;",4,"ngIf"],[2,"width","min-content",3,"matTooltip"],["mat-flat-button","","pill","","tall-button","","color","primary",2,"max-width","20em",3,"disabled","click"],[2,"margin-bottom","2em"],[2,"margin-bottom","0.1em"],[1,"text-disabled",2,"display","flex","flex-direction","row","gap","2em","margin-top","1em"]],template:function(e,o){1&e&&(t.TgZ(0,"app-bg-container",0)(1,"div",1)(2,"div"),t.YNc(3,oo,12,3,"div",2),t.TgZ(4,"h2"),t._uU(5,"Danger Zone"),t.qZA(),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){return o.deleteProject()}),t.TgZ(8,"mat-icon"),t._uU(9,"delete"),t.qZA(),t._uU(10," Delete Project "),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("ngIf",o.project.discordConfig),t.xp6(3),t.Q6J("matTooltip",o.getDeleteProjectTooltip()),t.xp6(1),t.Q6J("disabled",!o.projectOptions.canDeleteProject||o.monitor.isProcessing||o.project.discordConfig))},dependencies:[p.O5,j.Hw,C.lW,L.gM,A.v,Tt.h]}),i})();function ro(i,r){1&i&&(t.TgZ(0,"div",6),t._uU(1,"Overview"),t.qZA())}function ao(i,r){if(1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"remove_red_eye"),t.qZA(),t.YNc(2,ro,2,0,"div",5)),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.breakpointManager.matchedBreakpointOrAbove("MOBILE","key"))}}function so(i,r){1&i&&(t.TgZ(0,"div",6),t._uU(1,"Members"),t.qZA())}function co(i,r){if(1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"person"),t.qZA(),t.YNc(2,so,2,0,"div",5)),2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.breakpointManager.matchedBreakpointOrAbove("MOBILE"))}}function lo(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-tab"),t.YNc(1,co,3,1,"ng-template",2),t.TgZ(2,"app-members-tab",3),t.NdJ("edited",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.fetchData(!0,!0))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("project",e.project)("projectOptions",e.projectOptions)}}function po(i,r){1&i&&(t.TgZ(0,"div",6),t._uU(1,"Settings"),t.qZA())}function mo(i,r){if(1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"settings"),t.qZA(),t.YNc(2,po,2,0,"div",5)),2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.breakpointManager.matchedBreakpointOrAbove("MOBILE"))}}function uo(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-tab"),t.YNc(1,mo,3,1,"ng-template",2),t.TgZ(2,"app-settings-tab",3),t.NdJ("edited",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.fetchData(!0))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("project",e.project)("projectOptions",e.projectOptions)}}const _o=[{path:"",component:(()=>{class i{constructor(e,o,n,a,l,m,h,y){this.breakpointManager=e,this.activatedRoute=o,this.backend=n,this.security=a,this.authService=l,this.uiMessageService=m,this.seoService=h,this.router=y,this.project={},this.projectOptions={isMember:!1,manageSomeMembers:!1,nonExistent:!1,canUpdateProject:!1,inviteSent:!1,isAuthenticated:!1,loaded:!1,canDeleteProject:!1,canManageMetadata:!1,canCreateProjectMember:!1,canJoinProject:!1},this.projectId="",this.onDestroy$=new Q.x}ngOnInit(){var e=this;this.activatedRoute.paramMap.pipe((0,D.R)(this.onDestroy$)).subscribe(function(){var o=(0,u.Z)(function*(n){e.projectId=n.get("projectId"),yield e.security.waitUntilReady(),yield e.fetchData(),e.setupSubscribers(),e.seoService.update({titleAll:e.project.name,descriptionAll:e.project.description,ogImage:e.project.cardImageLink,twitterCard:"summary_large_image"})});return function(n){return o.apply(this,arguments)}}())}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}fetchData(e=!1,o=!1){var n=this;return(0,u.Z)(function*(){o&&(yield n.security.fetchData(),yield n.backend.cacheEvict({id:`Project:${n.projectId}`})),n.projectOptions.isAuthenticated=null!=n.security.securityContext?.userId;const a={projectId:n.projectId},l=n.security.makePermCalc().withDomain(a);let m,h,y;try{let w,k;if(n.security.securityContext?.userId){let go=n.security.getOpDomainsFromPermission(_.y3.ManageProjectInvites);w=(0,x.z)(n.backend.withAuth().withOpDomains(go).query({query:b.Ps`
                query FetchProjectPageInvites($filter: ProjectInviteFilterInput) {
                  projectInvites(filter: $filter) {
                    id
                    type
                    user {
                      id
                      displayName
                      username
                      avatarLink
                    }
                  }
                }
              `,variables:{filter:{projectId:{eq:n.projectId}}},...e&&{fetchPolicy:"network-only"}}))}l.hasPermission(_.y3.ManageProjectDiscord)&&(k=(0,x.z)(n.backend.withAuth().withOpDomain({projectId:n.projectId}).query({query:b.Ps`
                query FetchProjectPageDiscord {
                  projectDiscordConfigs {
                    id
                    createdAt
                    updatedAt
                    categoryId
                  }
                }
              `})));const R=(0,x.z)(n.backend.withAuth().query({query:b.Ps`
            query FetchProjectPageProject($filter: ProjectFilterInput) {
              projects(filter: $filter) {
                id
                cardImageLink
                bannerLink
                completedAt
                createdAt
                updatedAt
                name
                access
                pitch
                description
                tags
                galleryImageLinks
                soundcloudEmbedSrc
                downloadLinks
                members {
                  id
                  user {
                    id
                    avatarLink
                    bannerLink
                    bio
                    classYear
                    netId
                    username
                    displayName
                  }
                  contributions
                  roles {
                    roleCode
                  }
                }
              }
            }
          `,variables:{filter:{id:{eq:n.projectId}}},...e&&{fetchPolicy:"network-only"}}));[m,h,y]=yield Promise.all([k,w,R])}catch{return n.projectOptions.nonExistent=!0,void(n.projectOptions.loaded=!0)}if(0==y.data.projects.length)return n.projectOptions.nonExistent=!0,void(n.projectOptions.loaded=!0);n.projectOptions.canUpdateProject=l.hasPermission(_.y3.UpdateProject),n.projectOptions.canDeleteProject=l.hasPermission(_.y3.DeleteProject),n.projectOptions.canManageMetadata=l.hasPermission(_.y3.ManageMetadata),n.projectOptions.canCreateProjectMember=l.hasPermission(_.y3.CreateProjectMember),n.projectOptions.canJoinProject=l.hasPermission(_.y3.JoinProject),n.project=(0,T.I8)(y.data.projects[0]),h&&!h.error&&(n.project.invites=h.data.projectInvites),m&&!m.error&&(n.project.discordConfig=m.data.projectDiscordConfigs[0]),n.projectOptions.manageSomeMembers=l.withDomains(n.project.members?.map(w=>({projectMemberId:w?.id??""}))??[]).hasPermission(_.y3.ManageProjectMember),n.projectOptions.inviteSent=n.project.invites?.some(w=>w?.type===_.PA.Incoming&&w?.user?.id===n.security.securityContext?.userId)??!1,n.projectOptions.canUpdateProject=l.hasPermission(_.y3.UpdateProject),n.authService.authenticated&&(n.projectOptions.isMember=n.project.members?.some(w=>w?.user?.id===n.authService.getPayload()?.user.id)??!1),n.projectOptions.loaded=!0})()}setupSubscribers(){var e=this;if(!this.security.securityContext?.userId)return;let o={userId:this.security.securityContext.userId,projectId:this.projectId};var n;this.projectOptions.canUpdateProject&&(o={projectId:this.projectId}),this.backend.subscribe({query:b.Ps`
          subscription OnProjectInviteCreated($filter: ProjectInviteSubscriptionFilter) {
            projectInviteCreated(filter: $filter) {
              id
            }
          }
        `,variables:{filter:o}}).pipe((0,D.R)(this.onDestroy$)).subscribe({next:n=>{this.projectOptions.canUpdateProject&&this.uiMessageService.notifyInfo("New invite!"),this.fetchData(!0,!0)}}),this.backend.subscribe({query:b.Ps`
          subscription OnProjectInviteDeleted($filter: ProjectInviteSubscriptionFilter) {
            projectInviteDeleted(filter: $filter) {
              userId
            }
          }
        `,variables:{filter:o}}).pipe((0,D.R)(this.onDestroy$)).subscribe({next:(n=(0,u.Z)(function*(a){const l=a.data?.projectInviteDeleted;yield e.fetchData(!0,!0),e.project.members?.some(m=>m?.user?.id===l?.userId)?e.uiMessageService.notifyInfo("Invite accepted!"):e.uiMessageService.notifyInfo("Invite rejected!")}),function(l){return n.apply(this,arguments)})}),this.backend.subscribe({query:b.Ps`
          subscription OnProjectMemberDeleted($filter: ProjectMemberSubscriptionFilter) {
            projectMemberDeleted(filter: $filter) {
              userId
            }
          }
        `,variables:{filter:{projectId:this.projectId}}}).pipe((0,D.R)(this.onDestroy$)).subscribe({next:function(){var n=(0,u.Z)(function*(a){e.uiMessageService.notifyInfo(a.data?.projectMemberDeleted?.userId===e.security.securityContext?.userId?"You were kicked!":"Member kicked!"),yield e.fetchData(!0,!0),console.log("result after fetch data: ",e.projectOptions),e.projectOptions.nonExistent&&(console.log("Project doesn't exist, navigating out"),e.router.navigateByUrl("/projects"))});return function(l){return n.apply(this,arguments)}}()}),this.backend.subscribe({query:b.Ps`
          subscription OnProjectMemberCreated($filter: ProjectMemberSubscriptionFilter) {
            projectMemberCreated(filter: $filter) {
              id
            }
          }
        `,variables:{filter:{projectId:this.projectId}}}).pipe((0,D.R)(this.onDestroy$)).subscribe({next:function(){var n=(0,u.Z)(function*(a){e.projectOptions.canUpdateProject&&e.uiMessageService.notifyInfo("Member added!"),yield e.fetchData(!0,!0)});return function(l){return n.apply(this,arguments)}}()})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(bt.I),t.Y36(N.gz),t.Y36(J.v),t.Y36(Gt.I),t.Y36(Vt.e),t.Y36(S.S),t.Y36(Kt.L),t.Y36(N.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-project-page"]],decls:7,vars:5,consts:[[1,"app-project-page","main-bg"],["mat-align-tabs","center","backgroundColor","primary",3,"selectedIndex"],["mat-tab-label",""],[3,"project","projectOptions","edited"],[4,"ngIf"],["style","margin-left: 0.5em;",4,"ngIf"],[2,"margin-left","0.5em"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"mat-tab-group",1)(2,"mat-tab"),t.YNc(3,ao,3,1,"ng-template",2),t.TgZ(4,"app-overview-tab",3),t.NdJ("edited",function(){return o.fetchData(!0)}),t.qZA()(),t.YNc(5,lo,3,2,"mat-tab",4),t.YNc(6,uo,3,2,"mat-tab",4),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("selectedIndex",0),t.xp6(3),t.Q6J("project",o.project)("projectOptions",o.projectOptions),t.xp6(1),t.Q6J("ngIf",o.projectOptions.manageSomeMembers),t.xp6(1),t.Q6J("ngIf",o.projectOptions.canUpdateProject))},dependencies:[p.O5,Re,io,no,j.Hw,M.SP,M.uD,M.uX]}),i})(),data:{titleAll:"Project"}}];let fo=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[N.Bz.forChild(_o),p.ez,Ft,Lt,zt,j.Ps,M.Nh]}),i})()}}]);