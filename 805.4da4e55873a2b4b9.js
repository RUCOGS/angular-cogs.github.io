"use strict";(self.webpackChunkrucogs_website=self.webpackChunkrucogs_website||[]).push([[805],{1805:(ge,U,o)=>{o.r(U),o.d(U,{UsersPageComponent:()=>B,UsersPageModule:()=>fe});var u=o(8692),l=o(92),d=o(4536),b=o(6438),c=o(8659),h=o(3331),C=o(7406),y=o(2516),p=o(3178),F=o(5491),O=o(7950),e=o(4537);let E=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez]}),r})();var J=o(6883),Q=o(335),D=o(7763),f=o(8239),Z=o(3037),x=o(3556),T=o(274),v=o(7445),A=o(8340),L=o(3223),S=o(398);function $(r,a){if(1&r&&(e.TgZ(0,"div",6)(1,"a",7)(2,"div",8),e._UZ(3,"app-avatar",9)(4,"app-avatar",10),e.qZA(),e.TgZ(5,"h2",11),e._uU(6),e.qZA(),e.TgZ(7,"p",12),e._uU(8),e.qZA(),e._UZ(9,"app-roles-display",13),e.qZA()()),2&r){const t=a.$implicit,n=e.oxw(2);e.xp6(1),e.MGl("routerLink","/members/",null==t||null==t.eBoard||null==t.eBoard.user?null:t.eBoard.user.username,""),e.xp6(2),e.Q6J("avatarSrc",n.cdn.getFileLink(null==t||null==t.eBoard?null:t.eBoard.avatarLink)),e.xp6(1),e.Q6J("avatarSrc",n.cdn.getFileLink(null==t||null==t.eBoard||null==t.eBoard.user?null:t.eBoard.user.avatarLink)),e.xp6(2),e.Oqu(null==t||null==t.eBoard||null==t.eBoard.user?null:t.eBoard.user.displayName),e.xp6(2),e.hij("@",null==t||null==t.eBoard||null==t.eBoard.user?null:t.eBoard.user.username,""),e.xp6(1),e.Q6J("roles",n.getEBoardTermRoles(t))("center",!0)}}function k(r,a){if(1&r&&(e.TgZ(0,"div",2)(1,"h1"),e._uU(2),e.qZA(),e._UZ(3,"mat-divider",3),e.TgZ(4,"div",4),e.YNc(5,$,10,7,"div",5),e.qZA()()),2&r){const t=a.$implicit;e.xp6(2),e.AsE("",t.year," - ",t.year+1,""),e.xp6(3),e.Q6J("ngForOf",t.terms)}}let Y=(()=>{class r extends Z.Gh{constructor(){var t;super(...arguments),t=this,this.eBoardTermGroups=[],this.valuesPerPage=24,this._valuesQuery=function(){var n=(0,f.Z)(function*(s,i){const m=yield(0,v.z)(t.backend.withAuth().query({query:T.Ps`
          query DisplayEBoardTerms($limit: Int, $skip: Int, $sorts: [EBoardTermSortInput!]) {
            eBoardTerms(limit: $limit, skip: $skip, sorts: $sorts) {
              eBoard {
                id
                avatarLink
                bio
                user {
                  id
                  avatarLink
                  bannerLink
                  displayName
                  username
                }
              }
              id
              year
              roles {
                roleCode
              }
            }
          }
        `,variables:{skip:s,limit:i,sorts:[{year:"desc"}]}}));return m.error?[]:m.data.eBoardTerms});return function(s,i){return n.apply(this,arguments)}}()}get eBoardTerms(){return this.values}set eBoardTerms(t){this.values=t}get values(){return super.values}set values(t){super.values=t,this.updateEBoardTermGroups()}updateEBoardTermGroups(){this.eBoardTermGroups=[];let t={year:0,terms:[]};for(const n of this.eBoardTerms){if(n.year!==t.year){const s={year:n.year,terms:[]};this.eBoardTermGroups.push(s),t=s}t.terms.push(n)}}getEBoardTermRoles(t){if(!t)return[];const n=t.roles?.map(s=>s?.roleCode);return n?1==n.length?n:n.filter(s=>s!==x.LO.Eboard):[]}}return r.\u0275fac=function(){let a;return function(n){return(a||(a=e.n5z(r)))(n||r)}}(),r.\u0275cmp=e.Xpm({type:r,selectors:[["app-eboard-tab"]],inputs:{eBoardTerms:"eBoardTerms"},features:[e.qOj],decls:2,vars:1,consts:[["full-width",""],["style","margin-bottom: 5em;",4,"ngFor","ngForOf"],[2,"margin-bottom","5em"],[2,"margin-bottom","1em"],[2,"width","100%","display","grid","grid-template-columns","repeat(auto-fit, minmax(16em, 1fr))","align-items","stretch","gap","1em","justify-content","center","width","100%"],["style","\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      ",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","column","align-items","center"],[1,"eboard-tab","eboard-profile",2,"display","flex","flex-direction","column","align-items","center","width","min-content",3,"routerLink"],[2,"position","relative","width","min-content","margin-bottom","0.5em"],["size","huge",3,"avatarSrc"],["size","small",2,"position","absolute","bottom","0em","right","0em",3,"avatarSrc"],[2,"margin-bottom","0"],[1,"text-disabled",2,"text-overflow","ellipsis","overflow","hidden","margin-bottom","0.5em"],[3,"roles","center"]],template:function(t,n){1&t&&(e.TgZ(0,"app-section",0),e.YNc(1,k,6,3,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",n.eBoardTermGroups))},dependencies:[p.yS,u.sg,A.e,L.A,S.l,b.d],styles:[".eboard-profile[_ngcontent-%COMP%]{transition:transform .1s ease-out;transform:none;color:inherit;text-decoration:inherit}.eboard-profile[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.eboard-profile[_ngcontent-%COMP%]:active{transform:scale(1.025)}"]}),r})();var q=o(6527),G=o(9424);let z=(()=>{class r{constructor(t,n){this.elementRef=t,this.contentWidth=null!=n,this.contentWidth&&(this.elementRef.nativeElement.style.width="min(100%, var(--content-width))")}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.SBq),e.$8M("mat-tab-content-width"))},r.\u0275dir=e.lG2({type:r,selectors:[["","mat-tab-content-width",""]]}),r})();const j=function(){return{exact:!0}};function w(r,a){if(1&r&&(e.TgZ(0,"a",4,5)(2,"mat-icon"),e._uU(3),e.qZA(),e.TgZ(4,"div",6),e._uU(5),e.qZA()()),2&r){const t=a.$implicit,n=e.MAs(1);e.Q6J("routerLink",t.path)("routerLinkActiveOptions",e.DdM(5,j))("active",n.isActive),e.xp6(3),e.Oqu(t.matIcon),e.xp6(2),e.Oqu(t.label)}}let B=(()=>{class r{constructor(t){this.breakpointManager=t,this.usersTabs=[{matIcon:"person",label:"Members",path:"./"},{matIcon:"assignment_ind",label:"E-Board",path:"./eboard"}]}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(q.I))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-users-page"]],decls:5,vars:1,consts:[["title","Members"],[1,"background-color-primary",2,"display","flex","flex-direction","row","justify-content","center"],["mat-tab-nav-bar","","color","primary","mat-align-tabs","center","backgroundColor","primary","mat-stretch-tabs","","mat-tab-content-width",""],["mat-tab-link","","routerLinkActive","",3,"routerLink","routerLinkActiveOptions","active",4,"ngFor","ngForOf"],["mat-tab-link","","routerLinkActive","",3,"routerLink","routerLinkActiveOptions","active"],["rla","routerLinkActive"],[2,"margin-left","0.5em"]],template:function(t,n){1&t&&(e._UZ(0,"app-page-header",0),e.TgZ(1,"div",1)(2,"nav",2),e.YNc(3,w,6,6,"a",3),e.qZA()(),e._UZ(4,"router-outlet")),2&t&&(e.xp6(3),e.Q6J("ngForOf",n.usersTabs))},dependencies:[p.lC,p.yS,p.Od,u.sg,G.q,h.Hw,y.BU,y.Nj,z],styles:[".users-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1em;margin-top:2em;margin-bottom:2em}.paginator[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.no-results-text[_ngcontent-%COMP%]{text-align:center;margin-bottom:0}"]}),r})();var H=o(4583),I=o(5208),R=o(7894),N=o(2709),_=o(9638);function V(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Display name is required "),e.qZA())}function X(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Username is required "),e.qZA())}function W(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Username must contain only 0-9, a-z, A-Z, and '_' "),e.qZA())}function K(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email must be formatted like: example@mail.com "),e.qZA())}let ee=(()=>{class r{constructor(t,n,s,i){this.uiMessage=n,this.backend=s,this.dialogRef=i,this.monitor=new H.y,this.form=t.group({username:[null,[l.kI.required,l.kI.pattern(/^[a-zA-Z0-9_]*$/)]],displayName:[null,l.kI.required],email:[null,[l.kI.email]]}),i.disableClose=!0}ngOnInit(){}exit(t=!1,n={}){this.monitor.isProcessing||this.dialogRef.close({success:t,user:n})}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing some info!");return!0}catch(t){return this.uiMessage.error(t),!1}}save(){var t=this;return(0,f.Z)(function*(){if(t.monitor.isProcessing||!t.validate())return;const n={username:t.form.get("username")?.value};if(t.form.get("displayName")?.value&&(n.displayName=t.form.get("displayName")?.value),t.form.get("email")?.value&&(n.email=t.form.get("email")?.value),Object.keys(n).length>1){t.monitor.addProcess();const s=yield(0,v.z)(t.backend.withAuth().mutate({mutation:T.Ps`
            mutation CreateUserDialog($input: NewUserInput!) {
              newUser(input: $input)
            }
          `,variables:{input:n}}));if(t.monitor.removeProcess(),s.errors)return void t.uiMessage.error("Error uploading data!");t.uiMessage.notifyConfirmed("User created!"),t.exit(!0,{id:s.data?.newUser,...n})}})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.qu),e.Y36(I.S),e.Y36(R.v),e.Y36(d.so))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create-user-dialog"]],decls:27,vars:11,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","displayName",3,"maxLength"],["align","end"],[4,"ngIf"],["matInput","","formControlName","username",3,"maxLength"],["matInput","","formControlName","email"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Display Name"),e.qZA(),e._UZ(5,"input",2),e.TgZ(6,"mat-hint",3),e._uU(7),e.qZA(),e.YNc(8,V,2,0,"mat-error",4),e.qZA(),e.TgZ(9,"mat-form-field",1)(10,"mat-label"),e._uU(11,"Username"),e.qZA(),e._UZ(12,"input",5),e.TgZ(13,"mat-hint",3),e._uU(14),e.qZA(),e.YNc(15,X,2,0,"mat-error",4),e.YNc(16,W,2,0,"mat-error",4),e.qZA(),e.TgZ(17,"mat-form-field",1)(18,"mat-label"),e._uU(19,"Email"),e.qZA(),e._UZ(20,"input",6),e.YNc(21,K,2,0,"mat-error",4),e.qZA()()(),e.TgZ(22,"mat-dialog-actions")(23,"button",7),e.NdJ("click",function(){return n.exit()}),e._uU(24,"Exit "),e.qZA(),e.TgZ(25,"button",7),e.NdJ("click",function(){return n.save()}),e._uU(26,"Save "),e.qZA()()),2&t){let s,i,m,g,P,M;e.xp6(1),e.Q6J("formGroup",n.form),e.xp6(4),e.Q6J("maxLength",50),e.xp6(2),e.hij("",(null==(s=n.form.get("displayName"))||null==s.value?null:s.value.length)||0,"/50"),e.xp6(1),e.Q6J("ngIf",null==(i=n.form.get("displayName"))?null:i.hasError("required")),e.xp6(4),e.Q6J("maxLength",20),e.xp6(2),e.hij("",(null==(m=n.form.get("username"))||null==m.value?null:m.value.length)||0,"/20"),e.xp6(1),e.Q6J("ngIf",null==(g=n.form.get("username"))?null:g.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(P=n.form.get("username"))?null:P.hasError("pattern")),e.xp6(5),e.Q6J("ngIf",null==(M=n.form.get("email"))?null:M.hasError("email")),e.xp6(2),e.Q6J("disabled",n.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",n.monitor.isProcessing)}},dependencies:[u.O5,N.v,_.lW,c.TO,c.KE,c.bx,c.hX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,C.Nt,d.xY,d.H8]}),r})();var te=o(1241),re=o(3535),ne=o(5705);function ae(r,a){1&r&&e._UZ(0,"app-basic-profile",2),2&r&&e.Q6J("user",a.$implicit)}const oe=["*"];let se=(()=>{class r{constructor(){this.users=[]}ngOnInit(){}getUserLink(t){return t.username?`/members/${t.username}`:""}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-profile-grid"]],inputs:{users:"users"},ngContentSelectors:oe,decls:3,vars:1,consts:[[1,"app-profile-grid","grid"],[3,"user",4,"ngFor","ngForOf"],[3,"user"]],template:function(t,n){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.YNc(1,ae,1,1,"app-basic-profile",1),e.Hsn(2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",n.users))},dependencies:[u.sg,ne.u],styles:[".grid[_ngcontent-%COMP%]{display:grid;align-items:stretch;gap:1em;justify-content:center;width:100%}"]}),r})();function ie(r,a){1&r&&(e.TgZ(0,"div")(1,"div",7),e._UZ(2,"div",8),e.TgZ(3,"div",9),e._uU(4,"_ _ _ "),e.qZA(),e.TgZ(5,"div",9),e._uU(6,"_ _ _ "),e.qZA()()())}const le=function(){return[]};function ue(r,a){1&r&&(e.TgZ(0,"app-profile-grid"),e.YNc(1,ie,7,0,"div",6),e.qZA()),2&r&&(e.xp6(1),e.Q6J("ngForOf",e.DdM(1,le).constructor(21)))}function me(r,a){1&r&&(e.TgZ(0,"div")(1,"h2",10),e._uU(2,"No results found..."),e.qZA()())}let pe=(()=>{class r extends Z.N3{constructor(){var t;super(...arguments),t=this,this.valuesPerPage=21,this._filteredValuesQuery=function(){var n=(0,f.Z)(function*(s,i,m){const g=yield(0,v.z)(t.backend.withAuth().query({query:T.Ps`
          query DisplayUsers($filter: UserFilterInput, $limit: Int, $skip: Int, $sorts: [UserSortInput!]) {
            users(filter: $filter, limit: $limit, skip: $skip, sorts: $sorts) {
              avatarLink
              displayName
              username
            }
          }
        `,variables:{skip:i,limit:m,filter:s,sorts:[{username:"asc"}]}}));return g.error?[]:g.data.users});return function(s,i,m){return n.apply(this,arguments)}}()}get users(){return this.values}set users(t){this.values=t}get usersQuery(){return this.filteredValuesQuery}set usersQuery(t){this.filteredValuesQuery=t}getFilter(){return this.filterHeader?{...this.filterHeader.searchText&&{or_:[{username:{startsWith:this.filterHeader.searchText,mode:"INSENSITIVE"}},{displayName:{startsWith:this.filterHeader.searchText,mode:"INSENSITIVE"}}]}}:{}}}return r.\u0275fac=function(){let a;return function(n){return(a||(a=e.n5z(r)))(n||r)}}(),r.\u0275cmp=e.Xpm({type:r,selectors:[["app-users-display"]],inputs:{users:"users",usersQuery:"usersQuery"},features:[e.qOj],decls:7,vars:3,consts:[["searchBar",""],[1,"app-users-display","users-container"],["usersContainer",""],[3,"users"],[4,"ngIf"],[2,"display","flex"],[4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","column","gap","0.5em"],[1,"loading",2,"height","8em","width","8em","border-radius","50%"],[1,"loading",2,"width","8em"],[1,"text-disabled"]],template:function(t,n){1&t&&(e._UZ(0,"app-filter-header",0),e.TgZ(1,"div",1,2),e._UZ(3,"app-profile-grid",3),e.YNc(4,ue,2,2,"app-profile-grid",4),e._UZ(5,"div",5),e.YNc(6,me,3,0,"div",4),e.qZA()),2&t&&(e.xp6(3),e.Q6J("users",n.users),e.xp6(1),e.Q6J("ngIf",!n.loaded),e.xp6(2),e.Q6J("ngIf",n.loaded&&0===n.users.length))},dependencies:[u.sg,u.O5,re.B,se]}),r})();function de(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",2)(1,"button",3),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onCreateUser())}),e.TgZ(2,"mat-icon"),e._uU(3,"add"),e.qZA(),e._uU(4," Create Member "),e.qZA()()}}const ce=[{path:"",component:B,children:[{path:"",component:(()=>{class r{constructor(t,n,s,i){this.security=t,this.uiMessage=n,this.router=s,this.dialog=i,this.canCreateUser=!1}ngOnInit(){var t=this;return(0,f.Z)(function*(){yield t.security.waitUntilReady(),t.canCreateUser=t.security.makePermCalc().hasPermission(x.y3.CreateUser)})()}onCreateUser(){var t=this;return(0,f.Z)(function*(){const n=yield(0,v.z)(t.dialog.open(ee,{width:"25em",maxWidth:"90vw"}).afterClosed());!n.success||t.router.navigateByUrl(`/members/${n.user.username}`)})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(te.I),e.Y36(I.S),e.Y36(p.F0),e.Y36(d.uw))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-users-tab"]],decls:3,vars:1,consts:[["full-width",""],["style","margin-bottom: 1em",4,"ngIf"],[2,"margin-bottom","1em"],["mat-stroked-button","","pill","",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"app-section",0),e.YNc(1,de,5,0,"div",1),e._UZ(2,"app-users-display"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.canCreateUser))},dependencies:[u.O5,N.v,_.lW,A.e,pe,h.Hw]}),r})()},{path:"eboard",component:Y}]}];let fe=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.Bz.forChild(ce),u.ez,D.I,Q.z,h.Ps,y.Nh,E,F.F,J.U,b.t,c.lN,l.UX,C.c,d.Is,O.c]}),r})()}}]);