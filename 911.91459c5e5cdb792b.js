"use strict";(self.webpackChunkrucogs_website=self.webpackChunkrucogs_website||[]).push([[911],{4614:(ce,q,l)=>{l.d(q,{A:()=>a});var u=l(4537),T=l(8692);const k=function(c){return{outlined:c}},O=["*"];let a=(()=>{class c{constructor(b){this.color="blank",this.hover="",this.outlined=null!=b}ngOnInit(){}}return c.\u0275fac=function(b){return new(b||c)(u.$8M("outlined"))},c.\u0275cmp=u.Xpm({type:c,selectors:[["app-card"]],inputs:{color:"color",hover:"hover"},ngContentSelectors:O,decls:2,vars:7,consts:[[3,"ngClass"]],template:function(b,Z){1&b&&(u.F$t(),u.TgZ(0,"div",0),u.Hsn(1),u.qZA()),2&b&&(u.MT6("app-card card ",Z.color," ",Z.hover,""),u.Q6J("ngClass",u.VKq(5,k,Z.outlined)))},dependencies:[T.mk],styles:["[_nghost-%COMP%]{display:flex}.card[_ngcontent-%COMP%]{display:block;position:relative;width:auto;height:100%;width:100%;border-style:solid;border-width:2px;border-radius:8px;padding:2.25em;box-sizing:border-box}.outlined[_ngcontent-%COMP%]{border-width:2px}"]}),c})()},8911:(ce,q,l)=>{l.r(q),l.d(q,{UserPageModule:()=>Ci});var u=l(8692),T=l(3331),k=l(2516),O=l(3178),a=l(92),c=l(4536),m=l(8659),b=l(7406),Z=l(8033),_=l(317),H=l(3756),V=l(4022),K=l(6883),Y=l(7763),e=l(4537);let ue=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,Y.I,a.UX,m.lN,_.p0,K.U,T.Ps,c.Is,Z.LD,V.l,b.c,H.v]}),i})();var X=l(4276),M=l(9910);let me=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,Y.I,X.J,M.Qd,T.Ps,X.J,_.p0]}),i})();var x=l(9638),P=l(1379),S=l(3704),W=l(6438),ee=l(7950),pe=l(9518),ge=l(335);let fe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,c.Is,m.lN,S.FA,P.XK,pe.I,ge.z,W.t,K.U,M.Qd,T.Ps,Z.LD,V.l,a.UX,x.ot,ee.c,b.c,H.v]}),i})();var te=l(2940),_e=l(6004),ve=l(1561);let he=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,Y.I,_e.m,te.AV,T.Ps,c.Is,m.lN,b.c,a.UX,Z.LD,ee.c,ve.p9]}),i})();var g=l(8239),Q=l(9860),h=l(3556),f=l(274),B=l(8023),p=l(7445),E=l(3528),D=l(7545),w=l(831),ie=l(1241),C=l(5208),I=l(4583),U=l(2709);function be(i,r){if(1&i&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ye(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Year is required "),e.qZA())}let Te=(()=>{class i{constructor(t,o,n,s,d){this.backend=o,this.uiMessageService=n,this.dialogRef=s,this.data=d,this.monitor=new I.y,this.form=t.group({year:[null,[a.kI.required]]}),s.disableClose=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");return!0}catch(t){return this.uiMessageService.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){!t.validate()||(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation NewEBoardTerm($input: NewEBoardTermInput!) {
            newEBoardTerm(input: $input)
          }
        `,variables:{input:{eBoardId:t.data.eBoardId,year:t.form.get("year")?.value}}}))).errors||(t.uiMessageService.notifyConfirmed("Term created!"),t.exit(!0))})()}getAvailableYears(){const o=[];for(let n=(new Date).getFullYear()+3;n>=2014;n--)this.data.takenYears.includes(n)||o.push(n);return o}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(w.v),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-create-eboard-term-dialog"]],decls:13,vars:5,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"flex","1"],["formControlName","year"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"],[3,"value"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Year"),e.qZA(),e.TgZ(5,"mat-select",2),e.YNc(6,be,2,2,"mat-option",3),e.qZA(),e.YNc(7,ye,2,0,"mat-error",4),e.qZA()()(),e.TgZ(8,"mat-dialog-actions")(9,"button",5),e.NdJ("click",function(){return o.exit()}),e._uU(10,"Exit "),e.qZA(),e.TgZ(11,"button",5),e.NdJ("click",function(){return o.save()}),e._uU(12,"Add "),e.qZA()()),2&t){let n;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngForOf",o.getAvailableYears()),e.xp6(1),e.Q6J("ngIf",null==(n=o.form.get("year"))?null:n.hasError("required")),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.sg,u.O5,U.v,x.lW,a._Y,a.JJ,a.JL,a.sg,a.u,m.TO,m.KE,m.hX,c.xY,c.H8,Z.gD,P.ey]}),i})();var j=l(6440),oe=l(2272),L=l(7025);const xe=["avatarUpload"];let Ze=(()=>{class i{constructor(t,o,n,s,d,v){this.cdn=o,this.backend=n,this.uiMessage=s,this.dialogRef=d,this.data=v,this.monitor=new I.y,this.form=t.group({bio:[v.eBoard.bio,[]]}),this.dialogRef.disableClose=!0}ngAfterViewInit(){setTimeout(()=>{!this.avatarUpload||this.avatarUpload.init(this.cdn.getFileLink(this.data.eBoard.avatarLink))},0)}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");return!0}catch(t){return t instanceof Error&&this.uiMessage.error(t.message),!1}}save(){var t=this;return(0,g.Z)(function*(){if(!t.validate()||!t.avatarUpload)return;t.monitor.addProcess();const o={id:t.data.eBoard.id};if(t.form.get("bio")!==t.data.eBoard.bio&&(o.bio=t.form.get("bio")?.value),t.avatarUpload.edited&&(o.avatar=t.avatarUpload.value?{upload:t.avatarUpload.value,operation:h.f0.Insert}:{operation:h.f0.Delete}),Object.keys(o).length>1){const n=yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
            mutation UpdateEBoard($input: UpdateEBoardInput!) {
              updateEBoard(input: $input)
            }
          `,variables:{input:o}}));if(t.monitor.removeProcess(),n.errors)return void t.uiMessage.error("Error uploading data!");t.exit(!0)}})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(j.U),e.Y36(w.v),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-eboard-dialog"]],viewQuery:function(t,o){if(1&t&&e.Gf(xe,5),2&t){let n;e.iGM(n=e.CRH())&&(o.avatarUpload=n.first)}},decls:19,vars:5,consts:[[2,"position","relative",3,"formGroup"],[1,"background-color-divider",2,"width","100%","height","12.5em","border-radius","0.25em","overflow","hidden"],[2,"--size","8em","--offset","calc(var(--size) / 2)","--offset-left-over","calc(var(--size) - var(--offset))","position","relative","height","var(--offset-left-over)","margin-bottom","1em"],[1,"outline-color-card",2,"left","2em","top","calc(-1 * var(--offset))","position","absolute","height","var(--size)","width","var(--size)","border-radius","8em","overflow","hidden","outline-style","solid","outline-width","0.25em"],[1,"background-color-card",2,"width","100%","height","100%"],["fileSizeLimit","5 MB"],["avatarUpload",""],["appearance","outline",1,"no-padding",2,"width","100%","line-height","1.5em"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5","formControlName","bio",3,"maxLength"],["align","end"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0),e._UZ(2,"div",1),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"app-image-upload",5,6),e.qZA()()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Bio"),e.qZA(),e._UZ(11,"textarea",8),e.TgZ(12,"mat-hint",9),e._uU(13),e.qZA()()()(),e.TgZ(14,"mat-dialog-actions")(15,"button",10),e.NdJ("click",function(){return o.exit()}),e._uU(16,"Exit "),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){return o.save()}),e._uU(18,"Save "),e.qZA()()),2&t){let n;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("maxLength",600),e.xp6(2),e.hij("",(null==(n=o.form.get("bio"))||null==n.value?null:n.value.length)||0,"/600"),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[U.v,x.lW,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,m.KE,m.bx,m.hX,c.xY,c.H8,oe.J,L.IC,b.Nt]}),i})();var ne=l(2842);function Ce(i,r){if(1&i&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Ie(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Year is required "),e.qZA())}let Ue=(()=>{class i{constructor(t,o,n,s,d,v){this.backend=o,this.uiMessage=n,this.rolesService=s,this.dialogRef=d,this.data=v,this.monitor=new I.y,this.rolesEdited=!1,this.roles=[],this.acceptedRoles=[],this.disabledRoles=[],this.form=t.group({year:[v.term.year,[a.kI.required]]}),this.dialogRef.disableClose=!0}ngOnInit(){var t=this;return(0,g.Z)(function*(){t.rolesEdited=!1,t.roles=t.data.term.roles?.map(o=>o?.roleCode)??[],t.acceptedRoles=yield t.rolesService.getAddableEBoardTermRoles(),t.disabledRoles=yield t.rolesService.getDisabledEBoardTermRoles()})()}onEditRoles(){this.rolesEdited=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");return!0}catch(t){return this.uiMessage.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){if(!t.validate())return;const o={id:t.data.term.id};t.form.get("year")?.value!==t.data.term.year&&(o.year=t.form.get("year")?.value),t.rolesEdited&&(o.roles=t.roles),(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation UpdateEBoardTerm($input: UpdateEBoardTermInput!) {
            updateEBoardTerm(input: $input)
          }
        `,variables:{input:o}}))).errors?t.uiMessage.error("Error uploading data!"):t.exit(!0)})()}getAvailableYears(){const t=(new Date).getFullYear(),o=[this.data.term.year];for(let n=t+3;n>=2014;n--)this.data.takenYears.includes(n)||o.push(n);return o}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(D.v$),e.Y36(C.S),e.Y36(D.fu),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-eboard-term-dialog"]],decls:15,vars:9,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"flex","1"],["formControlName","year"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["label","Roles",3,"roles","allRoles","disabledRoles","disabled","rolesEdited"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"],[3,"value"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Year"),e.qZA(),e.TgZ(5,"mat-select",2),e.YNc(6,Ce,2,2,"mat-option",3),e.qZA(),e.YNc(7,Ie,2,0,"mat-error",4),e.qZA(),e.TgZ(8,"div")(9,"app-role-codes-editor",5),e.NdJ("rolesEdited",function(){return o.onEditRoles()}),e.qZA()()()(),e.TgZ(10,"mat-dialog-actions")(11,"button",6),e.NdJ("click",function(){return o.exit()}),e._uU(12,"Exit "),e.qZA(),e.TgZ(13,"button",6),e.NdJ("click",function(){return o.save()}),e._uU(14,"Save "),e.qZA()()),2&t){let n;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngForOf",o.getAvailableYears()),e.xp6(1),e.Q6J("ngIf",null==(n=o.form.get("year"))?null:n.hasError("required")),e.xp6(2),e.Q6J("roles",o.roles)("allRoles",o.acceptedRoles)("disabledRoles",o.disabledRoles)("disabled",!o.data.userOptions.canManageEBoardRoles),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.sg,u.O5,U.v,x.lW,a._Y,a.JJ,a.JL,a.sg,a.u,m.TO,m.KE,m.hX,ne.K,c.xY,c.H8,Z.gD,P.ey]}),i})();var R=l(6410),F=l(398),$=l(1063),we=l(9439),Ae=l(3223),re=l(6387);function Ee(i,r){1&i&&(e.TgZ(0,"p",7),e._uU(1,"Empty for now..."),e.qZA())}function ke(i,r){if(1&i&&e._UZ(0,"app-roles-display",8),2&i){const t=e.oxw();e.Q6J("roles",t.getRoles())}}function De(i,r){if(1&i&&(e.TgZ(0,"app-tag",10),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.getEBoardReign())}}function Oe(i,r){if(1&i&&(e.TgZ(0,"div",9)(1,"app-tag",10),e._uU(2,"\u{1f4ab} EBoard Alumni"),e.qZA(),e.YNc(3,De,2,1,"app-tag",11),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.getEBoardReign())}}let ae=(()=>{class i{constructor(t){this.cdn=t,this.eBoard={}}ngOnInit(){}hasRoles(){const t=(0,$.N)();return void 0!==this.eBoard.terms?.find(o=>o?.year===t)}getRoles(){const t=(0,$.N)();return this.eBoard.terms&&this.eBoard.terms.length>0?this.eBoard.terms.find(o=>o?.year===t)?.roles?.map(o=>o?.roleCode)??[]:[]}getEBoardReign(){if((new Date).getFullYear(),this.eBoard.terms&&this.eBoard.terms.length>0){if(!this.eBoard.terms[0]?.year)return"";let o=this.eBoard.terms[0].year,n=this.eBoard.terms[0].year;for(const s of this.eBoard.terms)!s?.year||(s.year<o&&(o=s.year),s.year>n&&(n=s.year));return`${o} - ${n}`}return""}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(j.U))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-eboard-profile"]],inputs:{eBoard:"eBoard"},decls:10,vars:5,consts:[["breakable-styles","","prebreak-style","\n    flex-direction: row; \n  ","break-style","\n    flex-direction: column;\n  ","break-on","width < 840",2,"display","flex","gap","0.5em 1.5em"],["size","large",3,"avatarSrc"],[2,"display","flex","flex-direction","column","max-height","100%"],["class","app-eboard-profile text-disabled",4,"ngIf"],[2,"flex","1"],[3,"roles",4,"ngIf"],["style","\n      display: flex;\n      flex-direction: row;\n      gap: 0.5em;\n      flex-wrap: wrap;\n    ",4,"ngIf"],[1,"app-eboard-profile","text-disabled"],[3,"roles"],[2,"display","flex","flex-direction","row","gap","0.5em","flex-wrap","wrap"],["color","blank"],["color","blank",4,"ngIf"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-avatar",1),e.TgZ(2,"div",2)(3,"h2"),e._uU(4,"Bio"),e.qZA(),e.YNc(5,Ee,2,0,"p",3),e.TgZ(6,"p",4),e._uU(7),e.qZA(),e.YNc(8,ke,1,1,"app-roles-display",5),e.YNc(9,Oe,4,1,"div",6),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("avatarSrc",o.cdn.getFileLink(o.eBoard.avatarLink)),e.xp6(4),e.Q6J("ngIf",!o.eBoard.bio),e.xp6(2),e.Oqu(o.eBoard.bio),e.xp6(1),e.Q6J("ngIf",o.hasRoles()),e.xp6(1),e.Q6J("ngIf",!o.hasRoles()))},dependencies:[u.O5,we.l,F.l,Ae.A,re.Z]}),i})();function Pe(i,r){1&i&&(e.TgZ(0,"th",20),e._uU(1," Year "),e.qZA())}function Je(i,r){if(1&i&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t.year," ")}}function Ne(i,r){1&i&&(e.TgZ(0,"th",22),e._uU(1," Roles "),e.qZA())}function qe(i,r){if(1&i&&(e.TgZ(0,"td",23),e._UZ(1,"app-roles-display",24),e.qZA()),2&i){const t=r.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("roles",o.getTermRoles(t))}}function Se(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"th",25)(1,"div",26)(2,"button",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onAddTerm())}),e.TgZ(3,"mat-icon"),e._uU(4,"add"),e.qZA(),e._uU(5," Add Term "),e.qZA()()()}}function Ye(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td",28)(1,"div",26)(2,"button",29),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.onEditTerm(s))}),e.TgZ(3,"mat-icon"),e._uU(4,"edit"),e.qZA()(),e.TgZ(5,"button",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.onDeleteTerm(s))}),e.TgZ(6,"mat-icon"),e._uU(7,"cancel"),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("disabled",t.monitor.isProcessing),e.xp6(3),e.Q6J("disabled",t.monitor.isProcessing)}}function Me(i,r){1&i&&e._UZ(0,"tr",31)}function Qe(i,r){1&i&&e._UZ(0,"tr",32)}function Be(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"h2"),e._uU(3,"E-Board"),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-eboard-profile",4),e.TgZ(6,"div",5)(7,"button",6),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onEditEBoard())}),e.TgZ(8,"mat-icon"),e._uU(9,"edit"),e.qZA()()()()(),e.TgZ(10,"h2"),e._uU(11,"Terms"),e.qZA(),e.TgZ(12,"table",7),e.ynx(13,8),e.YNc(14,Pe,2,0,"th",9),e.YNc(15,Je,2,1,"td",10),e.BQk(),e.ynx(16,11),e.YNc(17,Ne,2,0,"th",12),e.YNc(18,qe,2,1,"td",13),e.BQk(),e.ynx(19,14),e.YNc(20,Se,6,0,"th",15),e.YNc(21,Ye,8,2,"td",16),e.BQk(),e.YNc(22,Me,1,0,"tr",17),e.YNc(23,Qe,1,0,"tr",18),e.qZA(),e.TgZ(24,"h2"),e._uU(25,"Danger Zone"),e.qZA(),e.TgZ(26,"button",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onDeleteEBoard())}),e.TgZ(27,"mat-icon"),e._uU(28,"delete"),e.qZA(),e._uU(29," Delete E-Board "),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("eBoard",t.user.eBoard),e.xp6(7),e.Q6J("dataSource",t.getEBoardTerms()),e.xp6(10),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(3),e.Q6J("disabled",!t.userOptions.canManageEBoard||t.monitor.isProcessing)}}function je(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"h2"),e._uU(2,"Actions"),e.qZA(),e.TgZ(3,"button",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onCreateEBoard())}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA(),e._uU(6," Create E-Board "),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("disabled",!t.userOptions.canManageEBoard||t.monitor.isProcessing)}}let Le=(()=>{class i{constructor(t,o,n){this.uiMessage=t,this.backend=o,this.dialog=n,this.edited=new e.vpe,this.user={},this.userOptions={canUpdateUser:!1,nonExistent:!1,hasProjects:!1,deleteUserTooltip:"",canDeleteUser:!1,canManageUserRoles:!1,canManageEBoardRoles:!1,canManageEBoard:!1,canManageMetadata:!1,canManageProjectInvites:!1,canUpdateUserPrivate:!1,canCreateProject:!1,loaded:!1},this.displayedColumns=["year","roles","buttons"],this.monitor=new I.y}getEBoardTerms(){return this.user.eBoard?.terms??[]}getTermRoles(t){return t.roles?.map(o=>o?.roleCode)??[]}onAddTerm(){var t=this;return(0,g.Z)(function*(){!(yield(0,p.z)(t.dialog.open(Te,{data:{eBoardId:t.user.eBoard?.id,takenYears:t.user.eBoard?.terms?.map(n=>n?.year)??[]},width:"37.5em",maxWidth:"90vw"}).afterClosed()))||t.edited.emit()})()}onEditTerm(t){var o=this;return(0,g.Z)(function*(){!(yield(0,p.z)(o.dialog.open(Ue,{data:{term:t,takenYears:o.user.eBoard?.terms?.map(s=>s?.year)??[],userOptions:o.userOptions},width:"37.5em",maxWidth:"90vw"}).afterClosed()))||o.edited.emit()})()}onDeleteTerm(t){var o=this;return(0,g.Z)(function*(){!(yield(0,p.z)(o.uiMessage.confirmDialog("Are you sure you want to delete this term?")))||(yield(0,p.z)(o.backend.withAuth().mutate({mutation:f.Ps`
          mutation DeleteEBoardTerm($id: ID!) {
            deleteEBoardTerm(id: $id)
          }
        `,variables:{id:t.id}}))).errors||(o.uiMessage.notifyInfo("Term deleted!"),o.edited.emit())})()}onCreateEBoard(){var t=this;return(0,g.Z)(function*(){!(yield(0,p.z)(t.uiMessage.confirmDialog("Are you sure you want to create an e-board profile?")))||(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation NewEBoard($input: NewEBoardInput!) {
            newEBoard(input: $input)
          }
        `,variables:{input:{userId:t.user.id}}}))).errors||(t.uiMessage.notifyConfirmed("EBoard profile created!"),t.edited.emit())})()}onEditEBoard(){var t=this;return(0,g.Z)(function*(){!(yield(0,p.z)(t.dialog.open(Ze,{data:{eBoard:t.user.eBoard},width:"37.5em",maxWidth:"90vw"}).afterClosed()))||t.edited.emit()})()}onDeleteEBoard(){var t=this;return(0,g.Z)(function*(){!(yield(0,p.z)(t.uiMessage.confirmDialog("Are you sure you want to delete the e-board profile?")))||(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation DeleteEBoard($id: ID!) {
            deleteEBoard(id: $id)
          }
        `,variables:{id:t.user.eBoard?.id}}))).errors||(t.uiMessage.notifyConfirmed("EBoard profile created!"),t.edited.emit())})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.S),e.Y36(w.v),e.Y36(c.uw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-eboard-tab"]],inputs:{user:"user",userOptions:"userOptions"},outputs:{edited:"edited"},decls:3,vars:2,consts:[["full-page",""],[4,"ngIf"],[2,"margin-bottom","2em"],[2,"display","flex","flex-direction","row","gap","1em"],[2,"flex","1",3,"eBoard"],[2,"display","flex","flex-direction","column","justify-content","center","gap","0.5em"],["mat-icon-button","",3,"click"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%","margin-bottom","2em",3,"dataSource"],["matColumnDef","year"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by year",4,"matHeaderCellDef"],["mat-cell","","style","max-width: 100px; overflow: hidden;",4,"matCellDef"],["matColumnDef","roles"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","style","max-width: 100px; overflow: hidden; padding: 1em",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-flat-button","","pill","","tall-button","","color","primary",2,"max-width","20em",3,"disabled","click"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by year"],["mat-cell","",2,"max-width","100px","overflow","hidden"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",2,"max-width","100px","overflow","hidden","padding","1em"],[3,"roles"],["mat-header-cell",""],[2,"display","flex","justify-content","right"],["mat-stroked-button","","pill","",1,"text-foreground",3,"click"],["mat-cell",""],["mat-icon-button","",3,"disabled","click"],["mat-icon-button","",2,"margin-left","0.5em",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(e.TgZ(0,"app-bg-container",0),e.YNc(1,Be,30,5,"div",1),e.YNc(2,je,7,1,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",o.user.eBoard),e.xp6(1),e.Q6J("ngIf",!o.user.eBoard))},dependencies:[u.O5,U.v,x.lW,R.h,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,F.l,T.Hw,ae]}),i})();function Re(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Name is required "),e.qZA())}function Fe(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Identity ID is required "),e.qZA())}let $e=(()=>{class i{constructor(t,o,n,s,d){this.backend=o,this.uiMessageService=n,this.dialogRef=s,this.data=d,this.monitor=new I.y,this.form=t.group({name:[null,[a.kI.required]],identityId:[null,[a.kI.required]]}),s.disableClose=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");return!0}catch(t){return this.uiMessageService.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){!t.validate()||(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation NewUserLoginIdentity($input: NewUserLoginIdentityInput!) {
            newUserLoginIdentity(input: $input)
          }
        `,variables:{input:{userId:t.data.userId,name:t.form.get("name")?.value,identityId:t.form.get("identityId")?.value}}}))).errors||(t.uiMessageService.notifyConfirmed("Login identity created!"),t.exit(!0))})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(w.v),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-create-login-identity-dialog"]],decls:17,vars:5,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","name"],[4,"ngIf"],["matInput","","formControlName","identityId"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Name"),e.qZA(),e._UZ(5,"input",2),e.YNc(6,Re,2,0,"mat-error",3),e.qZA(),e.TgZ(7,"mat-form-field",1)(8,"mat-label"),e._uU(9,"Identity ID"),e.qZA(),e._UZ(10,"input",4),e.YNc(11,Fe,2,0,"mat-error",3),e.qZA()()(),e.TgZ(12,"mat-dialog-actions")(13,"button",5),e.NdJ("click",function(){return o.exit()}),e._uU(14,"Exit "),e.qZA(),e.TgZ(15,"button",5),e.NdJ("click",function(){return o.save()}),e._uU(16,"Add "),e.qZA()()),2&t){let n,s;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngIf",null==(n=o.form.get("name"))?null:n.hasError("required")),e.xp6(5),e.Q6J("ngIf",null==(s=o.form.get("identityId"))?null:s.hasError("required")),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.O5,U.v,x.lW,c.xY,c.H8,m.TO,m.KE,m.hX,b.Nt,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]}),i})();function ze(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Name is required "),e.qZA())}function Ge(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Identity ID is required "),e.qZA())}let He=(()=>{class i{constructor(t,o,n,s,d){this.backend=o,this.uiMessage=n,this.dialogRef=s,this.data=d,this.monitor=new I.y,this.form=t.group({name:[d.loginIdentity.name,[a.kI.required]],identityId:[d.loginIdentity.identityId,[a.kI.required]],data:[JSON.stringify(d.loginIdentity.data)]}),this.dialogRef.disableClose=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");if(this.form.get("name")?.value!==this.data.loginIdentity.name&&this.data.takenNames.includes(this.form.get("name")?.value))throw new Error("Identity with same name already exists!");if(this.form.get("data")?.value!==this.data.loginIdentity.id)try{JSON.parse(this.form.get("data")?.value)}catch{throw new Error("Could not parse data as JSON!")}return!0}catch(t){return this.uiMessage.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){if(!t.validate())return;const o={id:t.data.loginIdentity.id};t.form.get("name")?.value!==t.data.loginIdentity.name&&(o.name=t.form.get("name")?.value),t.form.get("identityId")?.value!==t.data.loginIdentity.id&&(o.identityId=t.form.get("identityId")?.value),t.form.get("data")?.value!==t.data.loginIdentity.id&&(o.data=JSON.parse(t.form.get("data")?.value)),(yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation UpdateUserLoginIdentity($input: UpdateUserLoginIdentityInput!) {
            updateUserLoginIdentity(input: $input)
          }
        `,variables:{input:o}}))).errors?t.uiMessage.error("Error uploading data!"):t.exit(!0)})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(D.v$),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-login-identity-dialog"]],decls:21,vars:5,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","name"],[4,"ngIf"],["matInput","","formControlName","identityId"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5","formControlName","data"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Name"),e.qZA(),e._UZ(5,"input",2),e.YNc(6,ze,2,0,"mat-error",3),e.qZA(),e.TgZ(7,"mat-form-field",1)(8,"mat-label"),e._uU(9,"Identity ID"),e.qZA(),e._UZ(10,"input",4),e.YNc(11,Ge,2,0,"mat-error",3),e.qZA(),e.TgZ(12,"mat-form-field",1)(13,"mat-label"),e._uU(14,"Data"),e.qZA(),e._UZ(15,"textarea",5),e.qZA()()(),e.TgZ(16,"mat-dialog-actions")(17,"button",6),e.NdJ("click",function(){return o.exit()}),e._uU(18,"Exit "),e.qZA(),e.TgZ(19,"button",6),e.NdJ("click",function(){return o.save()}),e._uU(20,"Save "),e.qZA()()),2&t){let n,s;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngIf",null==(n=o.form.get("name"))?null:n.hasError("required")),e.xp6(5),e.Q6J("ngIf",null==(s=o.form.get("identityId"))?null:s.hasError("required")),e.xp6(6),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.O5,U.v,x.lW,c.xY,c.H8,m.TO,m.KE,m.hX,L.IC,b.Nt,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]}),i})();function Ve(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Expected a valid email."),e.qZA())}let Ke=(()=>{class i{constructor(t,o,n,s,d){this.backend=o,this.uiMessageService=n,this.dialogRef=s,this.data=d,this.monitor=new I.y,this.form=t.group({email:[d.user.email,[a.kI.email]],netId:[d.user.netId],manualVerified:[d.user.manualVerified]}),s.disableClose=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");return!0}catch(t){return this.uiMessageService.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){if(t.monitor.isProcessing||!t.validate())return;const o={id:t.data.user.id};if(t.form.get("email")?.value!==t.data.user.email&&(o.email=t.form.get("email")?.value??null),t.form.get("netId")?.value!==t.data.user.netId&&(o.netId=t.form.get("netId")?.value??null),t.form.get("manualVerified")?.value!==t.data.user.manualVerified&&(o.manualVerified=t.form.get("manualVerified")?.value??null),Object.keys(o).length>1){t.monitor.addProcess();const n=yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
            mutation EditUserPrivateDialog($input: UpdateUserInput!) {
              updateUser(input: $input)
            }
          `,variables:{input:o}}));if(t.monitor.removeProcess(),n.errors)return void t.uiMessageService.error("Error uploading data!");t.exit(!0)}})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(w.v),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-user-private-dialog"]],decls:20,vars:7,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","email",3,"maxLength"],[4,"ngIf"],["matInput","","formControlName","netId",3,"maxLength"],["matInput","","formControlName","manualVerified",3,"maxLength"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Email"),e.qZA(),e._UZ(5,"input",2),e.YNc(6,Ve,2,0,"mat-error",3),e.qZA(),e.TgZ(7,"mat-form-field",1)(8,"mat-label"),e._uU(9,"NetID"),e.qZA(),e._UZ(10,"input",4),e.qZA(),e.TgZ(11,"mat-form-field",1)(12,"mat-label"),e._uU(13,"Manual Verify Reason"),e.qZA(),e._UZ(14,"input",5),e.qZA()()(),e.TgZ(15,"mat-dialog-actions")(16,"button",6),e.NdJ("click",function(){return o.exit()}),e._uU(17,"Exit "),e.qZA(),e.TgZ(18,"button",6),e.NdJ("click",function(){return o.save()}),e._uU(19,"Save "),e.qZA()()),2&t){let n;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(4),e.Q6J("maxLength",50),e.xp6(1),e.Q6J("ngIf",null==(n=o.form.get("email"))?null:n.hasError("email")),e.xp6(4),e.Q6J("maxLength",50),e.xp6(4),e.Q6J("maxLength",50),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.O5,U.v,x.lW,c.xY,c.H8,m.TO,m.KE,m.hX,b.Nt,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]}),i})();var Xe=l(3288);function We(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Expected a valid Rutgers NetID."),e.qZA())}let et=(()=>{class i{constructor(t,o,n,s,d){this.backend=o,this.uiMessageService=n,this.dialogRef=s,this.data=d,this.monitor=new I.y,this.form=t.group({netId:[d.user.netId,[Xe.d.netId]]}),s.disableClose=!0}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){var t=this;return(0,g.Z)(function*(){try{if(t.form.updateValueAndValidity(),!t.form.valid)throw new Error("Missing info!");const o=t.form.get("netId")?.value;if(o!==t.data.user.netId&&(yield(0,p.z)(t.backend.withAuth().query({query:f.Ps`
              query CheckDuplicateNetId($filter: UserFilterInput!) {
                users(filter: $filter) {
                  id
                }
              }
            `,variables:{filter:{netId:{eq:o}}}}))).data.users.length>0)throw new Error(`NetID "${o}" is already linked to an account!`);return!0}catch(o){return t.uiMessageService.error(o),!1}})()}save(){var t=this;return(0,g.Z)(function*(){if(t.monitor.isProcessing||!(yield t.validate()))return;const o={userId:t.data.user.id};if(t.form.get("netId")?.value!==t.data.user.netId&&(o.netId=t.form.get("netId")?.value??null),Object.keys(o).length>1){t.monitor.addProcess();const n=yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
            mutation LinkNetIdDialog($input: VerifyNetIdInput!) {
              verifyNetId(input: $input)
            }
          `,variables:{input:o}}));if(t.monitor.removeProcess(),n.errors)return void t.uiMessageService.error("Error uploading data!");t.uiMessageService.notifyInfo("Verification email has been sent to your Rutgers email! Please follow the instructions in the email to finish linking your NetID."),t.exit(!0)}})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(w.v),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-link-netid-dialog"]],decls:12,vars:5,consts:[[2,"position","relative",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","netId",3,"maxLength"],[4,"ngIf"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4,"Rutgers NetID"),e.qZA(),e._UZ(5,"input",2),e.YNc(6,We,2,0,"mat-error",3),e.qZA()()(),e.TgZ(7,"mat-dialog-actions")(8,"button",4),e.NdJ("click",function(){return o.exit()}),e._uU(9,"Exit "),e.qZA(),e.TgZ(10,"button",4),e.NdJ("click",function(){return o.save()}),e._uU(11,"Save "),e.qZA()()),2&t){let n;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(4),e.Q6J("maxLength",50),e.xp6(1),e.Q6J("ngIf",null==(n=o.form.get("netId"))?null:n.hasError("netId")),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.O5,U.v,x.lW,c.xY,c.H8,m.TO,m.KE,m.hX,b.Nt,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]}),i})();var tt=l(9942),it=l(8009),ot=l(4614);function nt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onEditUserPrivate())}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA(),e._uU(4," Edit Private Information "),e.qZA()()}}function rt(i,r){if(1&i&&(e.TgZ(0,"div")(1,"h2"),e._uU(2,"Manual Verification Reason:"),e.qZA(),e.TgZ(3,"p",13),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.user.manualVerified)}}function at(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onCreateLoginIdentity())}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," Add Login Identity "),e.qZA()}}function st(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"button",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw();return e.KtG(s.onEditLoginIdentity(n))}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"button",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw();return e.KtG(s.onDeleteLoginIdentity(n))}),e.TgZ(5,"mat-icon"),e._uU(6,"close"),e.qZA()()()}}function lt(i,r){if(1&i&&(e.TgZ(0,"div",15)(1,"app-card"),e.YNc(2,st,7,0,"div",16),e.TgZ(3,"h2"),e._uU(4),e.qZA(),e.TgZ(5,"h4",17),e._uU(6,"ID"),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"h4",17),e._uU(10,"Data"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA()()()),2&i){const t=r.$implicit,o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.userOptions.canManageMetadata),e.xp6(2),e.Oqu(o.getIdentityName(t)),e.xp6(4),e.Oqu(null==t?null:t.identityId),e.xp6(4),e.Oqu(o.getIdentityData(t))}}let dt=(()=>{class i{constructor(t,o,n,s,d,v){this.securityService=t,this.authService=o,this.router=n,this.backend=s,this.dialog=d,this.uiMessageService=v,this.edited=new e.vpe,this.user={},this.userOptions={canUpdateUser:!1,nonExistent:!1,hasProjects:!1,deleteUserTooltip:"",canDeleteUser:!1,canManageUserRoles:!1,canManageEBoardRoles:!1,canManageEBoard:!1,canManageMetadata:!1,canManageProjectInvites:!1,canUpdateUserPrivate:!1,canCreateProject:!1,loaded:!1},this.monitor=new I.y,this.takenLoginIdentityNames=[]}ngOnChanges(t){t.user&&(this.takenLoginIdentityNames=this.user.loginIdentities?.map(o=>o?.name??"")??[])}getIdentityData(t){return JSON.stringify(t?.data)}getIdentityName(t){return(t?.name?.charAt(0).toUpperCase()??"")+t?.name?.slice(1)}onLinkNetId(){this.dialog.open(et,{data:{user:this.user,userOptions:this.userOptions},width:"35em",maxWidth:"90vw"})}onEditUserPrivate(){var t=this;return(0,g.Z)(function*(){(yield(0,p.z)(t.dialog.open(Ke,{data:{user:t.user,userOptions:t.userOptions},width:"35em",maxWidth:"90vw"}).afterClosed()))&&t.edited.emit()})()}onDeleteUser(){var t=this;return(0,g.Z)(function*(){let o=`Are you sure you want to delete "${t.user.username}"? There's no going back!`;if(t.securityService.securityContext?.userId===t.user.id&&(o="Are you sure you want to delete your profile? There's no going back!"),!(yield(0,p.z)(t.uiMessageService.confirmDialog(o))))return;t.monitor.addProcess();const s=yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
          mutation DeleteUser($id: ID!) {
            deleteUser(id: $id)
          }
        `,variables:{id:t.user.id}}));t.monitor.removeProcess(),!s.errors&&(t.securityService.securityContext?.userId===t.user.id?t.authService.logout():t.router.navigateByUrl("/users"))})()}onClearCache(){var t=this;return(0,g.Z)(function*(){t.monitor.addProcess(),yield t.backend.clearCache(),yield t.securityService.clearCache(),t.monitor.removeProcess(),t.uiMessageService.notifyInfo("Cache cleared!")})()}onCreateLoginIdentity(){var t=this;return(0,g.Z)(function*(){(yield(0,p.z)(t.dialog.open($e,{data:{userId:t.user.id,takenNames:t.takenLoginIdentityNames}}).afterClosed()))&&t.edited.emit()})()}onEditLoginIdentity(t){var o=this;return(0,g.Z)(function*(){t&&(yield(0,p.z)(o.dialog.open(He,{data:{loginIdentity:t,takenNames:o.takenLoginIdentityNames}}).afterClosed()))&&o.edited.emit()})()}onDeleteLoginIdentity(t){var o=this;return(0,g.Z)(function*(){t&&(yield(0,p.z)(o.uiMessageService.confirmDialog("Are you sure you want to delete this login identity?")))&&(yield(0,p.z)(o.backend.withAuth().mutate({mutation:f.Ps`
          mutation DeleteUserLoginIdentity($id: ID!) {
            deleteUserLoginIdentity(id: $id)
          }
        `,variables:{id:t.id}})))&&o.edited.emit()})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(ie.I),e.Y36(tt.e),e.Y36(O.F0),e.Y36(w.v),e.Y36(c.uw),e.Y36(C.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-settings-tab"]],inputs:{user:"user",userOptions:"userOptions"},outputs:{edited:"edited"},features:[e.TTD],decls:40,vars:11,consts:[["full-page",""],[2,"display","flex","flex-direction","column","gap","2em"],[4,"ngIf"],["mat-flat-button","","pill","","color","primary",1,"mb-16",2,"max-width","20em",3,"disabled","click"],[2,"display","flex","flex-direction","row","margin-bottom","0.5em","align-items","center"],[2,"flex","1","margin-bottom","0"],["pill","","mat-stroked-button","",3,"click",4,"ngIf"],[2,"display","flex","flex-direction","column","gap","1em"],["column-width","20em",2,"width","100%"],["style","width: 100%;",4,"ngFor","ngForOf"],["mat-flat-button","","pill","","tall-button","","color","primary",2,"max-width","20em",3,"disabled","click"],[2,"width","min-content",3,"matTooltip"],["mat-stroked-button","","pill","",3,"click"],[1,"mb=0"],["pill","","mat-stroked-button","",3,"click"],[2,"width","100%"],["style","\n                position: absolute;\n                top: 0.5em;\n                right: 0.5em;\n                display: flex;\n                flex-direction: row;\n                gap: 0.5em;\n                justify-content: end;\n              ",4,"ngIf"],[2,"margin-bottom","0.1em"],[2,"position","absolute","top","0.5em","right","0.5em","display","flex","flex-direction","row","gap","0.5em","justify-content","end"],["mat-icon-button","",3,"click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"app-bg-container",0)(1,"div",1),e.YNc(2,nt,5,0,"div",2),e.TgZ(3,"div")(4,"h2"),e._uU(5,"Email:"),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"h2"),e._uU(9,"Rutgers NetID:"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA(),e.TgZ(12,"button",3),e.NdJ("click",function(){return o.onLinkNetId()}),e.TgZ(13,"mat-icon"),e._uU(14,"add"),e.qZA(),e._uU(15),e.qZA(),e.YNc(16,rt,5,1,"div",2),e.qZA(),e.TgZ(17,"div")(18,"div",4)(19,"h2",5),e._uU(20,"Login Identities:"),e.qZA(),e.YNc(21,at,4,0,"button",6),e.qZA(),e.TgZ(22,"div",7)(23,"app-card-grid",8),e.YNc(24,lt,13,4,"div",9),e.qZA()()(),e.TgZ(25,"div")(26,"h2"),e._uU(27,"Utilities"),e.qZA(),e.TgZ(28,"button",10),e.NdJ("click",function(){return o.onClearCache()}),e.TgZ(29,"mat-icon"),e._uU(30,"delete"),e.qZA(),e._uU(31," Clear Cache "),e.qZA()(),e.TgZ(32,"div")(33,"h2"),e._uU(34,"Danger Zone"),e.qZA(),e.TgZ(35,"div",11)(36,"button",10),e.NdJ("click",function(){return o.onDeleteUser()}),e.TgZ(37,"mat-icon"),e._uU(38,"delete"),e.qZA(),e._uU(39," Delete User "),e.qZA()()()()()),2&t){let n;e.xp6(2),e.Q6J("ngIf",o.userOptions.canUpdateUserPrivate),e.xp6(5),e.Oqu(null!==(n=o.user.email)&&void 0!==n?n:"None"),e.xp6(4),e.Oqu(o.user.netId?o.user.netId:"None"),e.xp6(1),e.Q6J("disabled",!o.userOptions.canUpdateUser||o.monitor.isProcessing),e.xp6(3),e.hij(" ",o.user.netId?"Relink":"Link"," NetID "),e.xp6(1),e.Q6J("ngIf",o.user.manualVerified),e.xp6(5),e.Q6J("ngIf",o.userOptions.canManageMetadata),e.xp6(3),e.Q6J("ngForOf",o.user.loginIdentities),e.xp6(4),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(7),e.Q6J("matTooltip",o.userOptions.deleteUserTooltip),e.xp6(1),e.Q6J("disabled",!o.userOptions.canDeleteUser||o.monitor.isProcessing)}},dependencies:[u.sg,u.O5,U.v,x.lW,R.h,it.Y,ot.A,te.gM,T.Hw]}),i})();var se=l(3451),ct=l(5561),z=l(1769),le=l(8399);function ut(i,r){if(1&i&&(e.TgZ(0,"mat-select-trigger",11),e._UZ(1,"ic-icon",12),e._uU(2),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.getSocialPlatformData(t.platform.value).icon),e.xp6(1),e.hij("",t.getSocialPlatformData(t.platform.value).name," ")}}function mt(i,r){if(1&i&&(e.TgZ(0,"mat-option",13)(1,"div",14),e._UZ(2,"ic-icon",15),e._uU(3),e.qZA()()),2&i){const t=r.$implicit;e.Q6J("value",t.key),e.xp6(2),e.Q6J("icon",t.value.icon),e.xp6(1),e.hij(" ",t.value.name," ")}}function pt(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Platform is required "),e.qZA())}function gt(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Username is required "),e.qZA())}function ft(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Link is required "),e.qZA())}class G{constructor(r={link:"",platform:"",username:""},t){this.userSocial=r,this.editableSocialButton=t}validate(){return this.editableSocialButton?.validate()}compositeValue(){return this.userSocial}}let _t=(()=>{class i{constructor(t){this.delete=new e.vpe,this.edit=new e.vpe,this.userSocialEdit=new G,this.onDestroy$=new B.x,this.form=t.group({platform:[null,[a.kI.required]],username:[null,[a.kI.required]],link:[null,[a.kI.required]]})}get platform(){return this.form.get("platform")}ngOnInit(){this.userSocialEdit.editableSocialButton=this,this.form.get("platform")?.setValue(this.userSocialEdit.userSocial.platform),this.form.get("username")?.setValue(this.userSocialEdit.userSocial.username),this.form.get("link")?.setValue(this.userSocialEdit.userSocial.link),this.form.get("platform")?.valueChanges.pipe((0,E.R)(this.onDestroy$)).subscribe({next:t=>{this.userSocialEdit.userSocial.platform=t,this.edit.emit()}}),this.form.get("username")?.valueChanges.pipe((0,E.R)(this.onDestroy$)).subscribe({next:t=>{this.userSocialEdit.userSocial.username=t,this.edit.emit()}}),this.form.get("link")?.valueChanges.pipe((0,E.R)(this.onDestroy$)).subscribe({next:t=>{this.userSocialEdit.userSocial.link=t,this.edit.emit()}})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}validate(){return this.form.markAllAsTouched(),this.form.updateValueAndValidity(),this.form.valid}onDelete(){this.edit.emit(),this.delete.emit()}getSocialPlatforms(){return z.VB}getSocialPlatformData(t){return z.VB[t]}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.QS))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-editable-social-button"]],inputs:{userSocialEdit:"userSocialEdit"},outputs:{delete:"delete",edit:"edit"},decls:23,vars:8,consts:[[1,"app-editable-social-button","card"],["type","button","mat-icon-button","",2,"position","absolute","right","0.5em","top","0.5em",3,"click"],[2,"flex-grow","1","display","flex","flex-direction","column",3,"formGroup"],["appearance","outline"],["formControlName","platform",2,"min-height","27px"],["style","display:flex; align-items: center; gap: 0.5em;",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","username"],["appearance","outline",2,"padding-top","4px"],["matInput","","formControlName","link"],[2,"display","flex","align-items","center","gap","0.5em"],["size","1.5em",3,"icon"],[3,"value"],[2,"display","flex","align-items","center","flex-direction","row","gap","0.5em"],["size","1.25em",3,"icon"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return o.onDelete()}),e.TgZ(2,"mat-icon"),e._uU(3,"close"),e.qZA()(),e.TgZ(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),e._uU(7,"Platform"),e.qZA(),e.TgZ(8,"mat-select",4),e.YNc(9,ut,3,2,"mat-select-trigger",5),e.YNc(10,mt,4,3,"mat-option",6),e.ALo(11,"keyvalue"),e.qZA(),e.YNc(12,pt,2,0,"mat-error",7),e.qZA(),e.TgZ(13,"mat-form-field",3)(14,"mat-label"),e._uU(15,"Username"),e.qZA(),e._UZ(16,"input",8),e.YNc(17,gt,2,0,"mat-error",7),e.qZA(),e.TgZ(18,"mat-form-field",9)(19,"mat-label"),e._uU(20,"Link"),e.qZA(),e._UZ(21,"input",10),e.YNc(22,ft,2,0,"mat-error",7),e.qZA()()()),2&t){let n,s,d;e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngIf",o.platform&&o.platform.value),e.xp6(1),e.Q6J("ngForOf",e.lcZ(11,6,o.getSocialPlatforms())),e.xp6(2),e.Q6J("ngIf",null==(n=o.form.get("platform"))?null:n.hasError("required")),e.xp6(5),e.Q6J("ngIf",null==(s=o.form.get("username"))?null:s.hasError("required")),e.xp6(5),e.Q6J("ngIf",null==(d=o.form.get("link"))?null:d.hasError("required"))}},dependencies:[u.sg,u.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,m.TO,m.KE,m.hX,le.ar,T.Hw,P.ey,Z.gD,Z.$L,b.Nt,x.lW,u.Nd],styles:[".card[_ngcontent-%COMP%]{border:2px solid;border-radius:8px;align-content:center;align-items:center;padding:3em 1em 1em;position:relative}"]}),i})();var vt=l(592),ht=l(9883);const bt=["avatarUpload"],yt=["bannerUpload"];function Tt(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Display name is required "),e.qZA())}function xt(i,r){if(1&i&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Zt(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Bio is required "),e.qZA())}function Ct(i,r){1&i&&(e.TgZ(0,"div",30),e._uU(1,"Empty..."),e.qZA())}function It(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"app-editable-social-button",31),e.NdJ("delete",function(){const s=e.CHM(t).index,d=e.oxw();return e.KtG(d.onDeleteSocial(s))})("edit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onEditSocial())}),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(1),e.Q6J("userSocialEdit",t)}}function Ut(i,r){if(1&i&&(e.TgZ(0,"div")(1,"h2"),e._uU(2,"Metadata"),e.qZA(),e.TgZ(3,"mat-form-field",15)(4,"mat-label"),e._uU(5,"Created At"),e.qZA(),e._UZ(6,"input",32),e.TgZ(7,"mat-hint"),e._uU(8,"MM/DD/YYYY"),e.qZA(),e._UZ(9,"mat-datepicker-toggle",33)(10,"mat-datepicker",null,34),e.qZA()()),2&i){const t=e.MAs(11);e.xp6(6),e.Q6J("matDatepicker",t),e.xp6(3),e.Q6J("for",t)}}let wt=(()=>{class i{constructor(t,o,n,s,d,v,y){this.cdn=o,this.backend=n,this.rolesService=s,this.uiMessageService=d,this.dialogRef=v,this.data=y,this.userSocialEdits=[],this.socialsEdited=!1,this.roles=[],this.disabledRoles=[],this.acceptedRoles=[],this.rolesEdited=!1,this.monitor=new I.y,this.form=t.group({displayName:[y.user.displayName,[a.kI.required]],bio:[y.user.bio,[]],classYear:[y.user.classYear,[]],createdAt:[new Date(this.data.user.createdAt)]}),v.disableClose=!0}ngAfterViewInit(){var t=this;return(0,g.Z)(function*(){setTimeout((0,g.Z)(function*(){!t.avatarUpload||!t.bannerUpload||!t.data.user.roles||!t.data.user.id||(t.avatarUpload.init(t.cdn.getFileLink(t.data.user.avatarLink)),t.bannerUpload.init(t.cdn.getFileLink(t.data.user.bannerLink)),t.socialsEdited=!1,t.data.user.socials&&(t.userSocialEdits=t.data.user.socials.map(o=>new G({link:o?.link??"",platform:o?.platform??"",username:o?.username??""}))),t.rolesEdited=!1,t.roles=t.data.user.roles.map(o=>o?.roleCode),t.acceptedRoles=yield t.rolesService.getAddableUserRoles(),t.disabledRoles=yield t.rolesService.getDisabledUserRoles())}),0)})()}onEditSocial(){this.socialsEdited=!0}onEditRoles(){this.rolesEdited=!0}onAddSocial(){this.userSocialEdits.push(new G)}onDeleteSocial(t){this.userSocialEdits.splice(t,1)}exit(t=!1){this.monitor.isProcessing||this.dialogRef.close(t)}validate(){try{if(this.form.updateValueAndValidity(),!this.form.valid)throw new Error("Missing info!");for(const t of this.userSocialEdits)if(!t.validate())throw new Error("A user social is incomplete!");return(0,vt.v)(this.userSocialEdits.map(t=>t.userSocial),(t,o)=>t.username===o.username&&t.platform===o.platform,"Cannot have duplicate user socials with identical usernames and platforms!"),!0}catch(t){return this.uiMessageService.error(t),!1}}save(){var t=this;return(0,g.Z)(function*(){if(t.monitor.isProcessing||!t.avatarUpload||!t.bannerUpload||!t.validate())return;const o={id:t.data.user.id};if(t.rolesEdited&&(o.roles=t.roles),t.socialsEdited&&(o.socials=t.userSocialEdits.map(n=>n.userSocial)),t.form.get("displayName")?.value!==t.data.user.displayName&&(o.displayName=t.form.get("displayName")?.value),t.form.get("bio")?.value!==t.data.user.bio&&(o.bio=t.form.get("bio")?.value),t.form.get("classYear")?.value!==t.data.user.classYear&&(o.classYear=t.form.get("classYear")?.value),t.avatarUpload.edited&&(o.avatar=t.avatarUpload.value?{upload:t.avatarUpload.value,operation:h.f0.Insert}:{operation:h.f0.Delete}),t.bannerUpload.edited&&(o.banner=t.bannerUpload.value?{upload:t.bannerUpload.value,operation:h.f0.Insert}:{operation:h.f0.Delete}),t.data.userOptions.canManageMetadata){const n=t.form.get("createdAt")?.value?.getTime();n!==t.data.user.createdAt&&(o.createdAt=n)}if(Object.keys(o).length>1){t.monitor.addProcess();const n=yield(0,p.z)(t.backend.withAuth().mutate({mutation:f.Ps`
            mutation EditUserDialog($input: UpdateUserInput!) {
              updateUser(input: $input)
            }
          `,variables:{input:o}}));if(t.monitor.removeProcess(),n.errors)return void t.uiMessageService.error("Error uploading data!");t.exit(!0)}})()}getAvailableYears(){const o=[];for(let n=(new Date).getFullYear()+8;n>=2014;n--)o.push(n);return o}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(j.U),e.Y36(w.v),e.Y36(ht.f),e.Y36(C.S),e.Y36(c.so),e.Y36(c.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-user-dialog"]],viewQuery:function(t,o){if(1&t&&(e.Gf(bt,5),e.Gf(yt,5)),2&t){let n;e.iGM(n=e.CRH())&&(o.avatarUpload=n.first),e.iGM(n=e.CRH())&&(o.bannerUpload=n.first)}},decls:50,vars:17,consts:[[2,"position","relative",3,"formGroup"],[2,"width","100%","height","12.5em","border-radius","0.25em","overflow","hidden"],["fileSizeLimit","10 MB"],["bannerUpload",""],[2,"--size","8em","--offset","calc(var(--size) / 2)","--offset-left-over","calc(var(--size) - var(--offset))","position","relative","height","var(--offset-left-over)","margin-bottom","1em"],[1,"outline-color-card",2,"left","2em","top","calc(-1 * var(--offset))","position","absolute","height","var(--size)","width","var(--size)","border-radius","8em","overflow","hidden","outline-style","solid","outline-width","0.25em"],[1,"background-color-card",2,"width","100%","height","100%"],["fileSizeLimit","5 MB",1,"app-edit-user-private-dialog","avatar"],["avatarUpload",""],[2,"display","flex","flex-direction","row","flex-wrap","wrap-reverse","justify-content","left","align-items","flex-end","margin-bottom","16px","gap","24px"],[2,"flex","1","display","flex","flex-direction","row","flex-wrap","wrap"],["appearance","outline",2,"flex","1"],["matInput","","formControlName","displayName",3,"maxLength"],["align","end"],[4,"ngIf"],["appearance","outline",2,"width","100%"],["formControlName","classYear"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"no-padding",2,"width","100%","line-height","1.5em"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5","formControlName","bio",3,"maxLength"],[2,"margin","0 0 2em 0"],[2,"display","flex","align-items","center","margin-bottom","0.5em"],[2,"margin-bottom","0","flex-grow","1"],["type","button","mat-stroked-button","","pill","",1,"app-edit-user-private-dialog","add-socials-button",3,"click"],[2,"display","flex","flex-direction","column","gap","0.5em"],["class","text-disabled",4,"ngIf"],[4,"ngFor","ngForOf"],["label","Roles",3,"roles","allRoles","disabledRoles","disabled","rolesEdited"],["mat-stroked-button","","color","basic","pill","",3,"disabled","click"],[3,"value"],[1,"text-disabled"],[3,"userSocialEdit","delete","edit"],["matInput","","formControlName","createdAt",3,"matDatepicker"],["matSuffix","",3,"for"],["createdAt",""]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content")(1,"form",0)(2,"div",1),e._UZ(3,"app-image-upload",2,3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6),e._UZ(8,"app-image-upload",7,8),e.qZA()()(),e.TgZ(10,"div",9)(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e._uU(14,"Display Name"),e.qZA(),e._UZ(15,"input",12),e.TgZ(16,"mat-hint",13),e._uU(17),e.qZA(),e.YNc(18,Tt,2,0,"mat-error",14),e.qZA()()(),e.TgZ(19,"mat-form-field",15)(20,"mat-label"),e._uU(21,"Class Year"),e.qZA(),e.TgZ(22,"mat-select",16),e.YNc(23,xt,2,2,"mat-option",17),e.qZA()(),e.TgZ(24,"mat-form-field",18)(25,"mat-label"),e._uU(26,"Bio"),e.qZA(),e._UZ(27,"textarea",19),e.TgZ(28,"mat-hint",13),e._uU(29),e.qZA(),e.YNc(30,Zt,2,0,"mat-error",14),e.qZA(),e.TgZ(31,"div",20)(32,"div",21)(33,"div",22),e._uU(34,"Socials"),e.qZA(),e.TgZ(35,"button",23),e.NdJ("click",function(){return o.onAddSocial()}),e.TgZ(36,"mat-icon"),e._uU(37,"add"),e.qZA(),e._uU(38," Add Social "),e.qZA()(),e.TgZ(39,"div",24),e.YNc(40,Ct,2,0,"div",25),e.YNc(41,It,2,1,"div",26),e.qZA()(),e.TgZ(42,"div")(43,"app-role-codes-editor",27),e.NdJ("rolesEdited",function(){return o.onEditRoles()}),e.qZA()(),e.YNc(44,Ut,12,2,"div",14),e.qZA()(),e.TgZ(45,"mat-dialog-actions")(46,"button",28),e.NdJ("click",function(){return o.exit()}),e._uU(47,"Exit "),e.qZA(),e.TgZ(48,"button",28),e.NdJ("click",function(){return o.save()}),e._uU(49,"Save "),e.qZA()()),2&t){let n,s,d,v;e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(14),e.Q6J("maxLength",50),e.xp6(2),e.hij("",(null==(n=o.form.get("displayName"))||null==n.value?null:n.value.length)||0,"/50"),e.xp6(1),e.Q6J("ngIf",null==(s=o.form.get("displayName"))?null:s.hasError("required")),e.xp6(5),e.Q6J("ngForOf",o.getAvailableYears()),e.xp6(4),e.Q6J("maxLength",600),e.xp6(2),e.hij("",(null==(d=o.form.get("bio"))||null==d.value?null:d.value.length)||0,"/600"),e.xp6(1),e.Q6J("ngIf",null==(v=o.form.get("bio"))?null:v.hasError("required")),e.xp6(10),e.Q6J("ngIf",0==o.userSocialEdits.length),e.xp6(1),e.Q6J("ngForOf",o.userSocialEdits),e.xp6(2),e.Q6J("roles",o.roles)("allRoles",o.acceptedRoles)("disabledRoles",o.disabledRoles)("disabled",!o.data.userOptions.canManageUserRoles),e.xp6(1),e.Q6J("ngIf",o.data.userOptions.canManageMetadata),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing),e.xp6(2),e.Q6J("disabled",o.monitor.isProcessing)}},dependencies:[u.sg,u.O5,c.xY,c.H8,m.TO,m.KE,m.bx,m.hX,m.R9,S.Mq,S.hl,S.nW,_t,ne.K,T.Hw,Z.gD,P.ey,oe.J,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,x.lW,U.v,L.IC,b.Nt]}),i})();var At=l(1656);let Et=(()=>{class i{constructor(){this.icon="",this.username="",this.link=""}ngOnInit(){this.userSocial&&this.userSocial.link&&this.userSocial.username&&this.userSocial.platform&&(this.icon=z.VB[this.userSocial.platform].icon,this.link=this.userSocial.link,this.username=this.userSocial.username)}onClick(){window.open(this.link,"_blank")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-social-button"]],inputs:{userSocial:"userSocial",icon:"icon",username:"username",link:"link"},decls:8,vars:2,consts:[[1,"app-social-button","card"],["size","24px",1,"icon",3,"icon"],[1,"app-social-button","social-button-name"],[2,"flex","1 1 auto"],["mat-icon-button","","color","basic",3,"click"],[2,"margin-bottom","2px"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"ic-icon",1),e.TgZ(2,"span",2),e._uU(3),e.qZA(),e._UZ(4,"span",3),e.TgZ(5,"button",4),e.NdJ("click",function(){return o.onClick()}),e.TgZ(6,"mat-icon",5),e._uU(7,"launch"),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("icon",o.icon),e.xp6(2),e.Oqu(o.username))},dependencies:[le.ar,T.Hw,x.lW],styles:[".card[_ngcontent-%COMP%]{border:2px solid;border-radius:.5em;display:flex;align-content:center;align-items:center;gap:.75em;padding:.75em .75em .75em 1.25em}"]}),i})();var kt=l(5539);function Dt(i,r){1&i&&(e.TgZ(0,"div"),e._UZ(1,"div",19),e.qZA())}const Ot=function(){return[]};function Pt(i,r){if(1&i&&(e.TgZ(0,"div",1),e._UZ(1,"div",2),e.TgZ(2,"div",3)(3,"div",4)(4,"div",5),e._UZ(5,"div",6),e.qZA(),e.TgZ(6,"div",7)(7,"div")(8,"h1",8),e._uU(9,"_ _ _"),e.qZA(),e.TgZ(10,"div",9),e._uU(11,"_ _ _ _ _ _ _ _ _"),e.qZA()(),e._UZ(12,"div",10),e.TgZ(13,"div",11),e._UZ(14,"div",12),e.qZA()(),e.TgZ(15,"div",13)(16,"p",14),e._uU(17," _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ "),e.qZA(),e.TgZ(18,"div",15)(19,"div",16),e.YNc(20,Dt,2,0,"div",17),e.qZA()(),e.TgZ(21,"div"),e._UZ(22,"app-roles-display",18),e.qZA()()()()()),2&i){const t=e.oxw();e.xp6(20),e.Q6J("ngForOf",e.DdM(2,Ot).constructor(3)),e.xp6(2),e.Q6J("roles",t.roles)}}function Jt(i,r){if(1&i&&e._UZ(0,"img",32),2&i){const t=e.oxw(2);e.Q6J("src",t.bannerSrc,e.LSH)}}function Nt(i,r){if(1&i&&e._UZ(0,"img",33),2&i){const t=e.oxw(2);e.Q6J("src",t.avatarSrc,e.LSH)}}function qt(i,r){if(1&i&&(e.TgZ(0,"div",10)(1,"h1",34),e._uU(2),e.qZA(),e.TgZ(3,"div",35),e._uU(4),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.user.displayName),e.xp6(2),e.hij("@",t.user.username,"")}}function St(i,r){if(1&i&&(e.TgZ(0,"div",36)(1,"app-tag",37),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" \u2705 ",t.getVerifiedText()," ")}}function Yt(i,r){if(1&i&&(e.TgZ(0,"div",38)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"app-tag",37),e._uU(4),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.hij("Class of ",t.user.classYear,""),e.xp6(2),e.Oqu(t.getClassYearString(t.user.classYear))}}function Mt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.edit())}),e._uU(1,"Edit Profile "),e.qZA()}}function Qt(i,r){1&i&&(e.TgZ(0,"div",40)(1,"h1"),e._uU(2,"This account doesn't exist"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"Try searching for another"),e.qZA()())}function Bt(i,r){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-social-button",44),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("userSocial",t)}}function jt(i,r){if(1&i&&(e.TgZ(0,"div",46),e._UZ(1,"mat-divider",46),e.TgZ(2,"h2"),e._uU(3,"E-Board"),e.qZA(),e._UZ(4,"app-eboard-profile",51),e.qZA()),2&i){const t=e.oxw(4);e.xp6(4),e.Q6J("eBoard",t.user.eBoard)}}function Lt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.onNewProjectClick())}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," New Project "),e.qZA()}}function Rt(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,jt,5,1,"div",45),e._UZ(2,"mat-divider",46),e.TgZ(3,"div",47)(4,"h2",48),e._uU(5,"Projects"),e.qZA(),e.YNc(6,Lt,4,0,"button",49),e.qZA(),e._UZ(7,"app-projects-display",50),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.user.eBoard),e.xp6(5),e.Q6J("ngIf",t.userOptions.canUpdateUser&&t.userOptions.canCreateProject),e.xp6(1),e.Q6J("projectsQuery",t.projectsQuery.bind(t))}}function Ft(i,r){if(1&i&&(e.TgZ(0,"div",13)(1,"p",41),e._uU(2),e.qZA(),e.TgZ(3,"div",15)(4,"div",16),e.YNc(5,Bt,2,1,"div",17),e.qZA()(),e.TgZ(6,"div"),e._UZ(7,"app-roles-display",18),e.qZA(),e.TgZ(8,"div",42)(9,"div"),e._uU(10),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.qZA()(),e.YNc(13,Rt,8,3,"div",43),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.user.bio," "),e.xp6(3),e.Q6J("ngForOf",t.user.socials),e.xp6(2),e.Q6J("roles",t.roles),e.xp6(3),e.hij("Created at ",t.getDateString(t.user.createdAt),""),e.xp6(2),e.hij("Updated at ",t.getDateString(t.user.updatedAt),""),e.xp6(1),e.Q6J("ngIf",!t.userOptions.nonExistent)}}function $t(i,r){if(1&i&&(e.TgZ(0,"div",1)(1,"div",20),e.YNc(2,Jt,1,1,"img",21),e.qZA(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5),e.YNc(6,Nt,1,1,"img",22),e.qZA(),e.TgZ(7,"div",23),e.YNc(8,qt,5,2,"div",24),e.TgZ(9,"div",25)(10,"div",26),e.YNc(11,St,3,1,"div",27),e.YNc(12,Yt,5,2,"div",28),e.qZA(),e.YNc(13,Mt,2,0,"button",29),e.qZA()(),e.YNc(14,Qt,5,0,"div",30),e.YNc(15,Ft,14,6,"div",31),e.qZA()()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngStyle",t.getBannerContainerStyle()),e.xp6(1),e.Q6J("ngIf",t.bannerSrc),e.xp6(4),e.Q6J("ngIf",t.avatarSrc),e.xp6(2),e.Q6J("ngIf",!t.userOptions.nonExistent),e.xp6(3),e.Q6J("ngIf",t.isVerified()),e.xp6(1),e.Q6J("ngIf",t.user.classYear),e.xp6(1),e.Q6J("ngIf",t.userOptions.canUpdateUser),e.xp6(1),e.Q6J("ngIf",t.userOptions.nonExistent),e.xp6(1),e.Q6J("ngIf",!t.userOptions.nonExistent)}}let zt=(()=>{class i{constructor(t,o,n,s,d,v,y){this.cdnService=t,this.settings=o,this.dialog=n,this.backend=s,this.security=d,this.router=v,this.uiMessageService=y,this.edited=new e.vpe,this.user={},this.userOptions={canUpdateUser:!1,nonExistent:!1,hasProjects:!1,deleteUserTooltip:"",canDeleteUser:!1,canManageUserRoles:!1,canManageEBoardRoles:!1,canManageEBoard:!1,canManageMetadata:!1,canManageProjectInvites:!1,canUpdateUserPrivate:!1,canCreateProject:!1,loaded:!1},this.avatarSrc="https://c.tenor.com/Tu0MCmJ4TJUAAAAC/load-loading.gif",this.bannerSrc="https://c.tenor.com/Tu0MCmJ4TJUAAAAC/load-loading.gif",this.projects=[],this.roles=[],this.monitor=new se.yv,this.setupBannerColorListener=!1,this.getClassYearString=$.R}ngAfterViewChecked(){this.trySetupBannerColorListeners()}ngOnChanges(t){t.user&&(this.bannerSrc=this.user.bannerLink?this.cdnService.getFileLink(this.user.bannerLink):"",this.avatarSrc=this.user.avatarLink?this.cdnService.getFileLink(this.user.avatarLink):this.settings.General.defaultAvatarSrc,this.user.roles&&(this.roles=this.user.roles.map(o=>o?.roleCode)),this.projectsDisplay?.queryUntilFillPage())}getDateString(t){return new Date(t).toLocaleString()}trySetupBannerColorListeners(){if(this.setupBannerColorListener)return;const t=document.querySelector("img.user-page.overview-tab.avatar");if(t){t.setAttribute("crossOrigin","");const o=new ct.Z;t.addEventListener("load",()=>{const[n,s,d]=o.getColor(t);this.bannerColor=new se.Il(n,s,d)}),this.setupBannerColorListener=!0}}getBannerContainerStyle(){return{...this.bannerColor&&{"background-color":this.bannerColor.hexString()}}}isVerified(){return""!=(this.user?.netId??"")||""!=(this.user?.manualVerified??"")}getVerifiedText(){return this.user.manualVerified?`Verified ${this.user.manualVerified}`:`Verified @${this.user.netId}`}projectsQuery(t,o,n){var s=this;return(0,g.Z)(function*(){if(!s.userOptions.hasProjects||!s.user.id||!s.user.projectMembers)return[];const d=yield(0,p.z)(s.backend.query({query:f.Ps`
          query ($filter: ProjectFilterInput, $skip: Int, $limit: Int) {
            projects(filter: $filter, skip: $skip, limit: $limit) {
              id
              access
              cardImageLink
              completedAt
              createdAt
              updatedAt
              name
              pitch
              description
              downloadLinks
              members {
                user {
                  avatarLink
                }
              }
            }
          }
        `,variables:{skip:o,limit:n,filter:{...t,id:{in:s.user.projectMembers.map(v=>v?.projectId)}}}}));return d.error?[]:d.data.projects})()}edit(){var t=this;return(0,g.Z)(function*(){yield(0,p.z)(t.dialog.open(wt,{data:{user:t.user,userOptions:t.userOptions},width:"37.5em",maxWidth:"90vw"}).afterClosed())})()}onNewProjectClick(){this.router.navigateByUrl("/projects/new")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.Ub),e.Y36(At.g),e.Y36(c.uw),e.Y36(D.v$),e.Y36(D.Il),e.Y36(O.F0),e.Y36(C.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-overview-tab"]],viewQuery:function(t,o){if(1&t&&e.Gf(M.YA,5),2&t){let n;e.iGM(n=e.CRH())&&(o.projectsDisplay=n.first)}},inputs:{user:"user",userOptions:"userOptions"},outputs:{edited:"edited"},features:[e.TTD],decls:2,vars:2,consts:[["class","user-page overview-tab main-bg",4,"ngIf"],[1,"user-page","overview-tab","main-bg"],[1,"user-page","overview-tab","banner-container","loading"],[1,"user-page","overview-tab","content-width-padding"],[1,"user-page","overview-tab","content"],[1,"user-page","overview-tab","avatar-container"],[1,"user-page","overview-tab","avatar","loading"],[2,"position","relative","display","flex","flex-direction","row","align-items","flex-start","margin-top","5em","flex-wrap","wrap","gap","4px"],[1,"user-page","overview-tab","display-name","loading",2,"margin-bottom","0.2em"],[1,"user-page","overview-tab","username-tag","loading"],[2,"flex-grow","1"],[2,"right","0","display","flex","flex-direction","row"],[1,"loading",2,"width","5em","height","2em","border-radius","5em"],[1,"user-page","overview-tab","core-content"],[1,"loading",2,"margin-top","0","margin-bottom","0","word-wrap","break-word","display","inline"],[1,"user-page","overview-tab","socials-container"],[1,"user-page","overview-tab","socials-button-container"],[4,"ngFor","ngForOf"],[3,"roles"],[1,"loading",2,"height","4em","width","100%","border-radius","0.5em"],[1,"user-page","overview-tab","banner-container",3,"ngStyle"],["class","user-page overview-tab banner",3,"src",4,"ngIf"],["class","user-page overview-tab avatar",3,"src",4,"ngIf"],[2,"position","relative","display","flex","flex-direction","row","align-items","flex-start","margin-top","5em","flex-wrap","wrap","gap","2em 0.25em","margin-bottom","1em"],["style","flex-grow: 1;",4,"ngIf"],[2,"display","flex","flex-direction","row","gap","1.25em","align-items","start"],[2,"display","flex","flex-wrap","wrap","min-height","2.125em","gap","0.5em 1.25em"],["style","\n              display: flex; \n              flex-direction: row;\n              align-items: center;\n              gap: 0.5em;\n              flex-wrap: wrap;\n            ",4,"ngIf"],["style","\n              display: flex; \n              flex-direction: row;\n              align-items: center;\n              gap: 0.25em 0.5em;\n              flex-wrap: wrap;\n            ",4,"ngIf"],["style","flex-shrink: 0;","class","user-page overview-tab edit-button","mat-stroked-button","","color","basic","pill","",3,"click",4,"ngIf"],["class","text-disabled","style","margin-top: 2em;",4,"ngIf"],["class","user-page overview-tab core-content",4,"ngIf"],[1,"user-page","overview-tab","banner",3,"src"],[1,"user-page","overview-tab","avatar",3,"src"],[1,"user-page","overview-tab","display-name"],[1,"user-page","overview-tab","username-tag"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5em","flex-wrap","wrap"],["color","blank"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.25em 0.5em","flex-wrap","wrap"],["mat-stroked-button","","color","basic","pill","",1,"user-page","overview-tab","edit-button",2,"flex-shrink","0",3,"click"],[1,"text-disabled",2,"margin-top","2em"],[2,"margin-top","0","margin-bottom","0","word-wrap","break-word"],[1,"text-disabled",2,"display","flex","flex-direction","row","gap","2em"],[4,"ngIf"],[3,"userSocial"],["style","margin-bottom: 2em;",4,"ngIf"],[2,"margin-bottom","2em"],[2,"display","flex","flex-direction","row","margin-bottom","1em"],[2,"flex","1","margin-bottom","0"],["mat-stroked-button","","pill","",3,"click",4,"ngIf"],[3,"projectsQuery"],[3,"eBoard"],["mat-stroked-button","","pill","",3,"click"]],template:function(t,o){1&t&&(e.YNc(0,Pt,23,3,"div",0),e.YNc(1,$t,16,9,"div",0)),2&t&&(e.Q6J("ngIf",!o.userOptions.loaded),e.xp6(1),e.Q6J("ngIf",o.userOptions.loaded))},dependencies:[u.sg,u.O5,u.PC,re.Z,Et,W.d,F.l,kt.Y,T.Hw,x.lW,U.v,ae],styles:["[_nghost-%COMP%]{--banner-height: calc(50vh - var(--site-header-height));--avatar-border-width: .5em;--avatar-size: 8em}.banner-container[_ngcontent-%COMP%]{box-sizing:content-box;height:var(--banner-height);width:100%;display:flex;justify-content:center;align-items:center;position:relative}.banner[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover}.edit-banner-tint[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background-color:#000;opacity:.5}.avatar-container[_ngcontent-%COMP%]{width:calc(var(--avatar-size) + var(--avatar-border-width));height:calc(var(--avatar-size) + var(--avatar-border-width));position:absolute;box-sizing:content-box;top:calc(var(--banner-height) - .5 * var(--avatar-size));display:flex;justify-content:center;align-items:center;border-radius:50%}.avatar[_ngcontent-%COMP%]{position:absolute;border:solid var(--avatar-border-width);border-radius:50%;object-fit:cover;width:calc(100% - 2 * var(--avatar-border-width));height:calc(100% - 2 * var(--avatar-border-width))}.edit-avatar-tint[_ngcontent-%COMP%]{position:absolute;width:calc(100% - 2 * var(--avatar-border-width));height:calc(100% - 2 * var(--avatar-border-width));border-radius:50%;background-color:#000;opacity:.5}.display-name[_ngcontent-%COMP%]{margin:0}.main-bg[_ngcontent-%COMP%]{position:relative;box-sizing:border-box;max-width:100vw}.content-width-padding[_ngcontent-%COMP%]{padding:var(--content-padding);padding-top:0}.socials-button-container[_ngcontent-%COMP%]{box-sizing:border-box;display:grid;align-items:stretch;margin-left:auto;margin-right:auto;gap:.5em;grid-template-columns:repeat(auto-fit,minmax(18.75em,1fr))}.content[_ngcontent-%COMP%]{display:block;margin:auto;padding-top:0;max-width:var(--content-width)}.core-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:2em}"]}),i})();var de=l(3535),Gt=l(6527),Ht=l(9740);function Vt(i,r){1&i&&(e.TgZ(0,"th",15),e._uU(1," Project "),e.qZA())}function Kt(i,r){if(1&i&&(e.TgZ(0,"td",16),e._UZ(1,"app-inline-project-item",17),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("project",t.project)}}function Xt(i,r){1&i&&(e.TgZ(0,"th",18),e._uU(1," Type "),e.qZA())}function Wt(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1,"\u{1f4e9} Incoming"),e.qZA())}function ei(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1,"\u{1f4e4} Outgoing"),e.qZA())}function ti(i,r){if(1&i&&(e.TgZ(0,"td",19),e.YNc(1,Wt,2,0,"div",20),e.YNc(2,ei,2,0,"div",20),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","INCOMING"===t.type),e.xp6(1),e.Q6J("ngIf","OUTGOING"===t.type)}}function ii(i,r){1&i&&e._UZ(0,"th",21)}function oi(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw();return e.KtG(s.onAcceptInvite(n))}),e.TgZ(1,"mat-icon"),e._uU(2,"check_circle"),e.qZA()()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",t.monitor.isProcessing)}}function ni(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td",19)(1,"div",22),e.YNc(2,oi,3,1,"button",23),e.TgZ(3,"button",24),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.onRejectInvite(s))}),e.TgZ(4,"mat-icon"),e._uU(5,"cancel"),e.qZA()()()()}if(2&i){const t=r.$implicit,o=e.oxw();e.xp6(2),e.Q6J("ngIf","OUTGOING"===t.type),e.xp6(1),e.Q6J("disabled",o.monitor.isProcessing)}}function ri(i,r){1&i&&e._UZ(0,"tr",26)}function ai(i,r){1&i&&e._UZ(0,"tr",27)}let si=(()=>{class i{constructor(t,o){this.backend=t,this.breakpointManager=o,this.edited=new e.vpe,this.user={},this.userOptions={canUpdateUser:!1,nonExistent:!1,hasProjects:!1,deleteUserTooltip:"",canDeleteUser:!1,canManageUserRoles:!1,canManageEBoardRoles:!1,canManageEBoard:!1,canManageMetadata:!1,canManageProjectInvites:!1,canUpdateUserPrivate:!1,canCreateProject:!1,loaded:!1},this.monitor=new I.y,this.displayedColumns=["project","type","buttons"],this.filteredInvites=[],this.onDestroy$=new B.x}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnChanges(t){t.user&&(this.monitor.removeProcess(),this.user.projectInvites&&(this.filteredInvites=(0,Q.I8)(this.user.projectInvites)))}ngAfterViewInit(){!this.filterHeader||this.filterHeader.newSearchRequest.pipe((0,E.R)(this.onDestroy$)).subscribe(this.onNewSearchRequest.bind(this))}onNewSearchRequest(t){""===t?this.filteredInvites=(0,Q.I8)(this.user.projectInvites):(this.filteredInvites=this.user.projectInvites.filter(o=>o.project.name.indexOf(t)>-1),this.filteredInvites=this.filteredInvites.sort((o,n)=>n.project.name.indexOf(t)-o.project.name.indexOf(t)))}onAcceptInvite(t){var o=this;return(0,g.Z)(function*(){o.monitor.isProcessing||(o.monitor.addProcess(),yield(0,p.z)(o.backend.withAuth().mutate({mutation:f.Ps`
          mutation AcceptProjectInvite($inviteId: ID!) {
            acceptProjectInvite(inviteId: $inviteId)
          }
        `,variables:{inviteId:t.id}})))})()}onRejectInvite(t){var o=this;return(0,g.Z)(function*(){o.monitor.isProcessing||(o.monitor.addProcess(),yield(0,p.z)(o.backend.withAuth().mutate({mutation:f.Ps`
          mutation RejectProjectInvite($inviteId: ID!) {
            deleteProjectInvite(inviteId: $inviteId)
          }
        `,variables:{inviteId:t.id}})))})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.v),e.Y36(Gt.I))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-invites-tab"]],viewQuery:function(t,o){if(1&t&&e.Gf(de.B,5),2&t){let n;e.iGM(n=e.CRH())&&(o.filterHeader=n.first)}},inputs:{user:"user",userOptions:"userOptions"},outputs:{edited:"edited"},features:[e.TTD],decls:16,vars:3,consts:[["full-page",""],["searchBar","",2,"flex","1"],["membersFilter",""],[2,"display","flex","flex-direction","column","gap","0.25em"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%",3,"dataSource"],["matColumnDef","project"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by project",4,"matHeaderCellDef"],["mat-cell","","style","max-width: 100px; overflow: hidden;",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by type",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by project"],["mat-cell","",2,"max-width","100px","overflow","hidden"],[3,"project"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by type"],["mat-cell",""],[4,"ngIf"],["mat-header-cell",""],[2,"display","flex","justify-content","right"],["mat-icon-button","",3,"disabled","click",4,"ngIf"],["mat-icon-button","",2,"margin-left","0.5em",3,"disabled","click"],["mat-icon-button","",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(e.TgZ(0,"app-bg-container",0),e._UZ(1,"app-filter-header",1,2)(3,"div",3),e.TgZ(4,"table",4),e.ynx(5,5),e.YNc(6,Vt,2,0,"th",6),e.YNc(7,Kt,2,1,"td",7),e.BQk(),e.ynx(8,8),e.YNc(9,Xt,2,0,"th",9),e.YNc(10,ti,3,2,"td",10),e.BQk(),e.ynx(11,11),e.YNc(12,ii,1,0,"th",12),e.YNc(13,ni,6,2,"td",10),e.BQk(),e.YNc(14,ri,1,0,"tr",13),e.YNc(15,ai,1,0,"tr",14),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("dataSource",o.filteredInvites),e.xp6(10),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns))},dependencies:[u.O5,x.lW,R.h,de.B,Ht.b,T.Hw,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk]}),i})();function li(i,r){1&i&&(e.TgZ(0,"div",6),e._uU(1,"Overview"),e.qZA())}function di(i,r){if(1&i&&(e.TgZ(0,"mat-icon"),e._uU(1,"remove_red_eye"),e.qZA(),e.YNc(2,li,2,0,"div",5)),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.breakpointManager.matchedBreakpointOrAbove("MOBILE","key"))}}function ci(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-overview-tab",7),e.NdJ("edited",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.fetchData(!0,!0))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("user",t.user)("userOptions",t.userOptions)}}function ui(i,r){1&i&&(e.TgZ(0,"div",6),e._uU(1,"Invites"),e.qZA())}function mi(i,r){if(1&i&&(e.TgZ(0,"mat-icon"),e._uU(1,"mail"),e.qZA(),e.YNc(2,ui,2,0,"div",5)),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.breakpointManager.matchedBreakpointOrAbove("MOBILE"))}}function pi(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-invites-tab",7),e.NdJ("edited",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.fetchData(!0))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("user",t.user)("userOptions",t.userOptions)}}function gi(i,r){1&i&&(e.TgZ(0,"mat-tab"),e.YNc(1,mi,3,1,"ng-template",2),e.YNc(2,pi,1,2,"ng-template",3),e.qZA())}function fi(i,r){1&i&&(e.TgZ(0,"div",6),e._uU(1,"E-Board"),e.qZA())}function _i(i,r){if(1&i&&(e.TgZ(0,"mat-icon"),e._uU(1,"assignment_ind"),e.qZA(),e.YNc(2,fi,2,0,"div",5)),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.breakpointManager.matchedBreakpointOrAbove("MOBILE"))}}function vi(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-eboard-tab",7),e.NdJ("edited",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.fetchData(!0))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("user",t.user)("userOptions",t.userOptions)}}function hi(i,r){1&i&&(e.TgZ(0,"mat-tab"),e.YNc(1,_i,3,1,"ng-template",2),e.YNc(2,vi,1,2,"ng-template",3),e.qZA())}function bi(i,r){1&i&&(e.TgZ(0,"div",6),e._uU(1,"Settings"),e.qZA())}function yi(i,r){if(1&i&&(e.TgZ(0,"mat-icon"),e._uU(1,"settings"),e.qZA(),e.YNc(2,bi,2,0,"div",5)),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.breakpointManager.matchedBreakpointOrAbove("MOBILE"))}}function Ti(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-settings-tab",7),e.NdJ("edited",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.fetchData(!0,!0))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("user",t.user)("userOptions",t.userOptions)}}function xi(i,r){1&i&&(e.TgZ(0,"mat-tab"),e.YNc(1,yi,3,1,"ng-template",2),e.YNc(2,Ti,1,2,"ng-template",3),e.qZA())}const Zi=[{path:"",component:(()=>{class i{constructor(t,o,n,s,d){this.breakpointManager=t,this.activatedRoute=o,this.backend=n,this.security=s,this.uiMessageService=d,this.user={},this.userOptions={canUpdateUser:!1,nonExistent:!1,hasProjects:!1,deleteUserTooltip:"",canDeleteUser:!1,canManageUserRoles:!1,canManageEBoardRoles:!1,canManageEBoard:!1,canManageMetadata:!1,canManageProjectInvites:!1,canUpdateUserPrivate:!1,canCreateProject:!1,loaded:!1},this.username="",this.onDestroy$=new B.x}ngOnInit(){var t=this;this.activatedRoute.paramMap.pipe((0,E.R)(this.onDestroy$)).subscribe(function(){var o=(0,g.Z)(function*(n){t.username=n.get("username"),yield t.security.waitUntilReady(),yield t.fetchData(),t.setupSubscribers()});return function(n){return o.apply(this,arguments)}}())}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}fetchData(t=!1,o=!1){var n=this;return(0,g.Z)(function*(){o&&(yield n.security.fetchData(),yield n.backend.cacheEvict({id:`User:${n.user.id}`}));const s=yield(0,p.z)(n.backend.withAuth().query({query:f.Ps`
          query FetchUserPageUser($filter: UserFilterInput) {
            users(filter: $filter) {
              id
              username
              displayName
              avatarLink
              bannerLink
              bio
              createdAt
              updatedAt
              classYear
              netId
              manualVerified
              projectMembers {
                id
                projectId
              }
              socials {
                id
                link
                platform
                username
              }
              roles {
                roleCode
              }
              eBoard {
                id
                createdAt
                updatedAt
                bio
                avatarLink
                terms {
                  id
                  year
                  roles {
                    roleCode
                  }
                }
              }
            }
          }
        `,variables:{filter:{username:{eq:n.username}}},...t&&{fetchPolicy:"network-only"}}));if(0==s.data.users.length)return n.userOptions.nonExistent=!0,void(n.userOptions.loaded=!0);let d=(0,Q.I8)(s.data.users[0]);d.eBoard?.terms?.sort((A,N)=>N.year-A.year);const v={userId:d.id},y=n.security.makePermCalc().withDomain(v);if(n.userOptions.canUpdateUser=y.hasPermission(h.y3.UpdateUser),n.userOptions.canDeleteUser=y.hasPermission(h.y3.DeleteUser),n.userOptions.canManageUserRoles=y.hasPermission(h.y3.ManageUserRoles),n.userOptions.canManageEBoardRoles=y.hasPermission(h.y3.ManageEboardRoles),n.userOptions.canManageEBoard=y.hasPermission(h.y3.ManageEboard),n.userOptions.canManageMetadata=y.hasPermission(h.y3.ManageMetadata),n.userOptions.canUpdateUserPrivate=y.hasPermission(h.y3.UpdateUserPrivate),n.userOptions.canManageProjectInvites=y.hasAllPermissions(h.y3.JoinProject,h.y3.UpdateUser),n.userOptions.canCreateProject=y.hasPermission(h.y3.CreateProject),n.userOptions.canDeleteUser||(n.userOptions.deleteUserTooltip="Please ask an e-board officer if you'd like to delete your profile."),(d.projectMembers?.length??0)>0&&(n.userOptions.canDeleteUser=!1,n.userOptions.deleteUserTooltip="Cannot delete user that is still in a project!"),n.userOptions.hasProjects=(d.projectMembers?.length??0)>0,n.security.makePermCalc().withDomain({userId:d.id}).hasPermission(h.y3.ReadUserPrivate)){const A=yield(0,p.z)(n.backend.withAuth().withOpDomain({userId:d.id}).query({query:f.Ps`
              query FetchUserPagePrivateUser {
                users {
                  email
                  loginIdentities {
                    id
                    name
                    identityId
                    data
                  }
                }
              }
            `,...t&&{fetchPolicy:"network-only"}}));if(A.error||0===A.data.users.length)return;d={...d,...A.data.users[0]}}if(n.security.securityContext?.userId){const A=n.security.getOpDomainsFromPermission(h.y3.ManageProjectInvites);if(A&&A.length>0||void 0===A){const N=n.security.securityContext&&n.userOptions.canUpdateUser?yield(0,p.z)(n.backend.withAuth().withOpDomains(A).query({query:f.Ps`
                      query FetchUserPageInvites($filter: ProjectInviteFilterInput) {
                        projectInvites(filter: $filter) {
                          id
                          type
                          project {
                            id
                            name
                            cardImageLink
                          }
                        }
                      }
                    `,variables:{filter:{userId:{eq:n.security.securityContext.userId}}},...t&&{fetchPolicy:"network-only"}})):void 0;N&&!N.error&&(d.projectInvites=N.data.projectInvites)}else d.projectInvites=[]}n.userOptions.loaded=!0,n.user=d})()}setupSubscribers(){if(!this.security.securityContext?.userId||!this.userOptions.canUpdateUser)return;this.backend.subscribe({query:f.Ps`
          subscription ($filter: UserSubscriptionFilter) {
            userUpdated(filter: $filter) {
              id
            }
          }
        `,variables:{filter:{id:this.user.id}}}).pipe((0,E.R)(this.onDestroy$)).subscribe({next:o=>{this.uiMessageService.notifyInfo("User updated!"),this.fetchData(!0,!0)}});const t={userId:this.security.securityContext.userId};this.backend.subscribe({query:f.Ps`
          subscription ($filter: ProjectInviteSubscriptionFilter) {
            projectInviteCreated(filter: $filter) {
              id
            }
          }
        `,variables:{filter:t}}).pipe((0,E.R)(this.onDestroy$)).subscribe({next:o=>{this.uiMessageService.notifyInfo("New invite!"),this.fetchData(!0)}}),this.backend.subscribe({query:f.Ps`
          subscription ($filter: ProjectInviteSubscriptionFilter) {
            projectInviteDeleted(filter: $filter) {
              id
            }
          }
        `,variables:{filter:t}}).pipe((0,E.R)(this.onDestroy$)).subscribe({next:o=>{this.uiMessageService.notifyInfo("Invite deleted!"),this.fetchData(!0)}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.IW),e.Y36(O.gz),e.Y36(w.v),e.Y36(ie.I),e.Y36(C.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-page"]],decls:8,vars:4,consts:[[1,"app-user-page","main-bg"],["mat-align-tabs","center","backgroundColor","primary",3,"selectedIndex"],["mat-tab-label",""],["matTabContent",""],[4,"ngIf"],["style","margin-left: 0.5em;",4,"ngIf"],[2,"margin-left","0.5em"],[3,"user","userOptions","edited"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"mat-tab-group",1)(2,"mat-tab"),e.YNc(3,di,3,1,"ng-template",2),e.YNc(4,ci,1,2,"ng-template",3),e.qZA(),e.YNc(5,gi,3,0,"mat-tab",4),e.YNc(6,hi,3,0,"mat-tab",4),e.YNc(7,xi,3,0,"mat-tab",4),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("selectedIndex",0),e.xp6(4),e.Q6J("ngIf",o.userOptions.canManageProjectInvites),e.xp6(1),e.Q6J("ngIf",o.userOptions.canManageEBoard),e.xp6(1),e.Q6J("ngIf",o.userOptions.canUpdateUser))},dependencies:[u.O5,Le,dt,zt,si,k.SP,k.uD,k.uX,k.Vc,T.Hw],styles:["[_nghost-%COMP%]{--banner-height: calc(50vh - var(--site-header-height));--avatar-border-width: .5em;--avatar-size: 8em}.banner-container[_ngcontent-%COMP%]{box-sizing:content-box;height:var(--banner-height);width:100%;display:flex;justify-content:center;align-items:center;position:relative}.banner[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover}.edit-banner-tint[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background-color:#000;opacity:.5}.avatar-container[_ngcontent-%COMP%]{width:calc(var(--avatar-size) + var(--avatar-border-width));height:calc(var(--avatar-size) + var(--avatar-border-width));position:absolute;box-sizing:content-box;top:calc(var(--banner-height) - .5 * var(--avatar-size));display:flex;justify-content:center;align-items:center;border-radius:50%}.avatar[_ngcontent-%COMP%]{position:absolute;border:solid var(--avatar-border-width);border-radius:50%;object-fit:cover;width:calc(100% - 2 * var(--avatar-border-width));height:calc(100% - 2 * var(--avatar-border-width))}.edit-avatar-tint[_ngcontent-%COMP%]{position:absolute;width:calc(100% - 2 * var(--avatar-border-width));height:calc(100% - 2 * var(--avatar-border-width));border-radius:50%;background-color:#000;opacity:.5}.display-name[_ngcontent-%COMP%]{margin:0}.username-tag[_ngcontent-%COMP%]{margin-bottom:1em}.main-bg[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.content-width-padding[_ngcontent-%COMP%]{padding:var(--content-padding);padding-top:0}.socials-button-container[_ngcontent-%COMP%]{box-sizing:border-box;display:grid;align-items:stretch;margin-left:auto;margin-right:auto;gap:8px;grid-template-columns:repeat(auto-fit,minmax(18.75,1fr))}.content[_ngcontent-%COMP%]{display:block;margin:auto;padding-top:0;max-width:var(--content-width)}.core-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:32px}"]}),i})()}];let Ci=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[O.Bz.forChild(Zi),u.ez,ue,he,fe,me,k.Nh,T.Ps]}),i})()}}]);